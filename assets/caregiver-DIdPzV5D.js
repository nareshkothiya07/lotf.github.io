import{a as Z,u as ee,t as ae,r as d,g as re,b as oe,c as N,j as e,C as ce,F as de,L as le,A as me,d as ue,D as ge,e as $,f as he,G as m,S as c,h as pe,i as se,B as te,k as xe,T as M,l as I,m as p,I as _,aK as z,b0 as H,H as g,p as je,q,s as fe,x as J,v as _e,R as Me,y as ye,z as ke,M as Ce,E as Se,J as ve,K as be,aL as Pe,bK as X,U as Ae}from"./index-DSO9TgYq.js";import{d as Ee}from"./dayjs.min-pRfd56nx.js";import{D as Ie}from"./DebouncedInput-DhmfX_1V.js";import{u as ie}from"./useStatusList-Dbp-x5Xm.js";import{u as Fe}from"./useFilterAndSearch-PJD0Zg8P.js";import{C as Y}from"./CustomTypography-CRnDvUFn.js";import{a as ne,b as we,u as Te,d as Be}from"./service-packages-ClErv1Kx.js";import{D as De}from"./DeleteConfirmation-BqFOMagf.js";import{E as Re}from"./EditStatusDialog-BIVGlZRP.js";import{f as Oe}from"./services-DCcxZZqT.js";import{C as Ke}from"./CameraOutlined-D4Mj0cXe.js";import{p as Ne}from"./services-BGkrpTaC.js";import{u as Le}from"./useGenderList-C-bU5Ya0.js";import{P as Ve}from"./PlusOutlined-BQvVSxI0.js";import{A as Ge}from"./ArrowUpOutlined-C9GTlrEN.js";import"./CloseOutlined-DRBnXhIJ.js";import"./ConfirmationDialog-DR_Ho8RD.js";import"./Dialog-CPoUMqzk.js";const Ue=(s,F)=>{var x,y;const S={name_en:"",name_ar:"",min_visit_price:"",min_package_price:"",discount:"",status:1,image:"",gender:"",duration:[]};return s?{name_en:(x=s==null?void 0:s.name)==null?void 0:x.en,name_ar:(y=s==null?void 0:s.name)==null?void 0:y.ar,min_visit_price:Number(s==null?void 0:s.min_visit_price),min_package_price:Number(s==null?void 0:s.min_package_price),discount:Number(s==null?void 0:s.discount),status:s==null?void 0:s.status,image:s==null?void 0:s.image,gender:s==null?void 0:s.gender,duration:s==null?void 0:s.duration}:S};function We({subService:s,url:F,open:S,handleClose:x,packageType:y,packageId:L}){const D=Z(),i=ee(),{lang:j}=ae(),{defaultList:r}=ie(J.PACKAGE_STATUS),[v,V]=d.useState(void 0),[R,w]=d.useState(`${s&&(s!=null&&s.image)?s.image:""}`),u=Le();d.useEffect(()=>{v&&(w(URL.createObjectURL(v)),re(v,t=>{E("image",t)}))},[v]);const b=d.useMemo(()=>Ue(s),[]),O=oe({initialValues:b,validationSchema:Ne(i,y),enableReinitialize:!0,onSubmit:async(t,{setSubmitting:f})=>{try{let l={...t,package_type:y,service_id:L,name:{en:t==null?void 0:t.name_en,ar:t==null?void 0:t.name_ar}};(l.discount===""||l.discount===null||l.discount===void 0)&&(l.discount=0),l.image.includes("http")&&delete l.image,delete l.name_en,delete l.name_ar,s?await ne(s.id,l,F).then(W=>{N(i.formatMessage({id:"services.editPackageSuccess"})),f(!1),x()}):await we(l,F).then(W=>{N(i.formatMessage({id:"services.addPackageSuccess"})),f(!1),x()})}catch(l){console.error(l),f(!1)}}}),{errors:a,touched:o,handleSubmit:P,isSubmitting:G,getFieldProps:k,values:A,setFieldTouched:U,setFieldValue:E}=O;return e.jsx(e.Fragment,{children:S&&e.jsx(ce,{open:S,handleClose:x,children:e.jsx(de,{value:O,children:e.jsx(le,{dateAdapter:me,children:e.jsxs(ue,{autoComplete:"off",noValidate:!0,onSubmit:P,children:[e.jsx(ge,{children:s?i.formatMessage({id:"services.editPackage"}):i.formatMessage({id:"services.addNewPackage"})}),e.jsx($,{}),e.jsx(he,{sx:{p:2.5},children:e.jsxs(m,{container:!0,spacing:3,children:[e.jsxs(m,{item:!0,xs:12,md:3,children:[e.jsxs(c,{direction:"row",justifyContent:"center",sx:{mt:3},children:[e.jsxs(pe,{htmlFor:"change-avtar",sx:{position:"relative",borderRadius:"50%",overflow:"hidden","&:hover .MuiBox-root":{opacity:1},cursor:"pointer"},children:[e.jsx(se,{alt:"Avatar 1",src:R,sx:{width:72,height:72,border:"1px dashed"}}),e.jsx(te,{sx:{position:"absolute",top:0,left:0,background:D.palette.mode===xe.DARK?"rgba(255, 255, 255, .75)":"rgba(0,0,0,.65)",width:"100%",height:"100%",opacity:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(c,{spacing:.5,alignItems:"center",children:[e.jsx(Ke,{style:{color:D.palette.secondary.lighter,fontSize:"2rem"}}),e.jsx(M,{sx:{color:"secondary.lighter"},children:i.formatMessage({id:"common.upload"})})]})})]}),e.jsx(I,{type:"file",id:"change-avtar",placeholder:"Outlined",variant:"outlined",inputProps:{accept:"image/*"},sx:{display:"none"},onChange:t=>{var f;U("image",!0),V((f=t.target.files)==null?void 0:f[0])}})]}),e.jsx(c,{direction:"row",justifyContent:"center",children:o.image&&a.image&&e.jsx(p,{error:!0,id:"helper-image",children:a==null?void 0:a.image})})]}),e.jsx(m,{item:!0,xs:12,md:8,children:e.jsxs(m,{container:!0,spacing:3,children:[e.jsxs(m,{item:!0,xs:12,sm:6,children:[e.jsxs(c,{spacing:1,children:[e.jsx(_,{htmlFor:"name_en",children:i.formatMessage({id:"services.packageNameEn"})}),e.jsx(I,{fullWidth:!0,id:"name_en",placeholder:i.formatMessage({id:"services.packageNameEn"}),...k("name_en"),error:!!(o.name_en&&a.name_en)})]}),o.name_en&&a.name_en&&e.jsx(p,{error:!0,id:"helper-name_en",children:a==null?void 0:a.name_en})]}),e.jsxs(m,{item:!0,xs:12,sm:6,children:[e.jsxs(c,{spacing:1,children:[e.jsx(_,{htmlFor:"name_ar",children:i.formatMessage({id:"services.packageNameAr"})}),e.jsx(I,{fullWidth:!0,id:"name_ar",placeholder:i.formatMessage({id:"services.packageNameAr"}),...k("name_ar"),error:!!(o.name_ar&&a.name_ar)})]}),o.name_ar&&a.name_ar&&e.jsx(p,{error:!0,id:"helper-name_ar",children:a==null?void 0:a.name_ar})]}),e.jsxs(m,{item:!0,xs:12,sm:6,children:[e.jsxs(c,{spacing:1,children:[e.jsx(_,{htmlFor:"min_visit_price",children:i.formatMessage({id:"services.minVisitPrice"})}),e.jsx(I,{type:"number",fullWidth:!0,id:"min_visit_price",placeholder:i.formatMessage({id:"services.minVisitPrice"}),...k("min_visit_price"),error:!!(o.min_visit_price&&a.min_visit_price)})]}),o.min_visit_price&&a.min_visit_price&&e.jsx(p,{error:!0,id:"helper-min_visit_price",children:a==null?void 0:a.min_visit_price})]}),e.jsxs(m,{item:!0,xs:12,sm:6,children:[e.jsxs(c,{spacing:1,children:[e.jsx(_,{htmlFor:"min_package_price",children:i.formatMessage({id:"services.minServicePrice"})}),e.jsx(I,{type:"number",fullWidth:!0,id:"min_package_price",placeholder:i.formatMessage({id:"services.minServicePrice"}),...k("min_package_price"),error:!!(o.min_package_price&&a.min_package_price)})]}),o.min_package_price&&a.min_package_price&&e.jsx(p,{error:!0,id:"helper-min_package_price",children:a==null?void 0:a.min_package_price})]}),e.jsxs(m,{item:!0,xs:12,sm:6,children:[e.jsxs(c,{spacing:1,children:[e.jsx(_,{htmlFor:"discount",children:i.formatMessage({id:"services.discount"})}),e.jsx(I,{type:"number",fullWidth:!0,id:"discount",placeholder:i.formatMessage({id:"services.discount"}),...k("discount"),error:!!(o.discount&&a.discount)})]}),o.discount&&a.discount&&e.jsx(p,{error:!0,id:"helper-discount",children:a==null?void 0:a.discount})]}),e.jsxs(m,{item:!0,xs:12,sm:6,children:[e.jsxs(c,{spacing:1,children:[e.jsx(_,{htmlFor:"status",children:i.formatMessage({id:"services.packageStatus"})}),e.jsx(z,{fullWidth:!0,children:e.jsxs(H,{id:"status",displayEmpty:!0,value:A.status,onChange:t=>E("status",t.target.value),children:[e.jsx(g,{value:"",children:e.jsx("em",{children:i.formatMessage({id:"common.none"})})}),r==null?void 0:r.map(t=>e.jsx(g,{value:t.value,children:t.label[j]},t.value))]})})]}),o.status&&a.status&&e.jsx(p,{error:!0,id:"helper-status",children:a==null?void 0:a.status})]}),e.jsxs(m,{item:!0,xs:12,sm:6,children:[e.jsxs(c,{spacing:1,children:[e.jsx(_,{htmlFor:"gender",children:i.formatMessage({id:"profile.gender"})}),e.jsx(z,{fullWidth:!0,error:!!(o.gender&&a.gender),children:e.jsxs(H,{id:"gender",displayEmpty:!0,value:A.gender,onChange:t=>E("gender",t.target.value),children:[e.jsx(g,{value:"",disabled:!0,children:e.jsx(M,{color:"secondary",children:i.formatMessage({id:"common.selectOp"})})}),u==null?void 0:u.content.map(t=>e.jsx(g,{value:t.value,children:t.label[j]},t.value))]})})]}),o.gender&&a.gender&&e.jsx(p,{error:!0,id:"helper-gender",children:a==null?void 0:a.gender})]}),e.jsxs(m,{item:!0,xs:12,sm:6,children:[e.jsxs(c,{spacing:1,children:[e.jsx(_,{htmlFor:"duration",children:i.formatMessage({id:"profile.duration"})}),e.jsx(z,{fullWidth:!0,error:!!(o.duration&&a.duration),children:e.jsxs(H,{id:"duration",multiple:!0,displayEmpty:!0,value:A.duration||[],onChange:t=>E("duration",t.target.value),renderValue:t=>t.length===0?i.formatMessage({id:"common.selectOp"}):t.join(", "),children:[e.jsx(g,{disabled:!0,value:"",children:e.jsx(M,{color:"secondary",children:i.formatMessage({id:"common.selectOp"})})}),e.jsx(g,{value:"1",children:"1 Day"},"1"),e.jsx(g,{value:"7",children:"7 Days"},"7"),e.jsx(g,{value:"26",children:"26 Days"},"26"),e.jsx(g,{value:"30",children:"30 Days"},"30")]})})]}),o.duration&&a.duration&&e.jsx(p,{error:!0,id:"helper-duration",children:a==null?void 0:a.duration})]})]})})]})}),e.jsx($,{}),e.jsx(je,{sx:{p:2.5},children:e.jsx(m,{container:!0,justifyContent:"right",alignItems:"center",children:e.jsx(m,{item:!0,children:e.jsxs(c,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(q,{color:"error",onClick:x,children:i.formatMessage({id:"common.cancel"})}),e.jsx(fe,{type:"submit",loading:G,loadingIndicator:i.formatMessage({id:"common.processing"}),variant:"contained",children:s?i.formatMessage({id:"services.editPackage"}):i.formatMessage({id:"services.addNewPackage"})})]})})})})]})})})})})}function ze(s){return[{title:s.formatMessage({id:"sidebar.home"}),to:Ae},{title:s.formatMessage({id:"services.caregiver.title"})}]}function la(){const{lang:s}=ae(),{defaultList:F}=ie(J.PACKAGE_STATUS),{data:S,error:x,isLoading:y,setSorting:L,setFilterCriteria:D,setPagination:i,url:j}=Te(X.CAREGIVER),r=ee(),v=Z(),V=_e(v.breakpoints.down("sm")),[R,w]=d.useState(!1),[u,b]=d.useState(null),[O,a]=d.useState(null),[o,P]=d.useState(0),[G,k]=d.useState(),{filter:A,search:U,setSearch:E}=Fe(),t=()=>{a(null),w(!0)},f=d.useCallback(async()=>{try{await Be(o,j).then(n=>{N(r.formatMessage({id:"services.deletePackageSuccess"})),P(0)})}catch{P(0)}},[o,j,r]),l=d.useCallback(async n=>{try{ne(u==null?void 0:u.id,{status:n},j).then(h=>{N(r.formatMessage({id:"services.statusEditSuccess"})),b(null)})}catch{b(null)}},[u,j,r]);d.useEffect(()=>{D(A)},[A]);const W=d.useMemo(()=>[{header:r.formatMessage({id:"services.packageName"}),accessorKey:"name",enableSorting:!1,cell:({row:n})=>e.jsxs(c,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(se,{alt:"Avatar 1",size:"sm",src:n.original.image}),e.jsx(c,{spacing:0,children:e.jsx(M,{variant:"subtitle1",children:n.original.name[s]})})]})},{header:r.formatMessage({id:"services.medicalCenters"}),accessorKey:"medical_centers_count",cell:({row:n})=>e.jsx(Y,{className:"typography-inline",value:n.original.hospitals_count})},{header:r.formatMessage({id:"common.visits"}),accessorKey:"visits_count",disableSortBy:!0,cell:({row:n})=>e.jsx(Y,{className:"typography-inline",value:n.original.visits_count})},{header:r.formatMessage({id:"common.status"}),accessorKey:"status",cell:({row:n})=>e.jsx(Me,{status:n.original.status,referenceKey:J.PACKAGE_STATUS})},{header:r.formatMessage({id:"common.createdOn"}),accessorKey:"created_at",cell:({row:n})=>{var h;return Ee((h=n.original)==null?void 0:h.created_at).format(ye)}},{header:r.formatMessage({id:"common.actions"}),accessorKey:"Actions",meta:{className:"cell-center"},enableSorting:!1,cell:({row:n})=>{const[h,T]=d.useState(null),K=!!h,B=C=>{T(C.currentTarget)},Q=()=>{T(null)};return e.jsxs(e.Fragment,{children:[e.jsx(ke,{onClick:B,children:e.jsx(Ce,{})}),e.jsxs(Se,{anchorEl:h,open:K,onClose:Q,onClick:Q,children:[e.jsx(g,{onClick:C=>{C.stopPropagation(),w(!0),a(n.original)},children:e.jsx(M,{variant:"body1",children:r.formatMessage({id:"services.editPackageInfo"})})}),e.jsx(g,{onClick:C=>{C.stopPropagation(),b(n.original)},children:e.jsx(M,{variant:"body1",children:r.formatMessage({id:"common.editStatus"})})}),e.jsx(g,{onClick:C=>{C.stopPropagation(),P(n.original.id)},children:e.jsx(M,{variant:"body1",children:r.formatMessage({id:"services.deletePackage"})})})]})]})}}],[]);return d.useEffect(()=>{Oe().then(n=>{var T,K;const h=(K=(T=n==null?void 0:n.data)==null?void 0:T.data)==null?void 0:K.find(B=>(B==null?void 0:B.slug)==="caregiver");k(h==null?void 0:h.id)})},[]),e.jsxs(e.Fragment,{children:[e.jsx(ve,{custom:!0,links:ze(r)}),e.jsxs(c,{direction:"row",marginBottom:"20px",spacing:2,justifyContent:"space-between",alignItems:"center",children:[e.jsx(M,{variant:"h2",children:r.formatMessage({id:"services.caregiver.title"})}),e.jsx(q,{variant:"contained",startIcon:e.jsx(Ve,{}),onClick:t,children:r.formatMessage({id:"services.caregiver.addServiceTitle"})})]}),e.jsx(be,{data:S,columns:W,isLoading:y,setPagination:n=>{i(n)},setSortingParams:n=>{L(n)},children:e.jsx(Pe,{content:!1,children:e.jsxs(c,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",justifyContent:"space-between",sx:{padding:2,...V&&{"& .MuiOutlinedInput-root, & .MuiFormControl-root":{width:"100%"}}},children:[e.jsx(te,{sx:{width:{xs:"70%",md:"70%"}},children:e.jsx(c,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(Ie,{value:U,onFilterChange:n=>E(n),placeholder:r.formatMessage({id:"services.searchPackage"})})})}),e.jsx(c,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",sx:{width:{xs:"100%",sm:"auto"}},children:e.jsx(c,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(q,{variant:"outlined",startIcon:e.jsx(Ge,{}),children:r.formatMessage({id:"common.export"})})})})]})})}),R&&e.jsx(We,{open:R,handleClose:()=>{w(!1)},packageId:G,url:j,subService:O,packageType:X.CAREGIVER}),!!o&&e.jsx(De,{open:!!o,handleSubmit:f,handleClose:()=>{P(0)}}),u&&e.jsx(Re,{title:r.formatMessage({id:"medicalCenter.editTitle"}),open:!!u,statusList:F,status:u==null?void 0:u.status,handleSubmit:l,handleClose:()=>{b(null)}})]})}export{la as default};
