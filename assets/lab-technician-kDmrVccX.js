import{r as h,aV as Ze,a0 as et,a as re,u as z,t as ce,b as ye,bK as ie,c as L,j as e,C as ke,F as Se,L as Ae,A as Pe,d as Ie,D as Fe,e as ae,f as Be,G as d,S as r,I as y,l as k,m as v,ba as we,q as X,aK as de,b0 as Ee,H as N,p as Ne,s as De,x as te,T as j,v as Le,w as Q,R as Ke,y as We,z as Oe,M as Re,E as Ve,K as $e,aL as Ge,B as ue,g as tt,h as st,i as Ue,k as it,J as at,b5 as Ce,U as nt}from"./index-DSO9TgYq.js";import{d as ze}from"./dayjs.min-pRfd56nx.js";import{D as He}from"./DebouncedInput-DhmfX_1V.js";import{u as qe}from"./useFilterAndSearch-PJD0Zg8P.js";import{D as Je}from"./DeleteConfirmation-BqFOMagf.js";import{E as rt}from"./EditStatusDialog-BIVGlZRP.js";import{u as he}from"./useStatusList-Dbp-x5Xm.js";import{C as ne}from"./CustomTypography-CRnDvUFn.js";import{u as se,a as ct,b as Qe,d as lt}from"./labtechnician-test-IRDEz_Od.js";import{t as ot,l as dt}from"./services-BGkrpTaC.js";import{f as mt}from"./services-DCcxZZqT.js";import{P as le}from"./PlusOutlined-BQvVSxI0.js";import{C as oe}from"./ConfirmationDialog-DR_Ho8RD.js";import{A as Xe}from"./ArrowUpOutlined-C9GTlrEN.js";import{a as me,b as ut,u as ht,d as pt}from"./service-packages-ClErv1Kx.js";import{C as gt}from"./CameraOutlined-D4Mj0cXe.js";import{G as xt}from"./GenericAutocomplete-D3M5FyqM.js";import{u as jt}from"./hooks-CMWd8yYb.js";import"./CloseOutlined-DRBnXhIJ.js";import"./Dialog-CPoUMqzk.js";import"./Autocomplete-BOe_mB7V.js";var ft={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"};const _t=ft;var bt=function(f,_){return h.createElement(Ze,et({},f,{ref:_,icon:_t}))},Tt=h.forwardRef(bt);const Ye=Tt,Mt=t=>{var _,n;const f={name_en:"",name_ar:"",min_visit_price:"",min_test_price:"",discount:"",status:1,sample:"",instructions:[{en:"",ar:""}],result_time:""};return t?{name_en:(_=t==null?void 0:t.name)==null?void 0:_.en,name_ar:(n=t==null?void 0:t.name)==null?void 0:n.ar,min_visit_price:Number(t==null?void 0:t.min_visit_price),min_test_price:Number(t==null?void 0:t.min_test_price),discount:Number(t==null?void 0:t.discount),status:t==null?void 0:t.status,sample:t==null?void 0:t.sample,instructions:(t==null?void 0:t.instructions)||[{en:"",ar:""}],result_time:t==null?void 0:t.result_time}:f};function vt({test:t,url:f,open:_,handleClose:n}){re();const m=z(),{defaultList:B}=he(te.PACKAGE_STATUS),{lang:c}=ce(),[R,M]=h.useState(),a=h.useMemo(()=>Mt(t),[]),H=ye({initialValues:a,validationSchema:ot(m),enableReinitialize:!0,onSubmit:async(x,{setSubmitting:C})=>{try{let s={...x,service_type:ie.LAB_TECHNICIAN,service_id:R,name:{en:x==null?void 0:x.name_en,ar:x==null?void 0:x.name_ar}};(s.discount===""||s.discount===null||s.discount===void 0)&&(s.discount=0),delete s.name_en,delete s.name_ar,t?await se(t.id,s,f).then(p=>{L(m.formatMessage({id:"services.labTechnician.editSuccess"})),C(!1),n()}):await ct(s,f).then(p=>{L(m.formatMessage({id:"services.labTechnician.addSuccess"})),C(!1),n()})}catch(s){console.error(s),C(!1)}}});h.useEffect(()=>{mt().then(x=>{var s,p;const C=(p=(s=x==null?void 0:x.data)==null?void 0:s.data)==null?void 0:p.find(P=>(P==null?void 0:P.slug)==="lab-technician");M(C==null?void 0:C.id)})},[]);const{errors:i,touched:b,handleSubmit:K,isSubmitting:V,getFieldProps:T,values:w,setFieldTouched:$,setFieldValue:W}=H;return e.jsx(e.Fragment,{children:_&&e.jsx(ke,{open:_,handleClose:n,children:e.jsx(Se,{value:H,children:e.jsx(Ae,{dateAdapter:Pe,children:e.jsxs(Ie,{autoComplete:"off",noValidate:!0,onSubmit:K,children:[e.jsx(Fe,{children:t?m.formatMessage({id:"services.labTechnician.editServiceTitle"}):m.formatMessage({id:"services.labTechnician.addServiceTitle"})}),e.jsx(ae,{}),e.jsx(Be,{sx:{p:2.5},children:e.jsx(d,{container:!0,spacing:3,children:e.jsx(d,{item:!0,xs:12,md:12,children:e.jsxs(d,{container:!0,spacing:3,children:[e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"name_en",children:m.formatMessage({id:"services.labTechnician.serviceNameEn"})}),e.jsx(k,{fullWidth:!0,id:"name_en",placeholder:m.formatMessage({id:"services.labTechnician.serviceNameEn"}),...T("name_en"),error:!!(b.name_en&&i.name_en)})]}),b.name_en&&i.name_en&&e.jsx(v,{error:!0,id:"helper-name_en",children:i==null?void 0:i.name_en})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"name_ar",children:m.formatMessage({id:"services.labTechnician.serviceNameAr"})}),e.jsx(k,{fullWidth:!0,id:"name_ar",placeholder:m.formatMessage({id:"services.labTechnician.serviceNameAr"}),...T("name_ar"),error:!!(b.name_ar&&i.name_ar)})]}),b.name_ar&&i.name_ar&&e.jsx(v,{error:!0,id:"helper-name_ar",children:i==null?void 0:i.name_ar})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"sample",children:m.formatMessage({id:"services.labTechnician.sample"})}),e.jsx(k,{fullWidth:!0,id:"sample",placeholder:m.formatMessage({id:"services.labTechnician.sample"}),...T("sample"),error:!!(b.sample&&i.sample)})]}),b.sample&&i.sample&&e.jsx(v,{error:!0,id:"helper-sample",children:i==null?void 0:i.sample})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"result_time",children:m.formatMessage({id:"services.labTechnician.resultTime"})}),e.jsx(k,{type:"number",fullWidth:!0,id:"resultTime",placeholder:m.formatMessage({id:"services.labTechnician.resultTime"}),...T("result_time"),error:!!(b.result_time&&i.result_time)})]}),b.result_time&&i.result_time&&e.jsx(v,{error:!0,id:"helper-result_time",children:i==null?void 0:i.result_time})]}),e.jsx(d,{item:!0,xs:12,sm:12,children:e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"instructions",children:m.formatMessage({id:"services.labTechnician.instructions"})}),e.jsx(we,{name:"instructions",render:x=>e.jsxs(r,{spacing:2,children:[w.instructions.map((C,s)=>{var p,P,D,A,O,q,G,l,u,o,E,U,g,I,S,Y,Z,J,F,ee;return e.jsxs(d,{container:!0,spacing:1,children:[e.jsxs(d,{item:!0,xs:5,children:[e.jsx(k,{fullWidth:!0,id:`instructions[${s}].en`,placeholder:m.formatMessage({id:"services.labTechnician.instructionsEn"}),...T(`instructions[${s}].en`),error:!!((P=(p=b.instructions)==null?void 0:p[s])!=null&&P.en&&((A=(D=i.instructions)==null?void 0:D[s])!=null&&A.en))}),((q=(O=b.instructions)==null?void 0:O[s])==null?void 0:q.en)&&((l=(G=i.instructions)==null?void 0:G[s])==null?void 0:l.en)&&e.jsx(v,{error:!0,children:(o=(u=i.instructions)==null?void 0:u[s])==null?void 0:o.en})]}),e.jsxs(d,{item:!0,xs:5,children:[e.jsx(k,{fullWidth:!0,id:`instructions[${s}].ar`,placeholder:m.formatMessage({id:"services.labTechnician.instructionsAr"}),...T(`instructions[${s}].ar`),error:!!((U=(E=b.instructions)==null?void 0:E[s])!=null&&U.ar&&((I=(g=i.instructions)==null?void 0:g[s])!=null&&I.ar))}),((Y=(S=b.instructions)==null?void 0:S[s])==null?void 0:Y.ar)&&((J=(Z=i.instructions)==null?void 0:Z[s])==null?void 0:J.ar)&&e.jsx(v,{error:!0,children:(ee=(F=i.instructions)==null?void 0:F[s])==null?void 0:ee.ar})]}),s>0&&e.jsx(d,{item:!0,xs:2,children:e.jsx(Ye,{style:{fontSize:"20px",marginTop:"8px"},onClick:()=>x.remove(s)})})]},s)}),e.jsx(d,{item:!0,children:e.jsx(X,{style:{width:"auto",display:"inline-flex",alignSelf:"flex-start"},startIcon:e.jsx(le,{}),onClick:()=>x.push({en:"",ar:""}),children:m.formatMessage({id:"services.labTechnician.addMoreInstructions"})})})]})})]})}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"min_visit_price",children:m.formatMessage({id:"services.minVisitPrice"})}),e.jsx(k,{type:"number",fullWidth:!0,id:"min_visit_price",placeholder:m.formatMessage({id:"services.minVisitPrice"}),...T("min_visit_price"),error:!!(b.min_visit_price&&i.min_visit_price)})]}),b.min_visit_price&&i.min_visit_price&&e.jsx(v,{error:!0,id:"helper-min_visit_price",children:i==null?void 0:i.min_visit_price})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"min_test_price",children:m.formatMessage({id:"services.minServicePrice"})}),e.jsx(k,{type:"number",fullWidth:!0,id:"min_test_price",placeholder:m.formatMessage({id:"services.minServicePrice"}),...T("min_test_price"),error:!!(b.min_test_price&&i.min_test_price)})]}),b.min_test_price&&i.min_test_price&&e.jsx(v,{error:!0,id:"helper-min_test_price",children:i==null?void 0:i.min_test_price})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"discount",children:m.formatMessage({id:"services.discount"})}),e.jsx(k,{type:"number",fullWidth:!0,id:"discount",placeholder:m.formatMessage({id:"services.discount"}),...T("discount"),error:!!(b.discount&&i.discount)})]}),b.discount&&i.discount&&e.jsx(v,{error:!0,id:"helper-discount",children:i==null?void 0:i.discount})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"status",children:m.formatMessage({id:"services.labTechnician.serviceStatus"})}),e.jsx(de,{fullWidth:!0,children:e.jsxs(Ee,{id:"status",displayEmpty:!0,value:w.status,onChange:x=>W("status",x.target.value),children:[e.jsx(N,{value:"",children:e.jsx("em",{children:m.formatMessage({id:"common.none"})})}),B==null?void 0:B.map(x=>e.jsx(N,{value:x.value,children:x.label[c]},x.value))]})})]}),b.status&&i.status&&e.jsx(v,{error:!0,id:"helper-status",children:i==null?void 0:i.status})]})]})})})}),e.jsx(ae,{}),e.jsx(Ne,{sx:{p:2.5},children:e.jsx(d,{container:!0,justifyContent:"right",alignItems:"center",children:e.jsx(d,{item:!0,children:e.jsxs(r,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(X,{color:"error",onClick:n,children:m.formatMessage({id:"common.cancel"})}),e.jsx(De,{type:"submit",loading:V,loadingIndicator:m.formatMessage({id:"common.processing"}),variant:"contained",children:t?m.formatMessage({id:"services.labTechnician.editServiceTitle"}):m.formatMessage({id:"services.labTechnician.addSubmitButton"})})]})})})})]})})})})})}function Ct({open:t,handleClose:f,handleSubmit:_}){const n=z();return e.jsx(oe,{title:n.formatMessage({id:"services.labTechnician.deactivateTest.title"}),actionTitle:n.formatMessage({id:"common.deactivate"}),open:t,handleClose:f,handleSubmit:_,styles:{width:"600px"},children:e.jsxs(r,{spacing:2,children:[e.jsx(j,{children:n.formatMessage({id:"services.labTechnician.deactivateTest.subtitle"})}),e.jsx(j,{variant:"h4",children:n.formatMessage({id:"services.labTechnician.deactivateTest.appointmentTitle"})}),e.jsx(j,{children:n.formatMessage({id:"services.labTechnician.deactivateTest.appointmentSubtitle"})}),e.jsx(j,{variant:"h4",children:n.formatMessage({id:"services.labTechnician.deactivateTest.accessTitle"})}),e.jsx(j,{children:n.formatMessage({id:"services.labTechnician.deactivateTest.accessSubTitle"})}),e.jsx(j,{variant:"h4",children:n.formatMessage({id:"services.labTechnician.deactivateTest.historyTitle"})}),e.jsx(j,{children:n.formatMessage({id:"services.labTechnician.deactivateTest.historySubTitle"})}),e.jsx(j,{children:n.formatMessage({id:"services.labTechnician.deactivateTest.bottomConfirm"})})]})})}function yt({open:t,handleClose:f,handleSubmit:_}){const n=z();return e.jsx(oe,{title:n.formatMessage({id:"services.labTechnician.activateTest.title"}),open:t,handleClose:f,handleSubmit:_,children:e.jsx(r,{spacing:2,children:e.jsx(j,{children:n.formatMessage({id:"services.labTechnician.activateTest.confirmation"})})})})}function kt({setButton:t}){const{lang:f}=ce(),{data:_,error:n,isLoading:m,setSorting:B,setFilterCriteria:c,setPagination:R,url:M}=Qe(),a=z(),H=re(),i=Le(H.breakpoints.down("sm")),{defaultList:b}=he(te.PACKAGE_STATUS),[K,V]=h.useState(!1),[T,w]=h.useState(null),[$,W]=h.useState(null),[x,C]=h.useState(0),[s,p]=h.useState(0),[P,D]=h.useState(0),A=()=>{W(null),V(!0)},{filter:O,search:q,setSearch:G}=qe(),l=h.useCallback(async()=>{try{await se(s,{status:Q.Active},M).then(g=>{L(a.formatMessage({id:"services.labTechnician.activateTest.success"})),p(0)})}catch{p(0)}},[s,M,a]),u=h.useCallback(async()=>{try{await se(P,{status:Q.InActive},M).then(g=>{L(a.formatMessage({id:"services.labTechnician.deactivateTest.success"})),D(0)})}catch{D(0)}},[P,M,a]),o=h.useCallback(async()=>{try{await lt(x,M).then(g=>{L(a.formatMessage({id:"services.labTechnician.deleteSuccess"})),C(0)})}catch{C(0)}},[x,M,a]),E=h.useCallback(async g=>{try{se(T==null?void 0:T.id,{status:g},M).then(I=>{L(a.formatMessage({id:"services.statusEditSuccess"})),w(null)})}catch{w(null)}},[T,M,a]);h.useEffect(()=>{c(O)},[O]),h.useEffect(()=>(t(e.jsx(X,{variant:"contained",startIcon:e.jsx(le,{}),onClick:A,children:a.formatMessage({id:"services.labTechnician.addServiceTitle"})})),()=>t(null)),[t]);const U=h.useMemo(()=>[{header:a.formatMessage({id:"services.labTechnician.test"}),accessorKey:"name",enableSorting:!1,cell:({row:g})=>e.jsx(j,{variant:"subtitle1",children:g.original.name[f]})},{header:a.formatMessage({id:"services.medicalCenters"}),accessorKey:"medical_centers_count",cell:({row:g})=>e.jsx(ne,{className:"typography-inline",value:g.original.hospitals_count})},{header:a.formatMessage({id:"common.visits"}),accessorKey:"visits_count",disableSortBy:!0,cell:({row:g})=>e.jsx(ne,{className:"typography-inline",value:g.original.visits_count})},{header:a.formatMessage({id:"common.status"}),accessorKey:"status",cell:({row:g})=>e.jsx(Ke,{status:g.original.status,referenceKey:te.PACKAGE_STATUS})},{header:a.formatMessage({id:"common.createdOn"}),accessorKey:"created_at",cell:({row:g})=>{var I;return ze((I=g.original)==null?void 0:I.created_at).format(We)}},{header:a.formatMessage({id:"common.actions"}),accessorKey:"Actions",meta:{className:"cell-center"},enableSorting:!1,cell:({row:g})=>{const[I,S]=h.useState(null),Y=!!I,Z=F=>{S(F.currentTarget)},J=()=>{S(null)};return e.jsxs(e.Fragment,{children:[e.jsx(Oe,{onClick:Z,children:e.jsx(Re,{})}),e.jsxs(Ve,{anchorEl:I,open:Y,onClose:J,onClick:J,children:[e.jsx(N,{onClick:F=>{F.stopPropagation(),V(!0),W(g.original)},children:e.jsx(j,{variant:"body1",children:a.formatMessage({id:"services.labTechnician.editTest"})})}),g.original.status===Q.Active&&e.jsx(N,{onClick:F=>{F.stopPropagation(),D(g.original.id)},children:e.jsx(j,{variant:"body1",children:a.formatMessage({id:"services.labTechnician.deactivateTest.action"})})}),g.original.status===Q.InActive&&e.jsx(N,{onClick:F=>{F.stopPropagation(),p(g.original.id)},children:e.jsx(j,{variant:"body1",children:a.formatMessage({id:"services.labTechnician.activateTest.action"})})}),e.jsx(N,{onClick:F=>{F.stopPropagation(),C(g.original.id)},children:e.jsx(j,{variant:"body1",children:a.formatMessage({id:"services.labTechnician.deleteTest"})})})]})]})}}],[]);return e.jsxs(e.Fragment,{children:[e.jsx($e,{data:_,columns:U,isLoading:m,setPagination:g=>{R(g)},setSortingParams:g=>{B(g)},children:e.jsx(Ge,{content:!1,children:e.jsxs(r,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",justifyContent:"space-between",sx:{padding:2,...i&&{"& .MuiOutlinedInput-root, & .MuiFormControl-root":{width:"100%"}}},children:[e.jsx(ue,{sx:{width:{xs:"70%",md:"70%"}},children:e.jsx(r,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(He,{value:q,onFilterChange:g=>G(g),placeholder:a.formatMessage({id:"services.labTechnician.searchService"})})})}),e.jsx(r,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",sx:{width:{xs:"100%",sm:"auto"}},children:e.jsx(r,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(X,{variant:"outlined",startIcon:e.jsx(Xe,{}),children:a.formatMessage({id:"common.export"})})})})]})})}),K&&e.jsx(vt,{open:K,handleClose:()=>{V(!1)},url:M,test:$}),e.jsx(Ct,{open:!!P,handleSubmit:u,handleClose:()=>{D(0)}}),e.jsx(yt,{open:!!s,handleSubmit:l,handleClose:()=>{p(0)}}),!!x&&e.jsx(Je,{open:!!x,handleSubmit:o,handleClose:()=>{C(0)}}),T&&e.jsx(rt,{title:a.formatMessage({id:"medicalCenter.editTitle"}),open:!!T,statusList:b,status:T==null?void 0:T.status,handleSubmit:E,handleClose:()=>{w(null)}})]})}const St=t=>{var _,n,m,B,c;const f={name_en:"",name_ar:"",min_visit_price:"",min_package_price:"",discount:"",status:1,description_en:"",description_ar:"",lab_test_ids:[],instruction:[{en:"",ar:""}],result_time:"",image:""};return t?{name_en:(_=t==null?void 0:t.name)==null?void 0:_.en,name_ar:(n=t==null?void 0:t.name)==null?void 0:n.ar,min_visit_price:Number(t==null?void 0:t.min_visit_price),min_package_price:Number(t==null?void 0:t.min_package_price),discount:Number(t==null?void 0:t.discount),status:t==null?void 0:t.status,description_en:(m=t==null?void 0:t.description)==null?void 0:m.en,description_ar:(B=t==null?void 0:t.description)==null?void 0:B.ar,lab_test_ids:(c=t==null?void 0:t.package_tests)==null?void 0:c.map(R=>R.test_id),instruction:(t==null?void 0:t.instruction)||[{en:"",ar:""}],result_time:t==null?void 0:t.result_time,image:t==null?void 0:t.image}:f};function At({subService:t,url:f,open:_,handleClose:n,packageType:m}){const B=re(),c=z(),{lang:R}=ce(),{defaultList:M}=he(te.PACKAGE_STATUS),[a,H]=h.useState(void 0),{data:i,error:b,setFilterCriteria:K}=Qe(!0),[V,T]=h.useState([]),w=jt(l=>l.app.loading),[$,W]=h.useState(`${t&&(t!=null&&t.image)?t.image:""}`);h.useEffect(()=>{a&&(W(URL.createObjectURL(a)),tt(a,l=>{G("image",l)}))},[a]);const x=h.useMemo(()=>St(t),[]),C=ye({initialValues:x,validationSchema:dt(c),enableReinitialize:!0,onSubmit:async(l,{setSubmitting:u})=>{try{let o={...l,package_type:ie.LAB_TECHNICIAN,name:{en:l==null?void 0:l.name_en,ar:l==null?void 0:l.name_ar},description:{en:l==null?void 0:l.description_en,ar:l==null?void 0:l.description_ar}};(o.discount===""||o.discount===null||o.discount===void 0)&&(o.discount=0),o.image.includes("http")&&delete o.image,delete o.name_en,delete o.name_ar,delete o.description_en,delete o.description_ar,t?await me(t.id,o,f).then(E=>{L(c.formatMessage({id:"services.editPackageSuccess"})),u(!1),n()}):await ut(o,f).then(E=>{L(c.formatMessage({id:"services.addPackageSuccess"})),u(!1),n()})}catch(o){console.error(o),u(!1)}}});h.useEffect(()=>{var l;(l=i==null?void 0:i.data)!=null&&l.length&&T(i.data)},[i]);const{errors:s,touched:p,handleSubmit:P,isSubmitting:D,getFieldProps:A,values:O,setFieldTouched:q,setFieldValue:G}=C;return e.jsx(e.Fragment,{children:_&&e.jsx(ke,{open:_,handleClose:n,children:e.jsx(Se,{value:C,children:e.jsx(Ae,{dateAdapter:Pe,children:e.jsxs(Ie,{autoComplete:"off",noValidate:!0,onSubmit:P,children:[e.jsx(Fe,{children:t?c.formatMessage({id:"services.editPackage"}):c.formatMessage({id:"services.addNewPackage"})}),e.jsx(ae,{}),e.jsx(Be,{sx:{p:2.5},children:e.jsxs(d,{container:!0,spacing:3,children:[e.jsxs(d,{item:!0,xs:12,md:3,children:[e.jsxs(r,{direction:"row",justifyContent:"center",sx:{mt:3},children:[e.jsxs(st,{htmlFor:"change-avtar",sx:{position:"relative",borderRadius:"50%",overflow:"hidden","&:hover .MuiBox-root":{opacity:1},cursor:"pointer"},children:[e.jsx(Ue,{alt:"Avatar 1",src:$,sx:{width:72,height:72,border:"1px dashed"}}),e.jsx(ue,{sx:{position:"absolute",top:0,left:0,background:B.palette.mode===it.DARK?"rgba(255, 255, 255, .75)":"rgba(0,0,0,.65)",width:"100%",height:"100%",opacity:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(r,{spacing:.5,alignItems:"center",children:[e.jsx(gt,{style:{color:B.palette.secondary.lighter,fontSize:"2rem"}}),e.jsx(j,{sx:{color:"secondary.lighter"},children:c.formatMessage({id:"common.upload"})})]})})]}),e.jsx(k,{type:"file",id:"change-avtar",placeholder:"Outlined",variant:"outlined",inputProps:{accept:"image/*"},sx:{display:"none"},onChange:l=>{var u;q("image",!0),H((u=l.target.files)==null?void 0:u[0])}})]}),e.jsx(r,{direction:"row",justifyContent:"center",children:p.image&&s.image&&e.jsx(v,{error:!0,id:"helper-image",children:s==null?void 0:s.image})})]}),e.jsx(d,{item:!0,xs:12,md:8,children:e.jsxs(d,{container:!0,spacing:3,children:[e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"name_en",children:c.formatMessage({id:"services.packageNameEn"})}),e.jsx(k,{fullWidth:!0,id:"name_en",placeholder:c.formatMessage({id:"services.packageNameEn"}),...A("name_en"),error:!!(p.name_en&&s.name_en)})]}),p.name_en&&s.name_en&&e.jsx(v,{error:!0,id:"helper-name_en",children:s==null?void 0:s.name_en})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"name_ar",children:c.formatMessage({id:"services.packageNameAr"})}),e.jsx(k,{fullWidth:!0,id:"name_ar",placeholder:c.formatMessage({id:"services.packageNameAr"}),...A("name_ar"),error:!!(p.name_ar&&s.name_ar)})]}),p.name_ar&&s.name_ar&&e.jsx(v,{error:!0,id:"helper-name_ar",children:s==null?void 0:s.name_ar})]}),e.jsx(d,{item:!0,xs:6,children:e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"lab_test_id",children:c.formatMessage({id:"services.labTechnician.testContains"})}),e.jsx(de,{fullWidth:!0,children:e.jsx(xt,{label:c.formatMessage({id:"common.selectOp"}),fieldId:"lab_test_ids",options:V,isLoading:w,fieldName:"name",onSearch:l=>K({...(l==null?void 0:l.length)>0&&{search:l}}),multiple:!0})}),p.lab_test_ids&&s.lab_test_ids&&e.jsx(v,{error:!0,id:"helper-lab_test_id",children:s==null?void 0:s.lab_test_ids})]})}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"result_time",children:c.formatMessage({id:"services.labTechnician.resultTime"})}),e.jsx(k,{type:"number",fullWidth:!0,id:"resultTime",placeholder:c.formatMessage({id:"services.labTechnician.resultTime"}),...A("result_time"),error:!!(p.result_time&&s.result_time)})]}),p.result_time&&s.result_time&&e.jsx(v,{error:!0,id:"helper-result_time",children:s==null?void 0:s.result_time})]}),e.jsx(d,{item:!0,xs:12,sm:12,children:e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"instruction",children:c.formatMessage({id:"services.labTechnician.instructions"})}),e.jsx(we,{name:"instruction",render:l=>e.jsxs(r,{spacing:2,children:[O.instruction.map((u,o)=>{var E,U,g,I,S,Y,Z,J,F,ee,pe,ge,xe,je,fe,_e,be,Te,Me,ve;return e.jsxs(d,{container:!0,spacing:1,children:[e.jsxs(d,{item:!0,xs:5,children:[e.jsx(k,{fullWidth:!0,id:`instruction[${o}].en`,placeholder:c.formatMessage({id:"services.labTechnician.instructionsEn"}),...A(`instruction[${o}].en`),error:!!((U=(E=p.instruction)==null?void 0:E[o])!=null&&U.en&&((I=(g=s.instruction)==null?void 0:g[o])!=null&&I.en))}),((Y=(S=p.instruction)==null?void 0:S[o])==null?void 0:Y.en)&&((J=(Z=s.instruction)==null?void 0:Z[o])==null?void 0:J.en)&&e.jsx(v,{error:!0,children:(ee=(F=s.instruction)==null?void 0:F[o])==null?void 0:ee.en})]}),e.jsxs(d,{item:!0,xs:5,children:[e.jsx(k,{fullWidth:!0,id:`instruction[${o}].ar`,placeholder:c.formatMessage({id:"services.labTechnician.instructionsAr"}),...A(`instruction[${o}].ar`),error:!!((ge=(pe=p.instruction)==null?void 0:pe[o])!=null&&ge.ar&&((je=(xe=s.instruction)==null?void 0:xe[o])!=null&&je.ar))}),((_e=(fe=p.instruction)==null?void 0:fe[o])==null?void 0:_e.ar)&&((Te=(be=s.instruction)==null?void 0:be[o])==null?void 0:Te.ar)&&e.jsx(v,{error:!0,children:(ve=(Me=s.instruction)==null?void 0:Me[o])==null?void 0:ve.ar})]}),o>0&&e.jsx(d,{item:!0,xs:2,children:e.jsx(Ye,{style:{fontSize:"20px",marginTop:"8px"},onClick:()=>l.remove(o)})})]},o)}),e.jsx(d,{item:!0,children:e.jsx(X,{style:{width:"auto",display:"inline-flex",alignSelf:"flex-start"},startIcon:e.jsx(le,{}),onClick:()=>l.push({en:"",ar:""}),children:c.formatMessage({id:"services.labTechnician.addMoreInstructions"})})})]})})]})}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"min_visit_price",children:c.formatMessage({id:"services.minVisitPrice"})}),e.jsx(k,{type:"number",fullWidth:!0,id:"min_visit_price",placeholder:c.formatMessage({id:"services.minVisitPrice"}),...A("min_visit_price"),error:!!(p.min_visit_price&&s.min_visit_price)})]}),p.min_visit_price&&s.min_visit_price&&e.jsx(v,{error:!0,id:"helper-min_visit_price",children:s==null?void 0:s.min_visit_price})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"min_package_price",children:c.formatMessage({id:"services.minServicePrice"})}),e.jsx(k,{type:"number",fullWidth:!0,id:"min_package_price",placeholder:c.formatMessage({id:"services.minServicePrice"}),...A("min_package_price"),error:!!(p.min_package_price&&s.min_package_price)})]}),p.min_package_price&&s.min_package_price&&e.jsx(v,{error:!0,id:"helper-min_package_price",children:s==null?void 0:s.min_package_price})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"discount",children:c.formatMessage({id:"services.discount"})}),e.jsx(k,{type:"number",fullWidth:!0,id:"discount",placeholder:c.formatMessage({id:"services.discount"}),...A("discount"),error:!!(p.discount&&s.discount)})]}),p.discount&&s.discount&&e.jsx(v,{error:!0,id:"helper-discount",children:s==null?void 0:s.discount})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"status",children:c.formatMessage({id:"services.packageStatus"})}),e.jsx(de,{fullWidth:!0,children:e.jsxs(Ee,{id:"status",displayEmpty:!0,value:O.status,onChange:l=>G("status",l.target.value),children:[e.jsx(N,{value:"",children:e.jsx("em",{children:c.formatMessage({id:"common.none"})})}),M==null?void 0:M.map(l=>e.jsx(N,{value:l.value,children:l.label[R]},l.value))]})})]}),p.status&&s.status&&e.jsx(v,{error:!0,id:"helper-status",children:s==null?void 0:s.status})]}),e.jsxs(d,{item:!0,xs:12,sm:12,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"description_en",children:c.formatMessage({id:"services.packageDescEn"})}),e.jsx(k,{type:"text",rows:2,multiline:!0,fullWidth:!0,id:"description_en",placeholder:c.formatMessage({id:"services.packageDescEn"}),...A("description_en"),error:!!(p.description_en&&s.description_en)})]}),p.description_en&&s.description_en&&e.jsx(v,{error:!0,id:"helper-description_en",children:s==null?void 0:s.description_en})]}),e.jsxs(d,{item:!0,xs:12,sm:12,children:[e.jsxs(r,{spacing:1,children:[e.jsx(y,{htmlFor:"description_ar",children:c.formatMessage({id:"services.packageDescAr"})}),e.jsx(k,{type:"text",rows:2,multiline:!0,fullWidth:!0,id:"description_ar",placeholder:c.formatMessage({id:"services.packageDescAr"}),...A("description_ar"),error:!!(p.description_ar&&s.description_ar)})]}),p.description_ar&&s.description_ar&&e.jsx(v,{error:!0,id:"helper-description_ar",children:s==null?void 0:s.description_ar})]})]})})]})}),e.jsx(ae,{}),e.jsx(Ne,{sx:{p:2.5},children:e.jsx(d,{container:!0,justifyContent:"right",alignItems:"center",children:e.jsx(d,{item:!0,children:e.jsxs(r,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(X,{color:"error",onClick:n,children:c.formatMessage({id:"common.cancel"})}),e.jsx(De,{type:"submit",loading:D,loadingIndicator:c.formatMessage({id:"common.processing"}),variant:"contained",children:t?c.formatMessage({id:"services.editPackage"}):c.formatMessage({id:"services.addNewPackage"})})]})})})})]})})})})})}function Pt({open:t,handleClose:f,handleSubmit:_}){const n=z();return e.jsx(oe,{title:n.formatMessage({id:"services.labTechnician.activatePackage.title"}),open:t,handleClose:f,handleSubmit:_,children:e.jsx(r,{spacing:2,children:e.jsx(j,{children:n.formatMessage({id:"services.labTechnician.activatePackage.confirmation"})})})})}function It({open:t,handleClose:f,handleSubmit:_}){const n=z();return e.jsx(oe,{title:n.formatMessage({id:"services.labTechnician.deactivatePackage.title"}),actionTitle:n.formatMessage({id:"common.deactivate"}),open:t,handleClose:f,handleSubmit:_,styles:{width:"600px"},children:e.jsxs(r,{spacing:2,children:[e.jsx(j,{children:n.formatMessage({id:"services.labTechnician.deactivatePackage.subtitle"})}),e.jsx(j,{variant:"h4",children:n.formatMessage({id:"services.labTechnician.deactivatePackage.appointmentTitle"})}),e.jsx(j,{children:n.formatMessage({id:"services.labTechnician.deactivatePackage.appointmentSubtitle"})}),e.jsx(j,{variant:"h4",children:n.formatMessage({id:"services.labTechnician.deactivatePackage.accessTitle"})}),e.jsx(j,{children:n.formatMessage({id:"services.labTechnician.deactivatePackage.accessSubTitle"})}),e.jsx(j,{variant:"h4",children:n.formatMessage({id:"services.labTechnician.deactivatePackage.historyTitle"})}),e.jsx(j,{children:n.formatMessage({id:"services.labTechnician.deactivatePackage.historySubTitle"})}),e.jsx(j,{children:n.formatMessage({id:"services.labTechnician.deactivatePackage.bottomConfirm"})})]})})}function Ft({setButton:t}){const{lang:f}=ce(),{data:_,error:n,isLoading:m,setSorting:B,setFilterCriteria:c,setPagination:R,url:M}=ht(ie.LAB_TECHNICIAN),a=z(),H=re(),i=Le(H.breakpoints.down("sm")),[b,K]=h.useState(!1),[V,T]=h.useState(null),[w,$]=h.useState(0),[W,x]=h.useState(0),[C,s]=h.useState(0),p=()=>{T(null),K(!0)},{filter:P,search:D,setSearch:A}=qe(),O=h.useCallback(async()=>{try{await me(W,{status:Q.Active},M).then(u=>{L(a.formatMessage({id:"services.labTechnician.activatePackage.success"})),x(0)})}catch{x(0)}},[W,M,a]),q=h.useCallback(async()=>{try{await me(C,{status:Q.InActive},M).then(u=>{L(a.formatMessage({id:"services.labTechnician.deactivatePackage.success"})),s(0)})}catch{s(0)}},[C,M,a]),G=h.useCallback(async()=>{try{await pt(w,M).then(u=>{L(a.formatMessage({id:"services.deletePackageSuccess"})),$(0)})}catch{$(0)}},[w,M,a]);h.useEffect(()=>{c(P)},[P]),h.useEffect(()=>(t(e.jsx(X,{variant:"contained",startIcon:e.jsx(le,{}),onClick:p,children:a.formatMessage({id:"services.addNewPackage"})})),()=>t(null)),[t]);const l=h.useMemo(()=>[{header:a.formatMessage({id:"services.packageName"}),accessorKey:"name",enableSorting:!1,cell:({row:u})=>e.jsxs(r,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(Ue,{alt:"Avatar 1",size:"sm",src:u.original.image}),e.jsx(r,{spacing:0,children:e.jsx(j,{variant:"subtitle1",children:u.original.name[f]})})]})},{header:a.formatMessage({id:"services.medicalCenters"}),accessorKey:"medical_centers_count",cell:({row:u})=>e.jsx(ne,{className:"typography-inline",value:u.original.hospitals_count})},{header:a.formatMessage({id:"common.visits"}),accessorKey:"visits_count",disableSortBy:!0,cell:({row:u})=>e.jsx(ne,{className:"typography-inline",value:u.original.visits_count})},{header:a.formatMessage({id:"common.status"}),accessorKey:"status",cell:({row:u})=>e.jsx(Ke,{status:u.original.status,referenceKey:te.PACKAGE_STATUS})},{header:a.formatMessage({id:"common.createdOn"}),accessorKey:"created_at",cell:({row:u})=>{var o;return ze((o=u.original)==null?void 0:o.created_at).format(We)}},{header:a.formatMessage({id:"common.actions"}),accessorKey:"Actions",meta:{className:"cell-center"},enableSorting:!1,cell:({row:u})=>{const[o,E]=h.useState(null),U=!!o,g=S=>{E(S.currentTarget)},I=()=>{E(null)};return e.jsxs(e.Fragment,{children:[e.jsx(Oe,{onClick:g,children:e.jsx(Re,{})}),e.jsxs(Ve,{anchorEl:o,open:U,onClose:I,onClick:I,children:[e.jsx(N,{onClick:S=>{S.stopPropagation(),K(!0),T(u.original)},children:e.jsx(j,{variant:"body1",children:a.formatMessage({id:"services.editPackageInfo"})})}),u.original.status===Q.Active&&e.jsx(N,{onClick:S=>{S.stopPropagation(),s(u.original.id)},children:e.jsx(j,{variant:"body1",children:a.formatMessage({id:"services.labTechnician.deactivatePackage.action"})})}),u.original.status===Q.InActive&&e.jsx(N,{onClick:S=>{S.stopPropagation(),x(u.original.id)},children:e.jsx(j,{variant:"body1",children:a.formatMessage({id:"services.labTechnician.activatePackage.action"})})}),e.jsx(N,{onClick:S=>{S.stopPropagation(),$(u.original.id)},children:e.jsx(j,{variant:"body1",children:a.formatMessage({id:"services.deletePackage"})})})]})]})}}],[]);return e.jsxs(e.Fragment,{children:[e.jsx($e,{data:_,columns:l,isLoading:m,setPagination:u=>{R(u)},setSortingParams:u=>{B(u)},children:e.jsx(Ge,{content:!1,children:e.jsxs(r,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",justifyContent:"space-between",sx:{padding:2,...i&&{"& .MuiOutlinedInput-root, & .MuiFormControl-root":{width:"100%"}}},children:[e.jsx(ue,{sx:{width:{xs:"70%",md:"70%"}},children:e.jsx(r,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(He,{value:D,onFilterChange:u=>A(u),placeholder:a.formatMessage({id:"services.searchPackage"})})})}),e.jsx(r,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",sx:{width:{xs:"100%",sm:"auto"}},children:e.jsx(r,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(X,{variant:"outlined",startIcon:e.jsx(Xe,{}),children:a.formatMessage({id:"common.export"})})})})]})})}),b&&e.jsx(At,{open:b,handleClose:()=>{K(!1)},url:M,subService:V,packageType:ie.LAB_TECHNICIAN}),e.jsx(It,{open:!!C,handleSubmit:q,handleClose:()=>{s(0)}}),e.jsx(Pt,{open:!!W,handleSubmit:O,handleClose:()=>{x(0)}}),!!w&&e.jsx(Je,{open:!!w,handleSubmit:G,handleClose:()=>{$(0)}})]})}function Bt(t){return[{title:t.formatMessage({id:"sidebar.home"}),to:nt},{title:t.formatMessage({id:"services.labTechnician.title"})}]}function es(){const t=z(),[f,_]=h.useState(1),[n,m]=h.useState(null);return e.jsxs(e.Fragment,{children:[e.jsx(at,{custom:!0,links:Bt(t)}),e.jsx(r,{direction:"row",marginBottom:"20px",spacing:2,justifyContent:"space-between",alignItems:"center",children:e.jsx(j,{variant:"h2",children:t.formatMessage({id:"services.labTechnician.title"})})}),e.jsxs(r,{direction:"row",marginBottom:"20px",spacing:2,justifyContent:"space-between",alignItems:"center",children:[e.jsxs(r,{direction:"row",marginBottom:"20px",spacing:2,children:[e.jsx(Ce,{color:f===1?"primary":"default",label:t.formatMessage({id:"services.labTechnician.individualTests"}),sx:{borderRadius:"15px"},onClick:()=>{_(1)},variant:"filled"}),e.jsx(Ce,{color:f===2?"primary":"default",label:t.formatMessage({id:"services.labTechnician.labPackages"}),sx:{borderRadius:"15px"},onClick:()=>{_(2)},variant:"filled"})]}),n]}),f===1&&e.jsx(kt,{setButton:m}),f===2&&e.jsx(Ft,{setButton:m})]})}export{es as default};
