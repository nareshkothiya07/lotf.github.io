import{u as I,t as A,j as e,S as r,T as m,W as V,a as W,v as q,r as i,c as b,i as G,X as J,R as Q,x as P,y as X,z as $,M as Y,E as Z,H as x,J as ee,q as T,P as te,ax as se,K as ae,B as ne,U as ie}from"./index-DSO9TgYq.js";import{d as oe}from"./dayjs.min-pRfd56nx.js";import{u as re,d as le,a as ce}from"./patient-B2iOhP67.js";import{C as de}from"./ConfirmationDialog-DR_Ho8RD.js";import{D as me}from"./DebouncedInput-DhmfX_1V.js";import{C as E}from"./CustomTypography-CRnDvUFn.js";import{u as ue}from"./useFilterAndSearch-PJD0Zg8P.js";import{E as pe}from"./EditStatusDialog-BIVGlZRP.js";import{u as ge}from"./useStatusList-Dbp-x5Xm.js";import{A as he}from"./ArrowUpOutlined-C9GTlrEN.js";import"./Dialog-CPoUMqzk.js";import"./CloseOutlined-DRBnXhIJ.js";function fe({open:l,patient:u,handleClose:j,handleSubmit:h}){const c=I(),{lang:d}=A();return e.jsx(de,{title:c.formatMessage({id:"patient.delete.title"}),open:l,handleClose:j,handleSubmit:h,actionTitle:c.formatMessage({id:"common.delete"}),children:e.jsxs(r,{spacing:1,children:[e.jsx(m,{children:c.formatMessage({id:"patient.delete.subTitle"},{name:u==null?void 0:u.name[d]})}),e.jsx(m,{children:c.formatMessage({id:"patient.delete.confirmation"})})]})})}function xe(l){return[{title:l.formatMessage({id:"sidebar.home"}),to:ie},{title:l.formatMessage({id:"sidebar.patients"})}]}function ke(){const{lang:l}=A(),{data:u,error:j,isLoading:h,setPagination:c,url:d,setFilterCriteria:v,setSorting:k}=re(),M=V(),w=W(),s=I(),{defaultList:B}=ge(P.PATIENTS_STATUS),N=q(w.breakpoints.down("sm")),[f,p]=i.useState(0),[_,D]=i.useState(null),[a,g]=i.useState(null),F=i.useCallback(t=>{M(`/patients/${t}`)},[M]),K=i.useCallback(async()=>{try{await le(f,d).then(t=>{b(s.formatMessage({id:"patient.delete.deleteSucess"})),p(0)})}catch{p(0)}},[f,d,s]),L=i.useCallback(async t=>{try{ce(a==null?void 0:a.id,d,{status:t}).then(n=>{b(s.formatMessage({id:"patient.statusUpdateSuccess"})),g(null)})}catch{g(null)}},[a,d,s]),{filter:S,search:O,setSearch:R}=ue();i.useEffect(()=>{v(S)},[S]);const U=i.useMemo(()=>[{header:s.formatMessage({id:"profile.id"}),accessorKey:"id",cell:({row:t})=>{var n;return(n=t.original)==null?void 0:n.id}},{header:s.formatMessage({id:"patient.patientName"}),accessorKey:"name",enableSorting:!1,cell:({row:t})=>e.jsxs(r,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(G,{alt:"Avatar 1",size:"sm",src:t.original.photo}),e.jsx(E,{className:"typography-inline",value:t.original.name[l]})]})},{header:s.formatMessage({id:"profile.phoneNo"}),accessorKey:"phone_number",cell:({row:t})=>e.jsx(E,{className:"typography-inline",value:J(t.original.phone_number)})},{header:s.formatMessage({id:"common.status"}),accessorKey:"status",cell:t=>e.jsx(Q,{status:t.getValue(),referenceKey:P.PATIENTS_STATUS})},{header:s.formatMessage({id:"common.joinedon"}),accessorKey:"created_at",cell:({row:t})=>{var n;return oe((n=t.original)==null?void 0:n.created_at).format(X)}},{header:s.formatMessage({id:"common.actions"}),accessorKey:"Actions",meta:{className:"cell-center"},enableSorting:!1,cell:({row:t})=>{const[n,y]=i.useState(null),H=!!n,z=o=>{y(o.currentTarget)},C=()=>{y(null)};return e.jsxs(e.Fragment,{children:[e.jsx($,{onClick:z,children:e.jsx(Y,{})}),e.jsxs(Z,{anchorEl:n,open:H,onClose:C,onClick:C,children:[e.jsx(x,{onClick:o=>{o.stopPropagation(),g(t.original)},children:e.jsx(m,{variant:"body1",children:s.formatMessage({id:"common.editStatus"})})}),e.jsx(x,{onClick:o=>{o.stopPropagation(),F(t.original.id)},children:e.jsx(m,{variant:"body1",children:s.formatMessage({id:"patient.editProfile"})})}),e.jsx(x,{onClick:o=>{o.stopPropagation(),p(t.original.id),D(t.original)},children:e.jsx(m,{variant:"body1",children:s.formatMessage({id:"patient.deletePatient"})})})]})]})}}],[]);return e.jsxs(e.Fragment,{children:[e.jsx(ee,{custom:!0,links:xe(s)}),e.jsxs(r,{direction:"row",marginBottom:"20px",spacing:2,justifyContent:"space-between",alignItems:"center",children:[e.jsx(m,{variant:"h2",children:s.formatMessage({id:"sidebar.patients"})}),e.jsx(T,{variant:"contained",startIcon:e.jsx(te,{}),component:se,to:"/patients/create",children:s.formatMessage({id:"patient.addPatient"})})]}),e.jsx(ae,{data:u,columns:U,isLoading:h,setPagination:t=>{c(t)},setSortingParams:t=>{k(t)},children:e.jsxs(r,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",justifyContent:"space-between",sx:{padding:2,...N&&{"& .MuiOutlinedInput-root, & .MuiFormControl-root":{width:"100%"}}},children:[e.jsx(ne,{sx:{width:{xs:"70%",md:"70%"}},children:e.jsx(r,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(me,{value:O,onFilterChange:t=>R(t),placeholder:s.formatMessage({id:"doctor.searchPlaceholder"})})})}),e.jsx(r,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",sx:{width:{xs:"100%",sm:"auto"}},children:e.jsx(r,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(T,{variant:"outlined",startIcon:e.jsx(he,{}),children:s.formatMessage({id:"common.export"})})})})]})}),e.jsx(fe,{open:!!f,patient:_,handleSubmit:K,handleClose:()=>{p(0)}}),a&&e.jsx(pe,{title:s.formatMessage({id:"patient.editTitle"}),open:!!a,statusList:B,status:a==null?void 0:a.status,handleSubmit:L,handleClose:()=>{g(null)}})]})}export{ke as default};
