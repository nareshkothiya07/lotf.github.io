import{u as G,j as e,T as w,e as le,aw as $e,aS as K,B as C,y as Ce,X as Ue,Y as ls,Z as q,a as ds,r as M,t as he,b1 as Z,g as cs,b as me,a$ as hs,c as z,C as We,F as ue,L as je,A as He,d as xe,D as ze,f as Ge,G as d,S as g,h as Ke,i as Te,k as ms,l as L,m as R,I,aK as re,Q as Ye,b0 as ae,H as X,p as Je,q as N,s as be,W as us,aL as U,v as xs,b2 as gs,b3 as De,b4 as oe,aT as ps,aC as Ne,N as ye,aJ as fe,x as Qe,aF as ge,b7 as js,b9 as Re,ba as Be,ag as fs,bb as _s,bc as bs,bd as Pe,cI as Ms,b5 as vs,R as ws,be as Cs,K as ys,J as Ss,U as Ts}from"./index-DSO9TgYq.js";import{c as ie,e as ks,f as Fs,r as Is,g as Es,h as As,i as Ds,j as Ns,k as Rs,l as Bs,m as Ps}from"./employee-Ds4vdbPg.js";import{u as Y}from"./hooks-CMWd8yYb.js";import{d as te}from"./dayjs.min-pRfd56nx.js";import{R as Os}from"./RenderGender-B7FOG7SF.js";import{R as Oe,a as Xe,T as Ve}from"./RenderDay-DQUhTzfr.js";import{C as H}from"./CustomTypography-CRnDvUFn.js";import{E as Q,p as Vs}from"./medicalCenter-BJDU8s5Q.js";import{C as Ls}from"./CameraOutlined-D4Mj0cXe.js";import{P as qs}from"./react-number-format.es-Bl0F5VJY.js";import{u as $s}from"./useGenderList-C-bU5Ya0.js";import{u as Us}from"./useCountries-DSXcarux.js";import{p as Ws}from"./regex-AjllrUCH.js";import{A as Le}from"./Autocomplete-BOe_mB7V.js";import{A as Ze,D as es}from"./AdapterDayjs-DJXadXKJ.js";import{E as ke}from"./EditFilled-Bmyorrxv.js";import{E as Hs}from"./EducationAddDialog-BViYHM6V.js";import{u as zs,a as Gs,t as Ks}from"./useLanguageList-CLbSClFZ.js";import{D as Ys}from"./DeleteConfirmation-BqFOMagf.js";import{C as ss}from"./CircularLoader-BWmEA7Ji.js";import{G as Js}from"./GenericAutocomplete-D3M5FyqM.js";import{h as Qs}from"./handleScroll-BwFQoF1o.js";import{c as Xs}from"./sub-services-Cm3yL5Hw.js";import{C as Zs}from"./Checkbox-DyJiWu1i.js";import{D as ts,P as _e}from"./PlusCircleOutlined-C_mUG7bl.js";import{u as et}from"./useStatusList-Dbp-x5Xm.js";import{c as st}from"./common-9rbEmXms.js";import{E as Se}from"./EyeOutlined-ChV9zO9W.js";import{E as qe}from"./EyeInvisibleOutlined-CaFaFVHk.js";import{U as ne,A as tt}from"./AttachDocumentDialog-Cqj2T6SH.js";import{D as pe}from"./DownloadOutlined-BN5QXIj2.js";import{s as nt,c as it}from"./doctor-9YdFtdUi.js";import{F as rt}from"./FormControlLabel-DB_ChWU7.js";import{D as at}from"./DeleteOutlined-awUikH6H.js";import{T as ee}from"./TabPanel-BmkMU0MV.js";import{T as ns,a as se}from"./Tabs-CFBjtj-9.js";import{A as ot}from"./ArrowUpOutlined-C9GTlrEN.js";import"./Dialog-CPoUMqzk.js";import"./ConfirmationDialog-DR_Ho8RD.js";import"./Box-D442Dag1.js";const lt=()=>{var c,r;const s=G(),n=Y(t=>t.app.employee);return e.jsxs("div",{children:[e.jsxs(w,{variant:"h6",color:"secondary",sx:{textTransform:"uppercase"},children:[s.formatMessage({id:"profile.personalInfoTitle"})," "]}),e.jsx(le,{sx:{my:1}}),e.jsxs($e,{component:"nav","aria-label":"main mailbox folders  ",sx:{py:0,"& .MuiListItem-root":{p:0,py:"4px",display:"block"}},children:[e.jsx(K,{children:e.jsxs(C,{sx:{display:"inline"},children:[e.jsxs(w,{variant:"body1",color:"secondary",className:"typography-inline",children:[s.formatMessage({id:"medicalCenter.employeesTab.employeeId"}),":  "]}),e.jsx(H,{className:"typography-inline",value:n==null?void 0:n.hospital_employee_id})]})}),e.jsx(K,{children:e.jsxs(C,{sx:{display:"inline"},children:[e.jsxs(w,{variant:"body1",color:"secondary",className:"typography-inline",children:[s.formatMessage({id:"profile.gender"}),":  "]}),e.jsx(H,{className:"typography-inline",value:n==null?void 0:n.gender,renderFunction:t=>e.jsx(Os,{gender:t})})]})}),e.jsx(K,{children:e.jsxs(C,{sx:{display:"inline"},children:[e.jsxs(w,{variant:"body1",color:"secondary",className:"typography-inline",children:[s.formatMessage({id:"profile.nationality"}),":  "]}),e.jsx(H,{className:"typography-inline",value:n==null?void 0:n.nationality,renderFunction:t=>e.jsx(Oe,{code:t})})]})}),e.jsx(K,{children:e.jsxs(C,{sx:{display:"inline"},children:[e.jsxs(w,{variant:"body1",color:"secondary",className:"typography-inline",children:[s.formatMessage({id:"profile.nationalIdIqamaNumber"}),":  "]}),e.jsx(H,{className:"typography-inline",value:n==null?void 0:n.national_id})]})}),e.jsx(K,{children:e.jsxs(C,{sx:{display:"inline"},children:[e.jsxs(w,{variant:"body1",color:"secondary",className:"typography-inline",children:[s.formatMessage({id:"profile.dob"}),":  "]}),e.jsxs(w,{variant:"body1",className:"typography-inline",children:[te(n==null?void 0:n.dob).format(Ce)," "]}),e.jsx(H,{className:"typography-inline",value:n==null?void 0:n.dob,renderFunction:t=>te(t).format(Ce)})]})}),e.jsx(K,{children:e.jsxs(C,{sx:{display:"inline"},children:[e.jsxs(w,{variant:"body1",color:"secondary",className:"typography-inline",children:[s.formatMessage({id:"profile.country"}),":  "]}),e.jsx(H,{className:"typography-inline",value:n==null?void 0:n.country,renderFunction:t=>e.jsx(Oe,{code:t})})]})}),e.jsx(K,{children:e.jsxs(C,{sx:{display:"inline"},children:[e.jsxs(w,{variant:"body1",color:"secondary",className:"typography-inline",children:[s.formatMessage({id:"profile.city"}),":  "]}),e.jsx(H,{className:"typography-inline",value:n==null?void 0:n.city})]})}),e.jsx(K,{children:e.jsxs(C,{sx:{display:"inline"},children:[e.jsxs(w,{variant:"body1",color:"secondary",className:"typography-inline",children:[s.formatMessage({id:"profile.phoneNo"}),":  "]}),e.jsx(H,{className:"typography-inline",value:Ue(n==null?void 0:n.phone_number)})]})}),e.jsx(K,{children:e.jsxs(C,{sx:{display:"inline"},children:[e.jsxs(w,{variant:"body1",color:"secondary",className:"typography-inline",children:[s.formatMessage({id:"profile.email"}),":  "]}),e.jsx(H,{className:"typography-inline",value:n==null?void 0:n.email})]})})]}),(n==null?void 0:n.employee_type)!==Q.AMBULANCE_DRIVER&&e.jsxs(e.Fragment,{children:[e.jsxs(w,{sx:{mt:3},variant:"h6",color:"secondary",children:[s.formatMessage({id:"profile.bio"})," "]}),e.jsxs(w,{component:"div",children:[s.formatMessage({id:"profile.bioDescEn"})," "]}),e.jsx(w,{variant:"body1",color:"secondary",children:(r=(c=n==null?void 0:n.bio)==null?void 0:c.en)!=null&&r.trim()?n.bio.en:"No bio available"}),e.jsxs(w,{component:"div",children:[s.formatMessage({id:"profile.bioDescAr"})," "]}),e.jsx(w,{dir:"rtl",variant:"body1",color:"secondary",children:(n==null?void 0:n.bio)&&(n==null?void 0:n.bio.ar)})]})]})},dt=lt,ct=function(s,n){return ls().shape({hospital_employee_id:q().required(s.formatMessage({id:"common.validation.required"})),name_en:q().required(s.formatMessage({id:"common.validation.required"})),name_ar:q().required(s.formatMessage({id:"common.validation.required"})),gender:q().required(s.formatMessage({id:"common.validation.required"})),dob:q().required(s.formatMessage({id:"common.validation.required"})),nationality:q().required(s.formatMessage({id:"common.validation.required"})),national_id:q().required(s.formatMessage({id:"common.validation.required"})),photo:q().required(s.formatMessage({id:"common.validation.imageRequired"})),country:q().required(s.formatMessage({id:"common.validation.required"})),city:q().required(s.formatMessage({id:"common.validation.required"})),phone_number:q().matches(Ws,s.formatMessage({id:"common.validation.invalidPhone"})).required(s.formatMessage({id:"common.validation.required"})),email:q().email(s.formatMessage({id:"common.validation.invalidEmail"})).max(255).required(s.formatMessage({id:"common.validation.required"})),bio_en:q().when([],{is:()=>n!==Q.AMBULANCE_DRIVER,then:c=>c.required(s.formatMessage({id:"common.validation.required"})),otherwise:c=>c.notRequired()}),bio_ar:q().when([],{is:()=>n!==Q.AMBULANCE_DRIVER,then:c=>c.required(s.formatMessage({id:"common.validation.required"})),otherwise:c=>c.notRequired()})})},ht=s=>{var n,c;return{hospital_employee_id:s==null?void 0:s.hospital_employee_id,name_en:s==null?void 0:s.name.en,name_ar:s==null?void 0:s.name.ar,gender:s==null?void 0:s.gender,nationality:s==null?void 0:s.nationality,national_id:s==null?void 0:s.national_id,dob:te(s==null?void 0:s.dob),photo:s==null?void 0:s.photo,country:s==null?void 0:s.country,city:s==null?void 0:s.city,phone_number:Ue(s==null?void 0:s.phone_number),email:s==null?void 0:s.email,bio_en:(n=s==null?void 0:s.bio)==null?void 0:n.en,bio_ar:(c=s==null?void 0:s.bio)==null?void 0:c.ar}},mt=te(new Date);function ut({open:s,handleClose:n}){const c=ds(),r=G(),t=Y(a=>a.app.employee),[E,P]=M.useState(void 0),{lang:k}=he(),_=$s(),x=Us(),{id:l}=Z(),[A,O]=M.useState(`${t&&(t!=null&&t.photo)?t.photo:""}`);M.useEffect(()=>{E&&(O(URL.createObjectURL(E)),cs(E,a=>{y("photo",a)}))},[E]);const D=M.useMemo(()=>ht(t),[t]),B=me({initialValues:D,validationSchema:ct(r,t==null?void 0:t.employee_type),enableReinitialize:!0,onSubmit:async(a,{setSubmitting:v})=>{try{let h={...a,...(a==null?void 0:a.dob)&&{dob:new Date(a.dob.toDate()).toISOString()},phone_number:hs(a.phone_number),name:{en:a==null?void 0:a.name_en,ar:a==null?void 0:a.name_ar},bio:{en:a==null?void 0:a.bio_en,ar:a==null?void 0:a.bio_ar}};h.photo.includes("http")&&delete h.photo,delete h.name_en,delete h.name_ar,delete h.bio_en,delete h.bio_ar,await ie(t==null?void 0:t.id,l,h).then(F=>{z(r.formatMessage({id:"medicalCenter.employeesTab.personalinfoUpdateSuccess"})),v(!1),n()})}catch(h){v(!1),console.error(h)}}}),{errors:i,touched:p,handleSubmit:j,values:m,isSubmitting:b,handleBlur:o,getFieldProps:f,setFieldValue:y}=B;return e.jsx(e.Fragment,{children:s&&e.jsx(We,{open:s,handleClose:n,children:e.jsx(ue,{value:B,children:e.jsx(je,{dateAdapter:He,children:e.jsxs(xe,{autoComplete:"off",noValidate:!0,onSubmit:j,children:[e.jsx(ze,{children:r.formatMessage({id:"common.updateInformation"})}),e.jsx(le,{}),e.jsx(Ge,{sx:{p:2.5},children:e.jsxs(d,{container:!0,spacing:3,children:[e.jsxs(d,{item:!0,xs:12,md:3,children:[e.jsxs(g,{direction:"row",justifyContent:"center",sx:{mt:3},children:[e.jsxs(Ke,{htmlFor:"change-avtar",sx:{position:"relative",borderRadius:"50%",overflow:"hidden","&:hover .MuiBox-root":{opacity:1},cursor:"pointer"},children:[e.jsx(Te,{alt:"Avatar 1",src:A,sx:{width:72,height:72,border:"1px dashed"}}),e.jsx(C,{sx:{position:"absolute",top:0,left:0,background:c.palette.mode===ms.DARK?"rgba(255, 255, 255, .75)":"rgba(0,0,0,.65)",width:"100%",height:"100%",opacity:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(g,{spacing:.5,alignItems:"center",children:[e.jsx(Ls,{style:{color:c.palette.secondary.lighter,fontSize:"2rem"}}),e.jsx(w,{sx:{color:"secondary.lighter"},children:r.formatMessage({id:"common.upload"})})]})})]}),e.jsx(L,{type:"file",id:"change-avtar",placeholder:"Outlined",variant:"outlined",inputProps:{accept:"image/*"},sx:{display:"none"},onChange:a=>{var v;return P((v=a.target.files)==null?void 0:v[0])}})]}),e.jsx(g,{direction:"row",justifyContent:"center",children:p.photo&&i.photo&&e.jsx(R,{error:!0,id:"helper-image",children:i==null?void 0:i.photo})})]}),e.jsx(d,{item:!0,xs:12,md:8,children:e.jsxs(d,{container:!0,spacing:3,children:[e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"name_en",children:r.formatMessage({id:"profile.nameEn"})}),e.jsx(L,{fullWidth:!0,id:"name_en",placeholder:r.formatMessage({id:"profile.nameEn"}),...f("name_en"),error:!!(p.name_en&&i.name_en)})]}),p.name_en&&i.name_en&&e.jsx(R,{error:!0,id:"helper-name_en",children:i==null?void 0:i.name_en})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"name_ar",children:r.formatMessage({id:"profile.nameAr"})}),e.jsx(L,{fullWidth:!0,id:"name_ar",placeholder:r.formatMessage({id:"profile.nameAr"}),...f("name_ar"),error:!!(p.name_ar&&i.name_ar)})]}),p.name_ar&&i.name_ar&&e.jsx(R,{error:!0,id:"helper-name_ar",children:i==null?void 0:i.name_ar})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"hospital_employee_id",children:r.formatMessage({id:"medicalCenter.employeesTab.employeeId"})}),e.jsx(L,{fullWidth:!0,type:"number",id:"hospital_employee_id",placeholder:r.formatMessage({id:"medicalCenter.employeesTab.employeeId"}),...f("hospital_employee_id"),error:!!(p.hospital_employee_id&&i.hospital_employee_id)})]}),p.hospital_employee_id&&i.hospital_employee_id&&e.jsx(R,{error:!0,id:"helper-hospital_employee_id",children:i==null?void 0:i.hospital_employee_id})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"email",children:r.formatMessage({id:"profile.email"})}),e.jsx(L,{fullWidth:!0,id:"email",placeholder:r.formatMessage({id:"profile.email"}),...f("email"),error:!!(p.email&&i.email)})]}),p.email&&i.email&&e.jsx(R,{error:!0,id:"helper-email",children:i==null?void 0:i.email})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"phone_number",children:r.formatMessage({id:"profile.phoneNo"})}),e.jsx(qs,{id:"phone_number",name:"phone_number",format:"+### ## ### ####",mask:"_",placeholder:"+966 5",value:m.phone_number,onValueChange:a=>B.setFieldValue("phone_number",a.formattedValue),onBlur:B.handleBlur,customInput:L})]}),p.phone_number&&i.phone_number&&e.jsx(R,{error:!0,id:"helper-phone_number",children:i==null?void 0:i.phone_number})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"nationality",children:r.formatMessage({id:"profile.nationality"})}),e.jsx(re,{fullWidth:!0,children:e.jsx(Le,{id:"nationality",fullWidth:!0,value:x==null?void 0:x.content.filter(a=>a.code===(m==null?void 0:m.nationality))[0],onChange:(a,v)=>{y("nationality",v===null?"":v==null?void 0:v.code)},options:x==null?void 0:x.content,autoHighlight:!0,isOptionEqualToValue:(a,v)=>a.code===(v==null?void 0:v.code),getOptionLabel:a=>a.label[k],renderOption:({key:a,...v},h)=>e.jsxs(C,{component:"li",sx:{"& > img":{mr:2,flexShrink:0}},...v,children:[h.code&&e.jsx("img",{loading:"lazy",width:"20",src:`https://flagcdn.com/w20/${h.code.toLowerCase()}.png`,srcSet:`https://flagcdn.com/w40/${h.code.toLowerCase()}.png 2x`,alt:""}),h.label[k],h.code&&`(${h.code}) ${h.phone}`]},a),renderInput:a=>e.jsx(L,{...a,placeholder:r.formatMessage({id:"profile.nationality"}),...f("nationality"),error:!!(p.nationality&&i.nationality),inputProps:{...a.inputProps}})})})]}),p.nationality&&i.nationality&&e.jsx(R,{error:!0,id:"helper-nationality",children:i==null?void 0:i.nationality})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"national_id",children:r.formatMessage({id:"profile.nationalIdIqamaNumber"})}),e.jsx(L,{fullWidth:!0,id:"national_id",placeholder:r.formatMessage({id:"profile.nationalIdIqamaNumber"}),...f("national_id"),error:!!(p.national_id&&i.national_id)})]}),p.national_id&&i.national_id&&e.jsx(R,{error:!0,id:"helper-national_id",children:i==null?void 0:i.national_id})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"country",children:r.formatMessage({id:"profile.country"})}),e.jsx(re,{fullWidth:!0,children:e.jsx(Le,{id:"country",fullWidth:!0,value:x==null?void 0:x.content.filter(a=>a.code===(m==null?void 0:m.country))[0],onBlur:o,onChange:(a,v)=>{y("country",v===null?"":v.code)},options:x==null?void 0:x.content,autoHighlight:!0,isOptionEqualToValue:(a,v)=>a.code===(v==null?void 0:v.code),getOptionLabel:a=>a.label[k],renderOption:({key:a,...v},h)=>e.jsxs(C,{component:"li",sx:{"& > img":{mr:2,flexShrink:0}},...v,children:[h.code&&e.jsx("img",{loading:"lazy",width:"20",src:`https://flagcdn.com/w20/${h.code.toLowerCase()}.png`,srcSet:`https://flagcdn.com/w40/${h.code.toLowerCase()}.png 2x`,alt:""}),h.label[k],h.code&&`(${h.code}) ${h.phone}`]},a),renderInput:a=>e.jsx(L,{...a,placeholder:r.formatMessage({id:"profile.country"}),...f("country"),inputProps:{...a.inputProps}})})})]}),p.country&&i.country&&e.jsx(R,{error:!0,id:"helper-country",children:i==null?void 0:i.country})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"city",children:r.formatMessage({id:"profile.city"})}),e.jsx(L,{fullWidth:!0,id:"city",placeholder:r.formatMessage({id:"profile.city"}),...f("city"),error:!!(p.city&&i.city)})]}),p.city&&i.city&&e.jsx(R,{error:!0,id:"helper-city",children:i==null?void 0:i.city})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"dob",children:r.formatMessage({id:"profile.dob"})}),e.jsx(je,{dateAdapter:Ze,children:e.jsx(es,{format:Ye,value:m==null?void 0:m.dob,maxDate:mt,onChange:a=>y("dob",a),name:"dob"})})]}),p.dob&&i.dob&&e.jsx(R,{error:!0,id:"helper-dob",children:i==null?void 0:i.dob})]}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"gender",children:r.formatMessage({id:"profile.gender"})}),e.jsx(re,{fullWidth:!0,children:e.jsx(ae,{id:"gender",displayEmpty:!0,value:m.gender,onChange:a=>y("gender",a.target.value),children:_==null?void 0:_.content.map(a=>e.jsx(X,{value:a.value,children:a.label[k]},a.value))})})]})}),(t==null?void 0:t.employee_type)!==Q.AMBULANCE_DRIVER&&e.jsxs(e.Fragment,{children:[e.jsxs(d,{item:!0,xs:12,sm:12,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"bio_en",children:r.formatMessage({id:"profile.bioDescEn"})}),e.jsx(L,{fullWidth:!0,id:"bio_en",multiline:!0,placeholder:r.formatMessage({id:"profile.bioDescEn"}),...f("bio_en"),error:!!(p.bio_en&&i.bio_en)})]}),p.bio_en&&i.bio_en&&e.jsx(R,{error:!0,id:"helper-bio_en",children:i==null?void 0:i.bio_en})]}),e.jsxs(d,{item:!0,xs:12,sm:12,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"bio_ar",children:r.formatMessage({id:"profile.bioDescAr"})}),e.jsx(L,{fullWidth:!0,id:"bio_ar",multiline:!0,dir:"rtl",placeholder:r.formatMessage({id:"profile.bioDescAr"}),...f("bio_ar"),error:!!(p.bio_ar&&i.bio_ar)})]}),p.bio_ar&&i.bio_ar&&e.jsx(R,{error:!0,id:"helper-bio_ar",children:i==null?void 0:i.bio_ar})]})]})]})})]})}),e.jsx(le,{}),e.jsx(Je,{sx:{p:2.5},children:e.jsx(d,{container:!0,justifyContent:"right",alignItems:"center",children:e.jsx(d,{item:!0,children:e.jsxs(g,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(N,{color:"error",onClick:n,children:r.formatMessage({id:"common.cancel"})}),e.jsx(be,{type:"submit",loading:b,loadingIndicator:r.formatMessage({id:"common.processing"}),variant:"contained",children:r.formatMessage({id:"common.updateInformation"})})]})})})})]})})})})})}function xt(){var E;Z();const{lang:s}=he();us();const[n,c]=M.useState(!1),r=G(),t=Y(P=>P.app.employee);return e.jsxs(U,{children:[e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,children:e.jsxs(g,{spacing:2.5,alignItems:"center",children:[e.jsx(Ke,{htmlFor:"change-avtar",sx:{position:"relative",borderRadius:"50%",overflow:"hidden","&:hover .MuiBox-root":{opacity:1},cursor:"pointer"},children:e.jsx(Te,{alt:"Avatar 1",src:t==null?void 0:t.photo,sx:{width:124,height:124,border:"1px dashed"}})}),e.jsxs(g,{spacing:.5,alignItems:"center",children:[e.jsx(w,{variant:"h5",children:t==null?void 0:t.name[s]}),e.jsx(w,{color:"secondary",children:(E=t==null?void 0:t.speciality)==null?void 0:E.speciality_name[s]})]})]})}),e.jsx(d,{item:!0,sm:3,sx:{display:{sm:"block",md:"none"}}}),e.jsx(d,{item:!0,xs:12,children:e.jsx(dt,{})}),e.jsx(d,{item:!0,xs:12,display:"flex",sx:{mt:1},justifyContent:"center",children:e.jsx(N,{onClick:()=>c(!0),variant:"outlined",startIcon:e.jsx(ke,{}),children:r.formatMessage({id:"profile.editInformation"})})})]}),n&&e.jsx(ut,{open:n,handleClose:()=>c(!1)})]})}const gt=s=>{var n;return{health_reg_no:s==null?void 0:s.health_reg_no,expire_date:te(s==null?void 0:s.expire_date),sub_service_id:(n=s==null?void 0:s.sub_services)==null?void 0:n.id,seniority_level:(s==null?void 0:s.seniority_level)||"",consultation_languages:s?s==null?void 0:s.consultation_languages:[],experience:s==null?void 0:s.experience,linkedin_url:s==null?void 0:s.linkedin_url,government_employee:s==null?void 0:s.government_employee,linked_type:(s==null?void 0:s.linked_type)||[]}};function pt(){var Fe,Ie,Ee,Ae;const s=xs(u=>u.breakpoints.down("md")),{lang:n}=he(),[c,r]=M.useState(!1),t=Y(u=>u.app.employee),[E,P]=M.useState(),[k,_]=M.useState(),[x,l]=M.useState(null),[A,O]=M.useState([]),{data:D,setPagination:B,setFilterCriteria:i}=Xs("DOCTOR_VISIT"),{id:p}=Z(),j=zs(),m=Gs(),b=Y(u=>u.app.loading),o=G(),f=M.useMemo(()=>gt(t),[t]),y=me({initialValues:f,validationSchema:Vs(o),enableReinitialize:!0,onSubmit:async(u,{setSubmitting:T})=>{try{const J={...u};u!=null&&u.expire_date&&u.expire_date.isValid()&&(J.expire_date=new Date(u.expire_date.toDate()).toISOString()),await ie(t==null?void 0:t.id,p,J).then(ve=>{T(!1),z(o.formatMessage({id:"medicalCenter.employeesTab.profInfoUpdateSuccess"}))})}catch(J){T(!1),console.error(J)}}}),a=(u,T)=>{r(!0),P(u),_(T)},v=()=>{r(!0),P(void 0),_(void 0)},h=()=>{const u=(t==null?void 0:t.education.filter((T,J)=>J!==x))??[];ie(t==null?void 0:t.id,p,{education:[...u]}).then(T=>{z(o.formatMessage({id:"profile.education.deleteSuccess"})),l(null)})},F=async u=>{try{const T={...u};if(T!=null&&T.fromDate&&T.fromDate.isValid()&&(T.fromDate=new Date(T.fromDate.toDate()).toISOString()),T!=null&&T.toDate&&T.toDate.isValid()&&(T.toDate=new Date(T.toDate.toDate()).toISOString()),k){const J=(t==null?void 0:t.education.filter((ve,os)=>os!==E))??[];await ie(t==null?void 0:t.id,p,{education:[T,...J]}).then(ve=>{z(o.formatMessage({id:"profile.education.updateSuccess"})),r(!1)})}else{const J=(t==null?void 0:t.education)??[];await ie(t==null?void 0:t.id,p,{education:[T,...J]}).then(ve=>{z(o.formatMessage({id:"profile.education.addSuccess"})),r(!1)})}}catch(T){console.error(T)}},W=u=>{Qs(u,{isLoading:b,responseMeta:D.meta,setPagination:B})};M.useEffect(()=>{var u;(u=D==null?void 0:D.data)!=null&&u.length&&gs(D,A,O)},[D]);const{touched:V,isSubmitting:is,handleSubmit:rs,handleBlur:de,handleChange:Me,values:$,setFieldValue:ce,errors:S}=y,as=e.jsx(C,{sx:{height:"calc(100vh - 310px)"},children:e.jsx(ss,{})});return b?as:e.jsxs(e.Fragment,{children:[e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,children:(t==null?void 0:t.employee_type)!==Q.AMBULANCE_DRIVER&&e.jsxs(U,{title:o.formatMessage({id:"profile.educationTitle"}),children:[(t==null?void 0:t.education)&&((Fe=t==null?void 0:t.education)==null?void 0:Fe.length)>0&&e.jsxs($e,{sx:{py:0},children:[(Ie=t==null?void 0:t.education)==null?void 0:Ie.map((u,T)=>e.jsx(K,{divider:!0,secondaryAction:e.jsxs(e.Fragment,{children:[e.jsx(N,{onClick:()=>{a(T,u)},startIcon:e.jsx(ke,{}),children:o.formatMessage({id:"common.edit"})}),e.jsx(N,{onClick:()=>{l(T)},startIcon:e.jsx(ts,{}),children:o.formatMessage({id:"common.delete"})})]}),children:e.jsxs(d,{container:!0,spacing:s?.5:3,children:[e.jsx(d,{item:!0,xs:12,md:6,children:e.jsxs(g,{spacing:.5,children:[e.jsx(w,{color:"black",variant:"h6",children:u.degree}),e.jsxs(w,{color:"secondary",variant:"caption",children:[" ",te(u.fromDate).format(De)+" - "+te(u.toDate).format(De)]})]})}),e.jsx(d,{item:!0,xs:12,md:6,children:e.jsx(g,{spacing:.5,children:e.jsx(w,{color:"black",variant:"h6",children:u.institute})})})]})},T)),((Ee=t==null?void 0:t.education)==null?void 0:Ee.length)>0&&e.jsx(K,{children:e.jsx(N,{onClick:()=>{v()},variant:"text",startIcon:e.jsx(_e,{}),children:o.formatMessage({id:"common.addMore"})})})]}),((Ae=t==null?void 0:t.education)==null?void 0:Ae.length)==0&&e.jsx(oe,{message:o.formatMessage({id:"profile.education.emptyEducationMessage"}),children:e.jsx(N,{onClick:()=>{r(!0)},startIcon:e.jsx(_e,{}),children:o.formatMessage({id:"profile.education.titleAdd"})})})]})}),e.jsx(d,{item:!0,xs:12,sm:12,children:e.jsx(U,{title:o.formatMessage({id:"profile.proInfoTitle"}),children:e.jsx(ue,{value:y,children:e.jsx(xe,{autoComplete:"off",noValidate:!0,onSubmit:rs,children:e.jsxs(d,{container:!0,spacing:3,children:[e.jsxs(d,{item:!0,xs:12,sm:12,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"health_reg_no",children:o.formatMessage({id:"profile.saudiCommRegNo"})}),e.jsx(L,{fullWidth:!0,id:"health_reg_no",placeholder:o.formatMessage({id:"profile.saudiCommRegNo"}),value:$.health_reg_no,name:"health_reg_no",onBlur:de,onChange:Me,error:!!(V.health_reg_no&&S.health_reg_no)})]}),V.health_reg_no&&S.health_reg_no&&e.jsx(R,{error:!0,id:"helper-text-health_reg_no",children:S.health_reg_no})]}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"expire_date",children:o.formatMessage({id:"profile.expireDate"})}),e.jsx(je,{dateAdapter:Ze,children:e.jsx(es,{format:Ye,value:$==null?void 0:$.expire_date,onChange:u=>ce("expire_date",u),name:"expire_date"})})]})}),(t==null?void 0:t.employee_type)===Q.DOCTOR&&e.jsxs(e.Fragment,{children:[e.jsxs(d,{item:!0,xs:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"sub_service_id",children:o.formatMessage({id:"common.specialty"})}),e.jsx(re,{fullWidth:!0,error:!!(V.sub_service_id&&S.sub_service_id),children:e.jsx(Js,{label:o.formatMessage({id:"common.selectOp"}),fieldId:"sub_service_id",options:A,isLoading:b,fieldName:"name",onSearch:u=>i({...(u==null?void 0:u.length)>0&&{search:u}}),onScroll:W})})]}),V.sub_service_id&&S.sub_service_id&&e.jsx(R,{error:!0,id:"helper-sub_service_id",children:S==null?void 0:S.sub_service_id})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"seniority_level",children:o.formatMessage({id:"profile.seniorityLevel"})}),e.jsx(re,{fullWidth:!0,error:!!(V.seniority_level&&S.seniority_level),children:e.jsxs(ae,{id:"seniority_level",displayEmpty:!0,value:$.seniority_level,onChange:u=>ce("seniority_level",u.target.value),children:[e.jsx(X,{value:"",disabled:!0,children:e.jsx(w,{color:"secondary",children:o.formatMessage({id:"common.selectOp"})})}),j==null?void 0:j.content.map(u=>e.jsx(X,{value:u.value,children:u.label[n]},u.value))]})})]}),V.seniority_level&&S.seniority_level&&e.jsx(R,{error:!0,id:"helper-seniority_level",children:S==null?void 0:S.seniority_level})]})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsxs(I,{htmlFor:"experience",children:[o.formatMessage({id:"profile.yearsOfExperience"})," "]}),e.jsx(L,{fullWidth:!0,id:"experience",placeholder:o.formatMessage({id:"profile.yearsOfExperience"}),value:$.experience,name:"experience",type:"number",onBlur:de,onChange:Me,error:!!(V.experience&&S.experience)})]}),V.experience&&S.experience&&e.jsx(R,{error:!0,id:"helper-text-experience",children:S.experience})]}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsxs(g,{spacing:1,children:[e.jsx(I,{id:"consultation_languages",children:o.formatMessage({id:"profile.consultLang"})}),e.jsx(ae,{multiple:!0,value:$.consultation_languages,onBlur:de,name:"consultation_languages",onChange:u=>ce("consultation_languages",u.target.value),renderValue:u=>u.join(", "),error:!!(V.consultation_languages&&S.consultation_languages),children:m==null?void 0:m.content.map(u=>{var T;return e.jsxs(X,{value:u.value,children:[e.jsx(Zs,{checked:((T=$==null?void 0:$.consultation_languages)==null?void 0:T.indexOf(u.value))>-1}),e.jsx(ps,{primary:u.label[n]})]},u.value)})}),V.consultation_languages&&S.consultation_languages&&e.jsx(R,{error:!0,id:"helper-text-consultation_languagesxperience",children:S.consultation_languages})]})}),e.jsx(d,{item:!0,xs:6,children:e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"government_employee",children:o.formatMessage({id:"profile.workSector"})}),e.jsx(ae,{fullWidth:!0,id:"government_employee",value:String($.government_employee),onBlur:de,name:"government_employee",onChange:u=>ce("government_employee",u.target.value),error:!!(V.government_employee&&S.government_employee),children:Ks.map(u=>e.jsx(X,{value:u.id,children:u[n]},u.id))}),V.government_employee&&S.government_employee&&e.jsx(R,{error:!0,id:"helper-text-government_employee",children:S.government_employee})]})}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"linkedin_url",children:o.formatMessage({id:"profile.profileLinkedin"})}),e.jsx(L,{fullWidth:!0,id:"linkedin_url",placeholder:o.formatMessage({id:"profile.profileLinkedin"}),value:$.linkedin_url,name:"linkedin_url",onBlur:de,onChange:Me,error:!!(V.linkedin_url&&S.linkedin_url)})]}),V.linkedin_url&&S.linkedin_url&&e.jsx(R,{error:!0,id:"helper-text-linkedin_url",children:S.linkedin_url})]}),(t==null?void 0:t.employee_type)===Q.NURSE&&e.jsx(e.Fragment,{children:e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"linked_type",children:o.formatMessage({id:"profile.linkedEmployeeType"})}),e.jsx(re,{fullWidth:!0,error:!!(V.linked_type&&S.linked_type),children:e.jsxs(ae,{id:"linked_type",multiple:!0,displayEmpty:!0,value:$.linked_type||[],onChange:u=>ce("linked_type",u.target.value),children:[e.jsx(X,{value:"",disabled:!0,children:e.jsx(w,{color:"secondary",children:o.formatMessage({id:"common.selectOp"})})}),e.jsx(X,{value:"INTRAVENOUS_VITAMINS",children:"Intravenous vitamins"}),e.jsx(X,{value:"VACCINATION",children:"Vaccination"})]})})]}),V.linked_type&&S.linked_type&&e.jsx(R,{error:!0,id:"helper-linked-type",children:S==null?void 0:S.linked_type})]})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(g,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:e.jsx(be,{type:"submit",loading:is,loadingIndicator:o.formatMessage({id:"common.processing"}),variant:"contained",children:o.formatMessage({id:"common.saveChanges"})})})})]})})})})})]}),c&&e.jsx(Hs,{submit:F,education:k,open:c,handleClose:()=>r(!1)}),e.jsx(Ys,{open:x!=null&&x>=0,handleClose:()=>l(null),handleSubmit:h})]})}function jt(){const[s,n]=M.useState(!1),[c,r]=M.useState(!1),t=Y(F=>F.app.employee),[E,P]=M.useState(String(t==null?void 0:t.status)),{lang:k}=he(),_=G(),{id:x}=Z(),{defaultList:l}=et(Qe.EMPLOYEE_STATUS),A=()=>{n(!s)},O=()=>{r(!c)},D=F=>{F.preventDefault()},B=()=>{ie(t==null?void 0:t.id,x,{status:Number(E)}).then(F=>{z(_.formatMessage({id:"doctor.settingTab.statusSuccess"}))})},i=me({initialValues:{password:"",confirm:""},validationSchema:st(_),enableReinitialize:!0,onSubmit:async(F,{setSubmitting:W})=>{await ks(x,t==null?void 0:t.id,{phone_number:t==null?void 0:t.phone_number,password:F==null?void 0:F.password}).then(V=>{W(!1),z(_.formatMessage({id:"common.changePassword.passwordChangeSuccess"}))})}}),{handleSubmit:p,isSubmitting:j,touched:m,handleBlur:b,errors:o,handleChange:f,resetForm:y,values:a,getFieldProps:v,setFieldValue:h}=i;return e.jsx(ue,{value:i,children:e.jsx(xe,{autoComplete:"off",noValidate:!0,onSubmit:p,children:e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,sm:12,children:e.jsx(U,{title:_.formatMessage({id:"common.changePassword.title"}),children:e.jsxs(d,{container:!0,spacing:2,children:[e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"password",children:_.formatMessage({id:"common.changePassword.newPassword"})}),e.jsx(Ne,{id:"password",placeholder:_.formatMessage({id:"common.changePassword.newPassword"}),type:s?"text":"password",value:a.password,name:"password",onBlur:b,onChange:f,endAdornment:e.jsx(ye,{position:"end",children:e.jsx(fe,{"aria-label":"toggle password visibility",onClick:A,onMouseDown:D,edge:"end",size:"large",color:"secondary",children:s?e.jsx(Se,{}):e.jsx(qe,{})})})})]}),m.password&&o.password&&e.jsx(R,{error:!0,id:"password-helper",children:o.password})]}),e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"password-confirm",children:_.formatMessage({id:"common.changePassword.confirmPassword"})}),e.jsx(Ne,{id:"password-confirm",placeholder:_.formatMessage({id:"common.changePassword.confirmPassword"}),type:c?"text":"password",value:a.confirm,name:"confirm",onBlur:b,onChange:f,endAdornment:e.jsx(ye,{position:"end",children:e.jsx(fe,{"aria-label":"toggle password visibility",onClick:O,onMouseDown:D,edge:"end",size:"large",color:"secondary",children:c?e.jsx(Se,{}):e.jsx(qe,{})})}),autoComplete:"password-confirm"})]}),m.confirm&&o.confirm&&e.jsx(R,{error:!0,id:"password-confirm-helper",children:o.confirm})]}),e.jsx(d,{item:!0,xs:12,children:e.jsx(g,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:e.jsx(be,{type:"submit",loading:j,loadingIndicator:_.formatMessage({id:"common.processing"}),variant:"contained",children:_.formatMessage({id:"common.changePassword.title"})})})})]})})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(U,{title:_.formatMessage({id:"doctor.settingTab.accountStatus"}),children:e.jsx(d,{container:!0,spacing:2,children:e.jsx(d,{item:!0,xs:6,children:e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,sm:12,children:e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"status",children:_.formatMessage({id:"common.status"})}),e.jsx(re,{fullWidth:!0,children:e.jsx(ae,{id:"status",value:E,onChange:F=>{P(F.target.value)},children:l.map(F=>e.jsx(X,{value:F.value,children:F.label[k]},F.value))})})]})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(g,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:e.jsx(N,{onClick:B,variant:"contained",children:_.formatMessage({id:"common.editStatus"})})})})]})})})})})]})})})}function ft({requestMode:s}){const[n,c]=M.useState(!1),[r,t]=M.useState(!1),[E,P]=M.useState(""),[k,_]=M.useState(null),x=G(),l=Y(h=>h.app.employee),{id:A}=Z(),[O,D]=M.useState(""),B=(h,F)=>{D(h),c(!0),P(F),t(!1)},i=(h,F)=>{_(h),P(F),t(!0),c(!0)},p=M.useCallback(async(h,F)=>{try{const W={attachment_type:O,file_name:F,file:h};await Fs(A,l==null?void 0:l.id,W).then(V=>{z(x.formatMessage({id:"profile.attachmentTab.fileUploadSuccess"})),D(""),_(null),c(!1)})}catch(W){console.error(W)}},[l,O,x]),j=M.useCallback(async(h,F)=>{try{const W={file_name:F,file:h};await Is(k,A,l==null?void 0:l.id,W).then(V=>{z(x.formatMessage({id:"profile.attachmentTab.fileReplaceSuccess"})),D(""),_(null),c(!1)})}catch(W){console.error(W)}},[l,k,x]),m=h=>{js(h==null?void 0:h.absolute_url,h.file_name)},b=async h=>{await Es(h,A,l==null?void 0:l.id).then(F=>{z(x.formatMessage({id:"profile.attachmentTab.fileDeleteSuccess"})),D(""),c(!1)})},o=M.useMemo(()=>(l==null?void 0:l.attachments.find(h=>h.attachment_type==="NATIONAL_ID"))??null,[l==null?void 0:l.attachments]),f=M.useMemo(()=>(l==null?void 0:l.attachments.find(h=>h.attachment_type==="CV"))??null,[l==null?void 0:l.attachments]),y=M.useMemo(()=>(l==null?void 0:l.attachments.find(h=>h.attachment_type==="HEALTH_REG_NO"))??null,[l==null?void 0:l.attachments]),a=M.useMemo(()=>(l==null?void 0:l.attachments.filter(h=>h.attachment_type==="OTHERS"))??[],[l==null?void 0:l.attachments]),v=M.useMemo(()=>(l==null?void 0:l.employee_type)===Q.AMBULANCE_DRIVER?x.formatMessage({id:"profile.attachmentTab.title"}):x.formatMessage({id:"profile.attachmentTab.otherCertificate"}),[x,l,a]);return e.jsxs(e.Fragment,{children:[e.jsxs(d,{container:!0,spacing:3,children:[(l==null?void 0:l.employee_type)!==Q.AMBULANCE_DRIVER&&e.jsxs(e.Fragment,{children:[e.jsx(d,{item:!0,xs:12,children:e.jsxs(U,{title:x.formatMessage({id:"profile.nationalIdIqamaNumber"}),children:[o&&e.jsxs(g,{direction:"row",spacing:1,children:[e.jsx(C,{sx:{flexGrow:1},children:e.jsxs(ge,{component:"button",variant:"h6",underline:"always",sx:{wordBreak:"break-word",whiteSpace:"normal",textAlign:"left",display:"block"},children:["  ",o.file_name]})}),e.jsxs(g,{direction:"row",spacing:2,alignItems:"flex-start",children:[e.jsx(N,{variant:"outlined",size:"small",onClick:()=>{m(o)},startIcon:e.jsx(pe,{}),children:x.formatMessage({id:"common.download"})}),!s&&e.jsx(N,{variant:"outlined",size:"small",sx:{minWidth:"120px"},onClick:()=>i(o==null?void 0:o.id,"IMAGES"),startIcon:e.jsx(ne,{}),children:x.formatMessage({id:"profile.attachmentTab.replaceFile"})})]})]}),!o&&e.jsx(oe,{message:x.formatMessage({id:"profile.attachmentTab.emptyDocumentMessage"}),children:!s&&e.jsx(N,{onClick:()=>B("NATIONAL_ID","IMAGES"),startIcon:e.jsx(ne,{}),children:x.formatMessage({id:"common.upload"})})})]})}),e.jsx(d,{item:!0,xs:12,children:e.jsxs(U,{title:x.formatMessage({id:"profile.saudiCommRegNo"}),children:[y&&e.jsxs(g,{direction:"row",spacing:1,children:[e.jsx(C,{sx:{flexGrow:1},children:e.jsxs(ge,{component:"button",variant:"h6",underline:"always",sx:{wordBreak:"break-word",whiteSpace:"normal",textAlign:"left",display:"block"},children:[" ",y.file_name]})}),e.jsxs(g,{direction:"row",spacing:2,alignItems:"flex-start",children:[e.jsx(N,{variant:"outlined",size:"small",onClick:()=>{m(y)},startIcon:e.jsx(pe,{}),children:x.formatMessage({id:"common.download"})}),!s&&e.jsx(N,{variant:"outlined",size:"small",sx:{minWidth:"120px"},onClick:()=>i(y==null?void 0:y.id,"IMAGES"),startIcon:e.jsx(ne,{}),children:x.formatMessage({id:"profile.attachmentTab.replaceFile"})})]})]}),!y&&e.jsx(oe,{message:x.formatMessage({id:"profile.attachmentTab.emptyDocumentMessage"}),children:!s&&e.jsx(N,{onClick:()=>B("HEALTH_REG_NO","IMAGES"),startIcon:e.jsx(ne,{}),children:x.formatMessage({id:"common.upload"})})})]})}),e.jsx(d,{item:!0,xs:12,children:e.jsxs(U,{title:x.formatMessage({id:"profile.attachmentTab.cv"}),children:[f&&e.jsxs(g,{direction:"row",spacing:1,children:[e.jsx(C,{sx:{flexGrow:1},children:e.jsxs(ge,{component:"button",variant:"h6",underline:"always",sx:{wordBreak:"break-word",whiteSpace:"normal",textAlign:"left",display:"block"},children:["   ",f.file_name]})}),e.jsxs(g,{direction:"row",spacing:2,alignItems:"flex-start",children:[e.jsx(N,{variant:"outlined",size:"small",onClick:()=>{m(f)},startIcon:e.jsx(pe,{}),children:x.formatMessage({id:"common.download"})}),!s&&e.jsx(N,{variant:"outlined",size:"small",sx:{minWidth:"120px"},onClick:()=>i(f==null?void 0:f.id,"DOCS"),startIcon:e.jsx(ne,{}),children:x.formatMessage({id:"profile.attachmentTab.replaceFile"})})]})]}),!f&&e.jsx(oe,{message:x.formatMessage({id:"profile.attachmentTab.emptyDocumentMessage"}),children:!s&&e.jsx(N,{onClick:()=>B("CV","DOCS"),startIcon:e.jsx(ne,{}),children:x.formatMessage({id:"common.upload"})})})]})})]}),e.jsx(d,{item:!0,xs:12,children:e.jsxs(U,{title:v,children:[a==null?void 0:a.map(h=>e.jsxs("div",{children:[e.jsxs(g,{direction:"row",sx:{my:1},spacing:1,children:[e.jsx(C,{sx:{flexGrow:1},children:e.jsxs(ge,{component:"button",variant:"h6",underline:"always",sx:{wordBreak:"break-word",whiteSpace:"normal",textAlign:"left",display:"block"},children:[" ",h.file_name]})}),e.jsxs(g,{direction:"row",spacing:2,alignItems:"flex-start",children:[e.jsx(N,{variant:"outlined",size:"small",onClick:()=>{m(h)},startIcon:e.jsx(pe,{}),children:x.formatMessage({id:"common.download"})}),!s&&e.jsx(N,{variant:"outlined",size:"small",onClick:()=>b(h.id),startIcon:e.jsx(ts,{}),children:x.formatMessage({id:"common.delete"})})]})]}),e.jsx(le,{})]},h.id)),(a==null?void 0:a.length)>0&&e.jsx(N,{sx:{mt:2},variant:"text",onClick:()=>B("OTHERS","ALL"),startIcon:e.jsx(_e,{}),children:x.formatMessage({id:"common.addMore"})}),(a==null?void 0:a.length)==0&&e.jsx(oe,{message:x.formatMessage({id:"profile.attachmentTab.emptyCertificateMessage"}),children:!s&&e.jsx(N,{onClick:()=>B("OTHERS","ALL"),startIcon:e.jsx(ne,{}),children:x.formatMessage({id:"common.upload"})})})]})})]}),n&&e.jsx(tt,{fileType:E,open:n,handleUpload:p,isReplace:r,handleReplace:j,handleClose:()=>c(!1)})]})}const _t=s=>({availability:s.map(c=>{const r=bs(c.slots);return{id:c.id,is_working:c.is_working,week_days:c.week_days,slots:r==null?void 0:r.map(t=>({id:t.id,start_time:Pe(t.start_time),end_time:Pe(t.end_time)}))}}).sort((c,r)=>c.week_days-r.week_days)});function bt({open:s,handleClose:n}){const c=G(),r=Y(i=>i.app.employee),{id:t,employeeId:E}=Z(),P=M.useMemo(()=>_t((r==null?void 0:r.availability)??[]),[]),k=me({initialValues:P,validationSchema:nt(),enableReinitialize:!0,onSubmit:async(i,{setSubmitting:p})=>{try{const j=i==null?void 0:i.availability.map(b=>({id:b.id,slots:b.slots.map(o=>({...o,start_time:Re(o.start_time),end_time:Re(o.end_time)}))})),m={employee_id:r==null?void 0:r.id,availability:j};await As(t,E,m).then(b=>{z(c.formatMessage({id:"profile.scheduleTab.scheduleUpdateSuccess"})),p(!1),n()})}catch(j){p(!1),console.error(j)}}}),_=(i,p,j)=>{var y,a,v,h;const m=k.errors.availability,b=k.touched.availability,o=m&&Array.isArray(m)?(a=(y=m[i])==null?void 0:y.slots)==null?void 0:a[p]:void 0,f=b&&Array.isArray(b)?(h=(v=b[i])==null?void 0:v.slots)==null?void 0:h[p]:void 0;if(o&&typeof o!="string"){const F=o[j];return(f?f[j]:!1)&&F?F:void 0}},x=i=>{var m;const p=k.errors.availability,j=p&&Array.isArray(p)?(m=p[i])==null?void 0:m.slots:void 0;if(typeof j=="string")return j},l=async(i,p,j)=>{var o;k.setFieldValue(`availability.${p}.is_working`,j);const m=j?[{start_time:null,end_time:null}]:[];i.replace(p,{...k.values.availability[p],slots:m,is_working:j});const b=(o=k.values.availability[p])==null?void 0:o.id;j?Ds(b,t,r==null?void 0:r.id).then(f=>{console.log("Day enabled")}):(await Ns(b,t,r==null?void 0:r.id).then(f=>{console.log("Day enabled")}),await Rs(b,t).then(f=>{console.log("Slots deleted")}))},{errors:A,handleSubmit:O,values:D,isSubmitting:B}=k;return e.jsx(e.Fragment,{children:s&&e.jsx(We,{open:s,handleClose:n,maxWidth:780,children:e.jsx(ue,{value:k,children:e.jsx(je,{dateAdapter:He,children:e.jsxs(xe,{autoComplete:"off",noValidate:!0,onSubmit:O,children:[e.jsx(ze,{children:c.formatMessage({id:"profile.editScheduleTab.title"})}),e.jsx(C,{padding:"0 0 10px 20px",children:e.jsx(w,{variant:"body1",children:c.formatMessage({id:"profile.editScheduleTab.subTitle"})})}),e.jsx(le,{}),e.jsx(Ge,{sx:{p:2.5},children:e.jsx(Be,{name:"availability",render:i=>{var p;return e.jsx(e.Fragment,{children:(p=D==null?void 0:D.availability)==null?void 0:p.map((j,m)=>e.jsxs(fs,{variant:"outlined",sx:{p:2,marginTop:1},children:[e.jsxs(C,{display:"flex",justifyContent:"space-between",children:[e.jsx(w,{variant:"h5",children:e.jsx(Xe,{dayNumber:j==null?void 0:j.week_days})}),e.jsx(rt,{control:e.jsx(_s,{checked:j.is_working,onChange:b=>{l(i,m,b.target.checked)},sx:{mt:0}}),label:"",labelPlacement:"start"})]}),e.jsx(C,{display:"flex",justifyContent:"center",children:e.jsx(w,{color:"error",variant:"body1",children:x(m)})}),e.jsx(e.Fragment,{children:(j==null?void 0:j.is_working)&&e.jsx(Be,{name:`availability.${m}.slots`,render:b=>{var o;return e.jsxs(e.Fragment,{children:[j.slots.map((f,y)=>e.jsxs(d,{container:!0,spacing:3,marginTop:.1,children:[e.jsx(d,{item:!0,xs:12,sm:5,children:e.jsxs(g,{spacing:1,children:[e.jsx(I,{children:c.formatMessage({id:"profile.editScheduleTab.from"})}),e.jsx(Ve,{ampm:!1,openTo:"hours",views:["hours","minutes"],format:"HH:mm",value:f.start_time,onChange:a=>{k.setFieldValue(`availability.${m}.slots.${y}.start_time`,a)},slots:{textField:L},slotProps:{textField:{fullWidth:!0,error:!!_(m,y,"start_time"),helperText:_(m,y,"start_time")}}})]})}),e.jsx(d,{item:!0,xs:12,sm:5,children:e.jsxs(g,{spacing:1,children:[e.jsx(I,{htmlFor:"name_en",children:c.formatMessage({id:"profile.editScheduleTab.to"})}),e.jsx(Ve,{ampm:!1,openTo:"hours",views:["hours","minutes"],format:"HH:mm",value:f.end_time,onChange:a=>{k.setFieldValue(`availability.${m}.slots.${y}.end_time`,a)},slots:{textField:L},slotProps:{textField:{fullWidth:!0,error:!!_(m,y,"end_time"),helperText:_(m,y,"end_time")}}})]})}),e.jsx(d,{item:!0,xs:12,sm:2,display:"flex",alignItems:"center",position:"relative",justifyContent:"flex-start",children:y>0&&e.jsx(C,{display:"flex",position:"absolute",left:"8px",top:"54px",justifyContent:"center",alignItems:"center",children:e.jsx(fe,{"aria-label":"delete",color:"error",onClick:()=>{b.remove(y)},children:e.jsx(at,{})})})})]},y)),((o=j==null?void 0:j.slots)==null?void 0:o.length)>0&&e.jsx(C,{marginTop:1,children:e.jsx(N,{variant:"text",onClick:()=>{b.push({start_time:null,end_time:null})},startIcon:e.jsx(_e,{}),children:c.formatMessage({id:"common.addMore"})})})]})}})})]},m))})}})}),e.jsx(le,{}),e.jsx(Je,{sx:{p:2.5},children:e.jsx(d,{container:!0,justifyContent:"right",alignItems:"center",children:e.jsx(d,{item:!0,children:e.jsxs(g,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(N,{color:"error",onClick:n,children:c.formatMessage({id:"common.cancel"})}),e.jsx(be,{type:"submit",loading:B,loadingIndicator:c.formatMessage({id:"common.processing"}),variant:"contained",children:c.formatMessage({id:"profile.editScheduleTab.title"})})]})})})})]})})})})})}const Mt=()=>{const s=G(),[n,c]=M.useState(!1),r=Y(m=>m.app.employee),t=Y(m=>m.app.loading);console.log(r);const{id:E}=Z(),P=M.useMemo(()=>({consultation:r==null?void 0:r.time_before_consultation}),[]),k=me({initialValues:P,validationSchema:it(),enableReinitialize:!0,onSubmit:async(m,{setSubmitting:b})=>{try{const o={time_before_consultation:m==null?void 0:m.consultation};await ie(r==null?void 0:r.id,E,o).then(f=>{z(s.formatMessage({id:"profile.scheduleTab.timeUpdateSucccess"}))})}catch(o){b(!1),console.error(o)}}}),_=M.useMemo(()=>{var b;return(((b=r==null?void 0:r.availability)==null?void 0:b.filter(o=>{var f;return((f=o.time_slots)==null?void 0:f.length)>0}).sort((o,f)=>o.week_days-f.week_days))??[]).map(o=>({...o,time_slots:Ms(o.time_slots)}))},[r]),x=M.useMemo(()=>(_==null?void 0:_.length)>0,[_]),{errors:l,handleSubmit:A,handleBlur:O,handleChange:D,setFieldValue:B,values:i,touched:p}=k,j=e.jsx(C,{sx:{height:"calc(100vh - 310px)"},children:e.jsx(ss,{})});return t?j:e.jsxs(e.Fragment,{children:[e.jsxs(U,{content:!0,children:[e.jsxs(C,{display:"flex",justifyContent:"space-between",children:[e.jsx(w,{variant:"h4",children:s.formatMessage({id:"profile.scheduleTab.availableTime"})}),e.jsx(g,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(N,{variant:"outlined",onClick:()=>c(!0),startIcon:e.jsx(ke,{}),children:s.formatMessage({id:"profile.editScheduleTab.title"})})})]}),x&&e.jsx(C,{mt:2,children:_.map(m=>{var b;return e.jsxs(C,{children:[e.jsx(Xe,{dayNumber:m.week_days}),e.jsx(d,{container:!0,spacing:1,sx:{my:2},children:(b=m==null?void 0:m.time_slots)==null?void 0:b.map(o=>e.jsx(d,{item:!0,sm:2,children:e.jsx(vs,{color:"default",sx:{borderRadius:"15px",textDecoration:o.is_booked?"line-through":"none"},label:`${o.slot_start_time}- ${o.slot_end_time}`,size:"small",variant:"outlined"})},o.id))})]},m.id)})}),!x&&e.jsx(C,{mt:4,children:e.jsx(oe,{message:s.formatMessage({id:"medicalCenter.scheduleTab.message"})})})]}),e.jsx("br",{}),e.jsx(U,{content:!0,children:e.jsx(ue,{value:k,children:e.jsxs(xe,{autoComplete:"off",noValidate:!0,onSubmit:A,children:[e.jsx(w,{variant:"h4",children:s.formatMessage({id:"profile.scheduleTab.timeBeforeConsult"})}),e.jsx(d,{container:!0,children:e.jsxs(d,{item:!0,xs:12,sm:6,children:[e.jsxs(g,{spacing:1,marginTop:"20px",children:[e.jsx(I,{htmlFor:"password",children:s.formatMessage({id:"profile.scheduleTab.timeBeforeConsult"})}),e.jsx(L,{variant:"outlined",type:"number",id:"consultation",name:"consultation",onBlur:O,onChange:D,value:i.consultation,InputProps:{endAdornment:e.jsx(ye,{position:"end",children:e.jsx(w,{variant:"body2",sx:{color:"gray"},children:"Min"})})}})]}),p.consultation&&l.consultation&&e.jsx(R,{error:!0,id:"password-helper",children:l.consultation})]})}),e.jsx("br",{}),e.jsx(N,{variant:"contained",type:"submit",children:s.formatMessage({id:"common.saveChanges"})})]})})}),n&&e.jsx(bt,{open:n,handleClose:()=>{c(!1)}})]})},vt=Mt;function wt(){const s=G(),[n,c]=M.useState(1),r=(t,E)=>{c(E)};return e.jsxs(e.Fragment,{children:[e.jsx(C,{sx:{borderBottom:1,borderColor:"divider",width:"100%"},children:e.jsxs(ns,{value:n,onChange:r,variant:"scrollable",scrollButtons:"auto","aria-label":"account profile tab",children:[e.jsx(se,{label:s.formatMessage({id:"common.upcoming"}),value:1}),e.jsx(se,{label:s.formatMessage({id:"common.completed"}),value:2}),e.jsx(se,{label:s.formatMessage({id:"common.cancelled"}),value:3})]})}),e.jsxs(C,{sx:{mt:2.5},children:[e.jsx(ee,{value:n,index:1,children:e.jsx(we,{status:5})}),e.jsx(ee,{value:n,index:2,children:e.jsx(we,{status:4})}),e.jsx(ee,{value:n,index:3,children:e.jsx(we,{status:0})})]})]})}const we=({status:s})=>{const n=G(),{lang:c}=he(),{id:r,employeeId:t}=Z(),{data:E,isLoading:P,setPagination:k,setSorting:_}=Bs(Number(r),Number(t),s),x=M.useMemo(()=>[{header:n.formatMessage({id:"common.patient"}),accessorKey:"patient",enableSorting:!1,cell:({row:l})=>{var A,O,D,B;return e.jsxs(g,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(Te,{alt:"Avatar 1",size:"sm",src:(O=(A=l.original)==null?void 0:A.patient)==null?void 0:O.photo}),e.jsx(g,{spacing:0,children:e.jsx(H,{className:"typography-inline",value:(B=(D=l.original)==null?void 0:D.patient)==null?void 0:B.name,renderFunction:i=>i[c]})})]})}},{header:n.formatMessage({id:"common.status"}),accessorKey:"status",cell:l=>e.jsx(ws,{status:l.getValue(),referenceKey:Qe.VISIT_STATUS})},{header:n.formatMessage({id:"common.totalPrice"}),accessorKey:"totalPrice",cell:({row:l})=>{var A;return`${(A=l.original)==null?void 0:A.total_price} ${Cs}`}},{header:n.formatMessage({id:"common.day"}),accessorKey:"day",cell:({row:l})=>{var A;return e.jsx(H,{className:"typography-inline",value:(A=l.original)==null?void 0:A.day,renderFunction:O=>te(O).format(Ce)})}},{header:n.formatMessage({id:"common.time"}),accessorKey:"time",cell:({row:l})=>{var A;return e.jsx(H,{className:"typography-inline",value:(A=l.original)==null?void 0:A.time,renderFunction:O=>O})}},{header:n.formatMessage({id:"common.actions"}),accessorKey:"Actions",meta:{className:"cell-center"},enableSorting:!1,cell:({row:l})=>e.jsx(fe,{onClick:()=>{},children:e.jsx(Se,{})})}],[s]);return e.jsx(ys,{data:E,columns:x,isLoading:P,setPagination:l=>{k(l)},setSortingParams:l=>{_(l)},children:e.jsx(U,{content:!1,children:e.jsxs(g,{direction:"row",sx:{px:2,py:2},spacing:2,justifyContent:"space-between",alignItems:"center",children:[e.jsx(w,{variant:"h3",children:n.formatMessage({id:"common.visits"})}),e.jsx(N,{variant:"outlined",startIcon:e.jsx(ot,{}),children:n.formatMessage({id:"common.export"})})]})})})};function Ct(){const[s,n]=M.useState(1),c=G(),r=Y(E=>E.app.employee),t=(E,P)=>{n(P)};return e.jsx(e.Fragment,{children:e.jsxs(U,{border:!1,boxShadow:!0,children:[e.jsx(C,{sx:{borderBottom:1,borderColor:"divider",width:"100%"},children:e.jsxs(ns,{value:s,onChange:t,variant:"scrollable",scrollButtons:"auto","aria-label":"account profile tab",children:[(r==null?void 0:r.employee_type)!==Q.AMBULANCE_DRIVER&&e.jsx(se,{label:c.formatMessage({id:"doctor.aboutTab.title"}),value:1}),e.jsx(se,{label:c.formatMessage({id:"doctor.settingTab.title"}),value:2}),e.jsx(se,{label:c.formatMessage({id:"profile.attachmentTab.title"}),value:3}),e.jsx(se,{label:c.formatMessage({id:"profile.scheduleTab.title"}),value:4}),e.jsx(se,{label:c.formatMessage({id:"common.visits"}),value:5})]})}),e.jsxs(C,{sx:{mt:2.5},children:[e.jsx(ee,{value:s,index:1,children:e.jsx(pt,{})}),e.jsx(ee,{value:s,index:2,children:e.jsx(jt,{})}),e.jsx(ee,{value:s,index:3,children:e.jsx(ft,{})}),e.jsx(ee,{value:s,index:4,children:e.jsx(vt,{})}),e.jsx(ee,{value:s,index:5,children:e.jsx(wt,{})})]})]})})}function yt(s,n,c){return[{title:s.formatMessage({id:"sidebar.home"}),to:Ts},{title:s.formatMessage({id:"sidebar.medicalCenters"}),to:"/medical-center/list"},{title:n,to:`/medical-center/${n}`},{title:s.formatMessage({id:"medicalCenter.employeesTab.title"}),to:`/medical-center/${n}`},{title:s.formatMessage({id:"common.detail"})}]}function un(){const s=G(),{id:n,employeeId:c}=Z();return Ps(Number(n),Number(c)),e.jsxs(e.Fragment,{children:[e.jsx(Ss,{custom:!0,links:yt(s,n)}),e.jsxs(d,{container:!0,spacing:1,children:[e.jsx(d,{item:!0,xs:3,md:3,children:e.jsx(xt,{})}),e.jsx(d,{item:!0,xs:9,md:9,children:e.jsx(Ct,{})})]})]})}export{un as default};
