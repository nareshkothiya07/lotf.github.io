import{a as J,u as Q,t as $,r as c,g as ne,b as oe,bK as X,c as D,j as e,C as ce,F as le,L as de,A as me,d as ue,D as he,e as Y,f as ge,G as u,S as l,h as pe,i as Z,B as ee,k as xe,T as v,l as A,m as _,I,aK as je,b0 as fe,H as F,p as _e,q as G,s as ve,x as se,v as ye,w as L,R as Se,y as Me,z as Ce,M as be,E as Ae,J as Ie,K as Fe,aL as Te,U as Be}from"./index-DSO9TgYq.js";import{d as Ee}from"./dayjs.min-pRfd56nx.js";import{D as Pe}from"./DebouncedInput-DhmfX_1V.js";import{f as we}from"./services-DCcxZZqT.js";import{u as z,a as De,b as ke,d as Re}from"./sub-services-Cm3yL5Hw.js";import{u as Oe}from"./useFilterAndSearch-PJD0Zg8P.js";import{C as Ke}from"./CameraOutlined-D4Mj0cXe.js";import{u as Le}from"./useStatusList-Dbp-x5Xm.js";import{d as Ne}from"./services-BGkrpTaC.js";import{D as Ve,A as Ue}from"./ActivateServiceConfirmation-DBGR9riN.js";import{D as We}from"./DeleteConfirmation-BqFOMagf.js";import{C as q}from"./CustomTypography-CRnDvUFn.js";import{P as Ge}from"./PlusOutlined-BQvVSxI0.js";import{A as ze}from"./ArrowUpOutlined-C9GTlrEN.js";import"./CloseOutlined-DRBnXhIJ.js";import"./ConfirmationDialog-DR_Ho8RD.js";import"./Dialog-CPoUMqzk.js";const He=i=>{var y,f;const d={name_en:"",name_ar:"",min_visit_price:"",min_service_price:"",discount:"",status:1,image:""};return i?{name_en:(y=i==null?void 0:i.name)==null?void 0:y.en,name_ar:(f=i==null?void 0:i.name)==null?void 0:f.ar,min_visit_price:Number(i==null?void 0:i.min_visit_price),min_service_price:Number(i==null?void 0:i.min_service_price),discount:Number(i==null?void 0:i.discount),status:i==null?void 0:i.status,image:i==null?void 0:i.image}:d};function Ye({serviceId:i,subService:d,url:y,open:f,handleClose:S}){const k=J(),a=Q(),{defaultList:h}=Le(se.PACKAGE_STATUS),{lang:r}=$(),[M,R]=c.useState(void 0),[T,N]=c.useState(`${d&&(d!=null&&d.image)?d.image:""}`);c.useEffect(()=>{M&&(N(URL.createObjectURL(M)),ne(M,n=>{O("image",n)}))},[M]);const V=c.useMemo(()=>He(d),[]),B=oe({initialValues:V,validationSchema:Ne(a),enableReinitialize:!0,onSubmit:async(n,{setSubmitting:j})=>{try{let m={...n,service_type:X.RADIOLOGY,service_id:i,name:{en:n==null?void 0:n.name_en,ar:n==null?void 0:n.name_ar}};(m.discount===""||m.discount===null||m.discount===void 0)&&(m.discount=0),m.image.includes("http")&&delete m.image,delete m.name_en,delete m.name_ar,d?await z(d.id,m,y).then(W=>{D(a.formatMessage({id:"services.radiology.editSuccess"})),j(!1),S()}):await De(m,y).then(W=>{D(a.formatMessage({id:"services.radiology.addSuccess"})),j(!1),S()})}catch(m){console.error(m),j(!1)}}}),{errors:s,touched:o,handleSubmit:E,isSubmitting:C,getFieldProps:g,values:b,setFieldTouched:U,setFieldValue:O}=B;return e.jsx(e.Fragment,{children:f&&e.jsx(ce,{open:f,handleClose:S,children:e.jsx(le,{value:B,children:e.jsx(de,{dateAdapter:me,children:e.jsxs(ue,{autoComplete:"off",noValidate:!0,onSubmit:E,children:[e.jsx(he,{children:d?a.formatMessage({id:"services.radiology.editServiceTitle"}):a.formatMessage({id:"services.radiology.addServiceTitle"})}),e.jsx(Y,{}),e.jsx(ge,{sx:{p:2.5},children:e.jsxs(u,{container:!0,spacing:3,children:[e.jsxs(u,{item:!0,xs:12,md:3,children:[e.jsxs(l,{direction:"row",justifyContent:"center",sx:{mt:3},children:[e.jsxs(pe,{htmlFor:"change-avtar",sx:{position:"relative",borderRadius:"50%",overflow:"hidden","&:hover .MuiBox-root":{opacity:1},cursor:"pointer"},children:[e.jsx(Z,{alt:"Avatar 1",src:T,sx:{width:72,height:72,border:"1px dashed"}}),e.jsx(ee,{sx:{position:"absolute",top:0,left:0,background:k.palette.mode===xe.DARK?"rgba(255, 255, 255, .75)":"rgba(0,0,0,.65)",width:"100%",height:"100%",opacity:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(l,{spacing:.5,alignItems:"center",children:[e.jsx(Ke,{style:{color:k.palette.secondary.lighter,fontSize:"2rem"}}),e.jsx(v,{sx:{color:"secondary.lighter"},children:a.formatMessage({id:"common.upload"})})]})})]}),e.jsx(A,{type:"file",id:"change-avtar",placeholder:"Outlined",variant:"outlined",inputProps:{accept:"image/*"},sx:{display:"none"},onChange:n=>{var j;U("image",!0),R((j=n.target.files)==null?void 0:j[0])}})]}),e.jsx(l,{direction:"row",justifyContent:"center",children:o.image&&s.image&&e.jsx(_,{error:!0,id:"helper-image",children:s==null?void 0:s.image})})]}),e.jsx(u,{item:!0,xs:12,md:8,children:e.jsxs(u,{container:!0,spacing:3,children:[e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(l,{spacing:1,children:[e.jsx(I,{htmlFor:"name_en",children:a.formatMessage({id:"services.radiology.serviceNameEn"})}),e.jsx(A,{fullWidth:!0,id:"name_en",placeholder:a.formatMessage({id:"services.radiology.serviceNameEn"}),...g("name_en"),error:!!(o.name_en&&s.name_en)})]}),o.name_en&&s.name_en&&e.jsx(_,{error:!0,id:"helper-name_en",children:s==null?void 0:s.name_en})]}),e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(l,{spacing:1,children:[e.jsx(I,{htmlFor:"name_ar",children:a.formatMessage({id:"services.radiology.serviceNameAr"})}),e.jsx(A,{fullWidth:!0,id:"name_ar",placeholder:a.formatMessage({id:"services.radiology.serviceNameAr"}),...g("name_ar"),error:!!(o.name_ar&&s.name_ar)})]}),o.name_ar&&s.name_ar&&e.jsx(_,{error:!0,id:"helper-name_ar",children:s==null?void 0:s.name_ar})]}),e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(l,{spacing:1,children:[e.jsx(I,{htmlFor:"min_visit_price",children:a.formatMessage({id:"services.minVisitPrice"})}),e.jsx(A,{type:"number",fullWidth:!0,id:"min_visit_price",placeholder:a.formatMessage({id:"services.minVisitPrice"}),...g("min_visit_price"),error:!!(o.min_visit_price&&s.min_visit_price)})]}),o.min_visit_price&&s.min_visit_price&&e.jsx(_,{error:!0,id:"helper-min_visit_price",children:s==null?void 0:s.min_visit_price})]}),e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(l,{spacing:1,children:[e.jsx(I,{htmlFor:"min_service_price",children:a.formatMessage({id:"services.minServicePrice"})}),e.jsx(A,{type:"number",fullWidth:!0,id:"min_service_price",placeholder:a.formatMessage({id:"services.minServicePrice"}),...g("min_service_price"),error:!!(o.min_service_price&&s.min_service_price)})]}),o.min_service_price&&s.min_service_price&&e.jsx(_,{error:!0,id:"helper-min_service_price",children:s==null?void 0:s.min_service_price})]}),e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(l,{spacing:1,children:[e.jsx(I,{htmlFor:"discount",children:a.formatMessage({id:"services.discount"})}),e.jsx(A,{type:"number",fullWidth:!0,id:"discount",placeholder:a.formatMessage({id:"services.discount"}),...g("discount"),error:!!(o.discount&&s.discount)})]}),o.discount&&s.discount&&e.jsx(_,{error:!0,id:"helper-discount",children:s==null?void 0:s.discount})]}),e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(l,{spacing:1,children:[e.jsx(I,{htmlFor:"status",children:a.formatMessage({id:"services.serviceStatus"})}),e.jsx(je,{fullWidth:!0,children:e.jsxs(fe,{id:"status",displayEmpty:!0,value:b.status,onChange:n=>O("status",n.target.value),children:[e.jsx(F,{value:"",children:e.jsx("em",{children:a.formatMessage({id:"common.none"})})}),h==null?void 0:h.map(n=>e.jsx(F,{value:n.value,children:n.label[r]},n.value))]})})]}),o.status&&s.status&&e.jsx(_,{error:!0,id:"helper-status",children:s==null?void 0:s.status})]})]})})]})}),e.jsx(Y,{}),e.jsx(_e,{sx:{p:2.5},children:e.jsx(u,{container:!0,justifyContent:"right",alignItems:"center",children:e.jsx(u,{item:!0,children:e.jsxs(l,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(G,{color:"error",onClick:S,children:a.formatMessage({id:"common.cancel"})}),e.jsx(ve,{type:"submit",loading:C,loadingIndicator:a.formatMessage({id:"common.processing"}),variant:"contained",children:d?a.formatMessage({id:"services.radiology.editServiceTitle"}):a.formatMessage({id:"services.radiology.addSubmitButton"})})]})})})})]})})})})})}function qe(i){return[{title:i.formatMessage({id:"sidebar.home"}),to:Be},{title:i.formatMessage({id:"services.radiology.title"})}]}function us(){const{lang:i}=$(),{data:d,error:y,isLoading:f,setSorting:S,setFilterCriteria:k,setPagination:a,url:h}=ke(X.RADIOLOGY),r=Q(),M=J(),[R,T]=c.useState(!1),N=ye(M.breakpoints.down("sm")),[V,B]=c.useState(null),[s,o]=c.useState(0),[E,C]=c.useState(0),[g,b]=c.useState(0),[U,O]=c.useState(),{filter:n,search:j,setSearch:m}=Oe(),W=()=>{B(null),T(!0)},te=c.useCallback(async()=>{try{await Re(s,h).then(t=>{D(r.formatMessage({id:"services.deletServiceSuccess"})),o(0)})}catch{o(0)}},[s,h,r]),ie=c.useCallback(async()=>{try{await z(E,{status:L.Active},h).then(t=>{D(r.formatMessage({id:"services.activate.success"})),C(0)})}catch{C(0)}},[E,h,r]),ae=c.useCallback(async()=>{try{await z(g,{status:L.InActive},h).then(t=>{D(r.formatMessage({id:"services.deactivate.success"})),b(0)})}catch{b(0)}},[g,h,r]);c.useEffect(()=>{k(n)},[n]);const re=c.useMemo(()=>[{header:r.formatMessage({id:"services.serviceName"}),accessorKey:"name",enableSorting:!1,cell:({row:t})=>e.jsxs(l,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(Z,{alt:"Avatar 1",size:"sm",src:t.original.image}),e.jsx(l,{spacing:0,children:e.jsx(v,{variant:"subtitle1",children:t.original.name[i]})})]})},{header:r.formatMessage({id:"services.medicalCenters"}),accessorKey:"medical_centers_count",cell:({row:t})=>e.jsx(q,{className:"typography-inline",value:t.original.hospitals_count})},{header:r.formatMessage({id:"common.visits"}),accessorKey:"visits_count",disableSortBy:!0,cell:({row:t})=>e.jsx(q,{className:"typography-inline",value:t.original.visits_count})},{header:r.formatMessage({id:"common.status"}),accessorKey:"status",cell:({row:t})=>e.jsx(Se,{status:t.original.status,referenceKey:se.SERVICES_STATUS})},{header:r.formatMessage({id:"common.createdOn"}),accessorKey:"created_at",cell:({row:t})=>{var p;return Ee((p=t.original)==null?void 0:p.created_at).format(Me)}},{header:r.formatMessage({id:"common.actions"}),accessorKey:"Actions",meta:{className:"cell-center"},enableSorting:!1,cell:({row:t})=>{const[p,P]=c.useState(null),K=!!p,w=x=>{P(x.currentTarget)},H=()=>{P(null)};return e.jsxs(e.Fragment,{children:[e.jsx(Ce,{onClick:w,children:e.jsx(be,{})}),e.jsxs(Ae,{anchorEl:p,open:K,onClose:H,onClick:H,children:[e.jsx(F,{onClick:x=>{x.stopPropagation(),T(!0),B(t.original)},children:e.jsx(v,{variant:"body1",children:r.formatMessage({id:"services.radiology.editServiceTitle"})})}),t.original.status===L.Active&&e.jsx(F,{onClick:x=>{x.stopPropagation(),b(t.original.id)},children:e.jsx(v,{variant:"body1",children:r.formatMessage({id:"services.deactivate.action"})})}),t.original.status===L.InActive&&e.jsx(F,{onClick:x=>{x.stopPropagation(),C(t.original.id)},children:e.jsx(v,{variant:"body1",children:r.formatMessage({id:"services.activate.action"})})}),e.jsx(F,{onClick:x=>{x.stopPropagation(),o(t.original.id)},children:e.jsx(v,{variant:"body1",children:r.formatMessage({id:"services.radiology.deleteServiceTitle"})})})]})]})}}],[]);return c.useEffect(()=>{we().then(t=>{var P,K;const p=(K=(P=t==null?void 0:t.data)==null?void 0:P.data)==null?void 0:K.find(w=>(w==null?void 0:w.slug)==="radiology");O(p==null?void 0:p.id)})},[]),e.jsxs(e.Fragment,{children:[e.jsx(Ie,{custom:!0,links:qe(r)}),e.jsxs(l,{direction:"row",marginBottom:"20px",spacing:2,justifyContent:"space-between",alignItems:"center",children:[e.jsx(v,{variant:"h2",children:r.formatMessage({id:"services.radiology.title"})}),e.jsx(G,{variant:"contained",startIcon:e.jsx(Ge,{}),onClick:W,children:r.formatMessage({id:"services.radiology.addServiceTitle"})})]}),e.jsx(Fe,{data:d,columns:re,isLoading:f,setPagination:t=>{a(t)},setSortingParams:t=>{S(t)},children:e.jsx(Te,{content:!1,children:e.jsxs(l,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",justifyContent:"space-between",sx:{padding:2,...N&&{"& .MuiOutlinedInput-root, & .MuiFormControl-root":{width:"100%"}}},children:[e.jsx(ee,{sx:{width:{xs:"70%",md:"70%"}},children:e.jsx(l,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(Pe,{value:j,onFilterChange:t=>m(t),placeholder:r.formatMessage({id:"services.radiology.searchService"})})})}),e.jsx(l,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",sx:{width:{xs:"100%",sm:"auto"}},children:e.jsx(l,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(G,{variant:"outlined",startIcon:e.jsx(ze,{}),children:r.formatMessage({id:"common.export"})})})})]})})}),R&&e.jsx(Ye,{open:R,serviceId:U,handleClose:()=>{T(!1)},url:h,subService:V}),!!s&&e.jsx(We,{open:!!s,handleSubmit:te,handleClose:()=>{o(0)}}),e.jsx(Ve,{open:!!g,handleSubmit:ae,handleClose:()=>{b(0)}}),e.jsx(Ue,{open:!!E,handleSubmit:ie,handleClose:()=>{C(0)}})]})}export{us as default};
