import{u as O,W as N,r as E,b as H,b8 as L,cO as y,c as V,j as e,J as U,S as i,T as v,F as w,d as z,aL as G,G as r,l as u,aK as C,I as B,b0 as F,H as c,m as S,L as T,q as R,s as q}from"./index-DSO9TgYq.js";import{d as P}from"./dayjs.min-pRfd56nx.js";import{a as J,S as K}from"./coupon-DO8eO71b.js";import{A as I,D}from"./AdapterDayjs-DJXadXKJ.js";import"./Dialog-CPoUMqzk.js";function Q(t){return[{title:t.formatMessage({id:"sidebar.coupons"}),to:"/finance/coupons"},{title:t.formatMessage({id:"finance.createCoupon"}),to:"/finance/create-coupon"}]}const X=()=>({coupon_name:"",coupon_code:"",discount_type:"percentage",discount_amount:"",maximum_users:"",maximum_uses:"",set_minimum_amount:"",start_date:null,end_date:null,status:"active"});function ne(){const t=O(),x=N(),W=E.useMemo(()=>X(),[]),o=H({initialValues:W,validationSchema:J(t),enableReinitialize:!0,onSubmit:async(n,{setSubmitting:Y,setFieldError:Z})=>{var g,j,b,M;try{const d={...n,start_date:(g=n.start_date)==null?void 0:g.format("YYYY-MM-DD"),end_date:(j=n.end_date)==null?void 0:j.format("YYYY-MM-DD"),discount_amount:Number(n.discount_amount),maximum_users:n.maximum_users?Number(n.maximum_users):void 0,maximum_uses:n.maximum_uses?Number(n.maximum_uses):void 0,set_minimum_amount:n.set_minimum_amount?Number(n.set_minimum_amount):void 0},l=await L.post("/api/v1/admin/coupon",d);if(l.data&&l.data.success===!1){const k=l.data.message;y(k);return}V(t.formatMessage({id:"finance.couponCreated"})),x("/finance/coupons",{state:{refreshCoupons:!0}})}catch(d){y(((M=(b=d==null?void 0:d.response)==null?void 0:b.data)==null?void 0:M.message)||t.formatMessage({id:"common.errorOccurred"}))}finally{Y(!1)}}}),{errors:a,touched:s,handleSubmit:A,handleChange:p,values:m,isSubmitting:f,handleBlur:_,setFieldValue:h}=o;return e.jsxs(e.Fragment,{children:[e.jsx(U,{custom:!0,links:Q(t)}),e.jsx(i,{direction:"row",marginBottom:"20px",spacing:2,alignItems:"center",children:e.jsx(v,{variant:"h2",children:t.formatMessage({id:"finance.createCoupon"})})}),e.jsx(w,{value:o,children:e.jsx(z,{autoComplete:"off",noValidate:!0,onSubmit:A,children:e.jsx(G,{title:t.formatMessage({id:"finance.couponInfo"}),subheader:t.formatMessage({id:"finance.couponInfoSubtitle"}),children:e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(i,{spacing:1,children:e.jsx(u,{fullWidth:!0,label:t.formatMessage({id:"finance.couponName"}),...o.getFieldProps("coupon_name"),error:!!(s.coupon_name&&a.coupon_name),helperText:s.coupon_name&&a.coupon_name})})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(i,{spacing:1,children:e.jsx(u,{fullWidth:!0,label:t.formatMessage({id:"finance.couponCode"}),...o.getFieldProps("coupon_code"),error:!!(s.coupon_code&&a.coupon_code),helperText:s.coupon_code&&a.coupon_code,placeholder:"SAVE20"})})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(i,{spacing:1,children:e.jsxs(C,{fullWidth:!0,error:!!(s.discount_type&&a.discount_type),children:[e.jsx(B,{id:"discount-type-label",children:t.formatMessage({id:"finance.discountType"})}),e.jsxs(F,{labelId:"discount-type-label",id:"discount_type",name:"discount_type",value:m.discount_type,onChange:p,onBlur:_,label:t.formatMessage({id:"finance.discountType"}),children:[e.jsx(c,{value:"percentage",children:t.formatMessage({id:"finance.percentage"})}),e.jsx(c,{value:"flat",children:t.formatMessage({id:"finance.flat"})})]}),s.discount_type&&a.discount_type&&e.jsx(S,{error:!0,children:a.discount_type})]})})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(i,{spacing:1,children:e.jsx(u,{fullWidth:!0,type:"number",label:t.formatMessage({id:"finance.discountAmount"}),...o.getFieldProps("discount_amount"),error:!!(s.discount_amount&&a.discount_amount),helperText:s.discount_amount&&a.discount_amount,InputProps:{endAdornment:e.jsx(v,{variant:"body2",color:"textSecondary",children:m.discount_type==="percentage"?"%":""})}})})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(i,{spacing:1,children:e.jsx(u,{fullWidth:!0,type:"number",label:t.formatMessage({id:"finance.maximumUsers"}),...o.getFieldProps("maximum_users"),error:!!(s.maximum_users&&a.maximum_users),helperText:s.maximum_users&&a.maximum_users||t.formatMessage({id:"finance.maximumUsersHelp"})})})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(i,{spacing:1,children:e.jsx(u,{fullWidth:!0,type:"number",label:t.formatMessage({id:"finance.maximumUses"}),...o.getFieldProps("maximum_uses"),error:!!(s.maximum_uses&&a.maximum_uses),helperText:s.maximum_uses&&a.maximum_uses||t.formatMessage({id:"finance.maximumUsesHelp"})})})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(i,{spacing:1,children:e.jsx(u,{fullWidth:!0,type:"number",label:t.formatMessage({id:"finance.minimumOrderAmount"}),...o.getFieldProps("set_minimum_amount"),error:!!(s.set_minimum_amount&&a.set_minimum_amount),helperText:s.set_minimum_amount&&a.set_minimum_amount||t.formatMessage({id:"finance.minimumOrderAmountHelp"})})})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(i,{spacing:1,children:e.jsxs(C,{fullWidth:!0,error:!!(s.status&&a.status),children:[e.jsx(B,{id:"status-label",children:t.formatMessage({id:"common.status"})}),e.jsxs(F,{labelId:"status-label",id:"status",name:"status",value:m.status,onChange:p,onBlur:_,label:t.formatMessage({id:"common.status"}),children:[e.jsx(c,{value:"active",children:t.formatMessage({id:"common.active"})}),e.jsx(c,{value:"inactive",children:t.formatMessage({id:"common.inactive"})})]}),s.status&&a.status&&e.jsx(S,{error:!0,children:a.status})]})})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(i,{spacing:1,children:e.jsx(T,{dateAdapter:I,children:e.jsx(D,{label:t.formatMessage({id:"finance.startDate"}),value:m.start_date,onChange:n=>h("start_date",n),disablePast:!0,minDate:P().startOf("day"),slotProps:{textField:{fullWidth:!0,error:!!(s.start_date&&a.start_date),helperText:s.start_date&&a.start_date}}})})})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(i,{spacing:1,children:e.jsx(T,{dateAdapter:I,children:e.jsx(D,{label:t.formatMessage({id:"finance.endDate"}),value:m.end_date,onChange:n=>h("end_date",n),minDate:m.start_date??P().startOf("day"),slotProps:{textField:{fullWidth:!0,error:!!(s.end_date&&a.end_date),helperText:s.end_date&&a.end_date}}})})})}),e.jsx(r,{item:!0,xs:12,children:e.jsxs(i,{direction:"row",spacing:2,justifyContent:"flex-end",children:[e.jsx(R,{variant:"outlined",onClick:()=>x("/finance/coupons"),disabled:f,children:t.formatMessage({id:"common.cancel"})}),e.jsx(q,{type:"submit",variant:"contained",startIcon:e.jsx(K,{}),loading:f,children:t.formatMessage({id:"common.create"})})]})})]})})})})]})}export{ne as default};
