import{a as Q,u as $,t as X,r as c,g as ne,b as oe,bK as Y,c as P,j as e,C as ce,F as de,L as le,A as me,d as ue,D as he,e as q,f as ge,G as u,S as d,h as pe,i as Z,B as ee,k as xe,T as v,l as I,m as _,I as A,aK as je,b0 as fe,H as F,p as _e,q as z,s as ve,x as te,v as Se,w as K,R as Me,y as ye,z as Ce,M as be,E as Ie,J as Ae,K as Fe,aL as Te,U as Ve}from"./index-DSO9TgYq.js";import{d as De}from"./dayjs.min-pRfd56nx.js";import{D as Be}from"./DebouncedInput-DhmfX_1V.js";import{f as Ee}from"./services-DCcxZZqT.js";import{C as Pe}from"./CameraOutlined-D4Mj0cXe.js";import{u as we}from"./useStatusList-Dbp-x5Xm.js";import{d as ke}from"./services-BGkrpTaC.js";import{u as G,a as Oe,b as Re,d as Ke}from"./sub-services-Cm3yL5Hw.js";import{u as Ne}from"./useFilterAndSearch-PJD0Zg8P.js";import{D as Le}from"./DeleteConfirmation-BqFOMagf.js";import{D as Ue,A as We}from"./ActivateServiceConfirmation-DBGR9riN.js";import{C as J}from"./CustomTypography-CRnDvUFn.js";import{P as ze}from"./PlusOutlined-BQvVSxI0.js";import{A as Ge}from"./ArrowUpOutlined-C9GTlrEN.js";import"./CloseOutlined-DRBnXhIJ.js";import"./ConfirmationDialog-DR_Ho8RD.js";import"./Dialog-CPoUMqzk.js";const He=i=>{var S,f;const l={name_en:"",name_ar:"",min_visit_price:"",min_service_price:"",discount:"",status:1,image:""};return i?{name_en:(S=i==null?void 0:i.name)==null?void 0:S.en,name_ar:(f=i==null?void 0:i.name)==null?void 0:f.ar,min_visit_price:Number(i==null?void 0:i.min_visit_price),min_service_price:Number(i==null?void 0:i.min_service_price),discount:Number(i==null?void 0:i.discount),status:i==null?void 0:i.status,image:i==null?void 0:i.image}:l};function qe({serviceId:i,subService:l,url:S,open:f,handleClose:M}){const w=Q(),a=$(),{defaultList:h}=we(te.PACKAGE_STATUS),{lang:r}=X(),[y,k]=c.useState(void 0),[T,N]=c.useState(`${l&&(l!=null&&l.image)?l.image:""}`);c.useEffect(()=>{y&&(N(URL.createObjectURL(y)),ne(y,n=>{O("image",n)}))},[y]);const L=c.useMemo(()=>He(l),[]),V=oe({initialValues:L,validationSchema:ke(a),enableReinitialize:!0,onSubmit:async(n,{setSubmitting:j})=>{try{let m={...n,service_type:Y.DOCTOR_VISIT,service_id:i,name:{en:n==null?void 0:n.name_en,ar:n==null?void 0:n.name_ar}};(m.discount===""||m.discount===null||m.discount===void 0)&&(m.discount=0),m.image.includes("http")&&delete m.image,delete m.name_en,delete m.name_ar,l?await G(l.id,m,S).then(W=>{P(a.formatMessage({id:"services.editServiceSuccess"})),j(!1),M()}):await Oe(m,S).then(W=>{P(a.formatMessage({id:"services.addServiceSuccess"})),j(!1),M()})}catch(m){console.error(m),j(!1)}}}),{errors:t,touched:o,handleSubmit:D,isSubmitting:C,getFieldProps:g,values:b,setFieldTouched:U,setFieldValue:O}=V;return e.jsx(e.Fragment,{children:f&&e.jsx(ce,{open:f,handleClose:M,children:e.jsx(de,{value:V,children:e.jsx(le,{dateAdapter:me,children:e.jsxs(ue,{autoComplete:"off",noValidate:!0,onSubmit:D,children:[e.jsx(he,{children:l?a.formatMessage({id:"services.doctorVisit.editServiceTitle"}):a.formatMessage({id:"services.doctorVisit.addServiceTitle"})}),e.jsx(q,{}),e.jsx(ge,{sx:{p:2.5},children:e.jsxs(u,{container:!0,spacing:3,children:[e.jsxs(u,{item:!0,xs:12,md:3,children:[e.jsxs(d,{direction:"row",justifyContent:"center",sx:{mt:3},children:[e.jsxs(pe,{htmlFor:"change-avtar",sx:{position:"relative",borderRadius:"50%",overflow:"hidden","&:hover .MuiBox-root":{opacity:1},cursor:"pointer"},children:[e.jsx(Z,{alt:"Avatar 1",src:T,sx:{width:72,height:72,border:"1px dashed"}}),e.jsx(ee,{sx:{position:"absolute",top:0,left:0,background:w.palette.mode===xe.DARK?"rgba(255, 255, 255, .75)":"rgba(0,0,0,.65)",width:"100%",height:"100%",opacity:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(d,{spacing:.5,alignItems:"center",children:[e.jsx(Pe,{style:{color:w.palette.secondary.lighter,fontSize:"2rem"}}),e.jsx(v,{sx:{color:"secondary.lighter"},children:a.formatMessage({id:"common.upload"})})]})})]}),e.jsx(I,{type:"file",id:"change-avtar",placeholder:"Outlined",variant:"outlined",inputProps:{accept:"image/*"},sx:{display:"none"},onChange:n=>{var j;U("image",!0),k((j=n.target.files)==null?void 0:j[0])}})]}),e.jsx(d,{direction:"row",justifyContent:"center",children:o.image&&t.image&&e.jsx(_,{error:!0,id:"helper-image",children:t==null?void 0:t.image})})]}),e.jsx(u,{item:!0,xs:12,md:8,children:e.jsxs(u,{container:!0,spacing:3,children:[e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(A,{htmlFor:"name_en",children:a.formatMessage({id:"services.doctorVisit.serviceNameEn"})}),e.jsx(I,{fullWidth:!0,id:"name_en",placeholder:a.formatMessage({id:"services.doctorVisit.serviceNameEn"}),...g("name_en"),error:!!(o.name_en&&t.name_en)})]}),o.name_en&&t.name_en&&e.jsx(_,{error:!0,id:"helper-name_en",children:t==null?void 0:t.name_en})]}),e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(A,{htmlFor:"name_ar",children:a.formatMessage({id:"services.doctorVisit.serviceNameAr"})}),e.jsx(I,{fullWidth:!0,id:"name_ar",placeholder:a.formatMessage({id:"services.doctorVisit.serviceNameAr"}),...g("name_ar"),error:!!(o.name_ar&&t.name_ar)})]}),o.name_ar&&t.name_ar&&e.jsx(_,{error:!0,id:"helper-name_ar",children:t==null?void 0:t.name_ar})]}),e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(A,{htmlFor:"min_visit_price",children:a.formatMessage({id:"services.minVisitPrice"})}),e.jsx(I,{type:"number",fullWidth:!0,id:"min_visit_price",placeholder:a.formatMessage({id:"services.minVisitPrice"}),...g("min_visit_price"),error:!!(o.min_visit_price&&t.min_visit_price)})]}),o.min_visit_price&&t.min_visit_price&&e.jsx(_,{error:!0,id:"helper-min_visit_price",children:t==null?void 0:t.min_visit_price})]}),e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(A,{htmlFor:"min_service_price",children:a.formatMessage({id:"services.minServicePrice"})}),e.jsx(I,{type:"number",fullWidth:!0,id:"min_service_price",placeholder:a.formatMessage({id:"services.minServicePrice"}),...g("min_service_price"),error:!!(o.min_service_price&&t.min_service_price)})]}),o.min_service_price&&t.min_service_price&&e.jsx(_,{error:!0,id:"helper-min_service_price",children:t==null?void 0:t.min_service_price})]}),e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(A,{htmlFor:"discount",children:a.formatMessage({id:"services.discount"})}),e.jsx(I,{type:"number",fullWidth:!0,id:"discount",placeholder:a.formatMessage({id:"services.discount"}),...g("discount"),error:!!(o.discount&&t.discount)})]}),o.discount&&t.discount&&e.jsx(_,{error:!0,id:"helper-discount",children:t==null?void 0:t.discount})]}),e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(A,{htmlFor:"status",children:a.formatMessage({id:"services.serviceStatus"})}),e.jsx(je,{fullWidth:!0,children:e.jsxs(fe,{id:"status",displayEmpty:!0,value:b.status,onChange:n=>O("status",n.target.value),children:[e.jsx(F,{value:"",children:e.jsx("em",{children:a.formatMessage({id:"common.none"})})}),h==null?void 0:h.map(n=>e.jsx(F,{value:n.value,children:n.label[r]},n.value))]})})]}),o.status&&t.status&&e.jsx(_,{error:!0,id:"helper-status",children:t==null?void 0:t.status})]})]})})]})}),e.jsx(q,{}),e.jsx(_e,{sx:{p:2.5},children:e.jsx(u,{container:!0,justifyContent:"right",alignItems:"center",children:e.jsx(u,{item:!0,children:e.jsxs(d,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(z,{color:"error",onClick:M,children:a.formatMessage({id:"common.cancel"})}),e.jsx(ve,{type:"submit",loading:C,loadingIndicator:a.formatMessage({id:"common.processing"}),variant:"contained",children:l?a.formatMessage({id:"services.doctorVisit.editServiceTitle"}):a.formatMessage({id:"services.doctorVisit.addSubmitButton"})})]})})})})]})})})})})}function Je(i){return[{title:i.formatMessage({id:"sidebar.home"}),to:Ve},{title:i.formatMessage({id:"services.doctorVisit.title"})}]}function ut(){const{lang:i}=X(),{data:l,error:S,isLoading:f,setSorting:M,setFilterCriteria:w,setPagination:a,url:h}=Re(Y.DOCTOR_VISIT),r=$(),y=Q(),[k,T]=c.useState(!1),N=Se(y.breakpoints.down("sm")),[L,V]=c.useState(null),[t,o]=c.useState(0),[D,C]=c.useState(0),[g,b]=c.useState(0),[U,O]=c.useState(),{filter:n,search:j,setSearch:m}=Ne(),W=()=>{V(null),T(!0)},se=c.useCallback(async()=>{try{await Ke(t,h).then(s=>{P(r.formatMessage({id:"services.deletServiceSuccess"})),o(0)})}catch{o(0)}},[t,h,r]),ie=c.useCallback(async()=>{try{await G(D,{status:K.Active},h).then(s=>{P(r.formatMessage({id:"services.activate.success"})),C(0)})}catch{C(0)}},[D,h,r]),ae=c.useCallback(async()=>{try{await G(g,{status:K.InActive},h).then(s=>{P(r.formatMessage({id:"services.deactivate.success"})),b(0)})}catch{b(0)}},[g,h,r]);c.useEffect(()=>{w(n)},[n]),c.useEffect(()=>{Ee().then(s=>{var B,R;const p=(R=(B=s==null?void 0:s.data)==null?void 0:B.data)==null?void 0:R.find(E=>(E==null?void 0:E.slug)==="doctor-visit");O(p==null?void 0:p.id)})},[]);const re=c.useMemo(()=>[{header:r.formatMessage({id:"common.specialty"}),accessorKey:"name",enableSorting:!1,cell:({row:s})=>e.jsxs(d,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(Z,{alt:"Avatar 1",size:"sm",src:s.original.image}),e.jsx(d,{spacing:0,children:e.jsx(v,{variant:"subtitle1",children:s.original.name[i]})})]})},{header:r.formatMessage({id:"services.medicalCenters"}),accessorKey:"medical_centers_count",cell:({row:s})=>e.jsx(J,{className:"typography-inline",value:s.original.hospitals_count})},{header:r.formatMessage({id:"common.visits"}),accessorKey:"visits_count",disableSortBy:!0,cell:({row:s})=>e.jsx(J,{className:"typography-inline",value:s.original.visits_count})},{header:r.formatMessage({id:"common.status"}),accessorKey:"status",cell:({row:s})=>e.jsx(Me,{status:s.original.status,referenceKey:te.SERVICES_STATUS})},{header:r.formatMessage({id:"common.createdOn"}),accessorKey:"created_at",cell:({row:s})=>{var p;return De((p=s.original)==null?void 0:p.created_at).format(ye)}},{header:r.formatMessage({id:"common.actions"}),accessorKey:"Actions",meta:{className:"cell-center"},enableSorting:!1,cell:({row:s})=>{const[p,B]=c.useState(null),R=!!p,E=x=>{B(x.currentTarget)},H=()=>{B(null)};return e.jsxs(e.Fragment,{children:[e.jsx(Ce,{onClick:E,children:e.jsx(be,{})}),e.jsxs(Ie,{anchorEl:p,open:R,onClose:H,onClick:H,children:[e.jsx(F,{onClick:x=>{x.stopPropagation(),T(!0),V(s.original)},children:e.jsx(v,{variant:"body1",children:r.formatMessage({id:"services.doctorVisit.editServiceTitle"})})}),s.original.status===K.Active&&e.jsx(F,{onClick:x=>{x.stopPropagation(),b(s.original.id)},children:e.jsx(v,{variant:"body1",children:r.formatMessage({id:"services.deactivate.action"})})}),s.original.status===K.InActive&&e.jsx(F,{onClick:x=>{x.stopPropagation(),C(s.original.id)},children:e.jsx(v,{variant:"body1",children:r.formatMessage({id:"services.activate.action"})})}),e.jsx(F,{onClick:x=>{x.stopPropagation(),o(s.original.id)},children:e.jsx(v,{variant:"body1",children:r.formatMessage({id:"services.doctorVisit.deleteServiceTitle"})})})]})]})}}],[]);return e.jsxs(e.Fragment,{children:[e.jsx(Ae,{custom:!0,links:Je(r)}),e.jsxs(d,{direction:"row",marginBottom:"20px",spacing:2,justifyContent:"space-between",alignItems:"center",children:[e.jsx(v,{variant:"h2",children:r.formatMessage({id:"services.doctorVisit.title"})}),e.jsx(z,{variant:"contained",startIcon:e.jsx(ze,{}),onClick:W,children:r.formatMessage({id:"services.doctorVisit.addServiceTitle"})})]}),e.jsx(Fe,{data:l,columns:re,isLoading:f,setPagination:s=>{a(s)},setSortingParams:s=>{M(s)},children:e.jsx(Te,{content:!1,children:e.jsxs(d,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",justifyContent:"space-between",sx:{padding:2,...N&&{"& .MuiOutlinedInput-root, & .MuiFormControl-root":{width:"100%"}}},children:[e.jsx(ee,{sx:{width:{xs:"70%",md:"70%"}},children:e.jsx(d,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(Be,{value:j,onFilterChange:s=>m(s),placeholder:r.formatMessage({id:"services.doctorVisit.searchService"})})})}),e.jsx(d,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",sx:{width:{xs:"100%",sm:"auto"}},children:e.jsx(d,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(z,{variant:"outlined",startIcon:e.jsx(Ge,{}),children:r.formatMessage({id:"common.export"})})})})]})})}),k&&e.jsx(qe,{open:k,handleClose:()=>{T(!1)},url:h,subService:L,serviceId:U}),!!t&&e.jsx(Le,{open:!!t,handleSubmit:se,handleClose:()=>{o(0)}}),e.jsx(Ue,{open:!!g,handleSubmit:ae,handleClose:()=>{b(0)}}),e.jsx(We,{open:!!D,handleSubmit:ie,handleClose:()=>{C(0)}})]})}export{ut as default};
