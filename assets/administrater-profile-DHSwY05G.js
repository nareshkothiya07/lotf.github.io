import{u as M,j as e,T as p,e as R,aw as ne,aS as P,B as j,X as q,y as le,a as de,r as u,g as ce,b as X,a$ as me,c as O,C as he,F as Q,L as xe,A as pe,d as Y,D as ue,f as je,G as r,S as m,h as Z,i as ee,k as fe,l as F,m as w,I as v,aK as se,b0 as te,H as V,p as ge,q as z,s as re,aL as A,t as ye,aC as U,N as W,aJ as H,x as we,b1 as ae,J as ve,U as be}from"./index-DSO9TgYq.js";import{a as Me,e as ie,f as Se,g as Ce}from"./administrator-DTa7ROU2.js";import{u as T}from"./hooks-CMWd8yYb.js";import{d as Pe}from"./dayjs.min-pRfd56nx.js";import{C as _}from"./CustomTypography-CRnDvUFn.js";import{C as Ie}from"./CameraOutlined-D4Mj0cXe.js";import{P as Fe}from"./react-number-format.es-Bl0F5VJY.js";import{c as _e}from"./role-NGsUuE4A.js";import{E as Ae}from"./EditFilled-Bmyorrxv.js";import{T as G}from"./TabPanel-BmkMU0MV.js";import{u as Te}from"./useStatusList-Dbp-x5Xm.js";import{c as Be}from"./common-9rbEmXms.js";import{E as $}from"./EyeOutlined-ChV9zO9W.js";import{E as J}from"./EyeInvisibleOutlined-CaFaFVHk.js";import{T as Ne,a as K}from"./Tabs-CFBjtj-9.js";import"./regex-AjllrUCH.js";import"./Box-D442Dag1.js";const Ee=()=>{const s=M(),t=T(d=>d.app.administrator);return e.jsxs("div",{children:[e.jsxs(p,{variant:"h6",color:"secondary",sx:{textTransform:"uppercase"},children:[s.formatMessage({id:"profile.personalInfoTitle"})," "]}),e.jsx(R,{sx:{my:1}}),e.jsxs(ne,{component:"nav","aria-label":"main mailbox folders  ",sx:{py:0,"& .MuiListItem-root":{p:0,py:"4px",display:"block"}},children:[e.jsx(P,{children:e.jsxs(j,{sx:{display:"inline"},children:[e.jsxs(p,{variant:"body1",color:"secondary",className:"typography-inline",children:[s.formatMessage({id:"profile.id"}),":  "]}),e.jsxs(p,{variant:"body1",className:"typography-inline",children:[t==null?void 0:t.id," "]})]})}),e.jsx(P,{children:e.jsxs(j,{sx:{display:"inline"},children:[e.jsxs(p,{variant:"body1",color:"secondary",className:"typography-inline",children:[s.formatMessage({id:"profile.email"}),":  "]}),e.jsx(_,{className:"typography-inline",value:t==null?void 0:t.email})]})}),e.jsx(P,{children:e.jsxs(j,{sx:{display:"inline"},children:[e.jsxs(p,{variant:"body1",color:"secondary",className:"typography-inline",children:[s.formatMessage({id:"profile.phoneNo"}),":  "]}),e.jsx(_,{className:"typography-inline",value:q(t==null?void 0:t.phone)})]})}),e.jsx(P,{children:e.jsxs(j,{sx:{display:"inline"},children:[e.jsxs(p,{variant:"body1",color:"secondary",className:"typography-inline",children:[s.formatMessage({id:"common.joinedon"}),":  "]}),e.jsx(_,{className:"typography-inline",value:t==null?void 0:t.created_at,renderFunction:d=>Pe(d).format(le)})]})}),e.jsx(P,{children:e.jsxs(j,{sx:{display:"inline"},children:[e.jsxs(p,{variant:"body1",color:"secondary",className:"typography-inline",children:[s.formatMessage({id:"common.lastActive"}),":  "]}),e.jsx(_,{className:"typography-inline",value:t==null?void 0:t.last_active})]})})]})]})},ke=Ee,De=s=>{var t;return{first_name:s==null?void 0:s.first_name,photo:s==null?void 0:s.photo,phone:q(s==null?void 0:s.phone),email:s==null?void 0:s.email,role_id:(t=s==null?void 0:s.roles[0])==null?void 0:t.id}};function Le({open:s,handleClose:t}){const d=de(),a=M(),i=T(n=>n.app.administrator),[h,S]=u.useState(void 0),[B,c]=u.useState([]),[N,E]=u.useState(`${i&&(i!=null&&i.photo)?i.photo:""}`);u.useEffect(()=>{h&&(E(URL.createObjectURL(h)),ce(h,n=>{C("photo",n)}))},[h]);const k=u.useMemo(()=>De(i),[i]),f=X({initialValues:k,validationSchema:Me(a,!0),enableReinitialize:!0,onSubmit:async(n,{setSubmitting:l})=>{try{let y={...n,phone:me(n.phone)};y.photo.includes("http")&&delete y.photo,await ie(i==null?void 0:i.id,y).then(oe=>{O(a.formatMessage({id:"administrative.editSuccess"})),l(!1),t()})}catch(y){l(!1),console.error(y)}}});u.useEffect(()=>{_e().then(n=>{var l;c((l=n==null?void 0:n.data)==null?void 0:l.data)})},[]);const{errors:o,touched:x,handleSubmit:D,values:b,isSubmitting:I,handleBlur:L,getFieldProps:g,setFieldValue:C}=f;return e.jsx(e.Fragment,{children:s&&e.jsx(he,{open:s,handleClose:t,children:e.jsx(Q,{value:f,children:e.jsx(xe,{dateAdapter:pe,children:e.jsxs(Y,{autoComplete:"off",noValidate:!0,onSubmit:D,children:[e.jsx(ue,{children:a.formatMessage({id:"common.updateInformation"})}),e.jsx(R,{}),e.jsx(je,{sx:{p:2.5},children:e.jsxs(r,{container:!0,spacing:3,children:[e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsxs(m,{direction:"row",justifyContent:"center",sx:{mt:3},children:[e.jsxs(Z,{htmlFor:"change-avtar",sx:{position:"relative",borderRadius:"50%",overflow:"hidden","&:hover .MuiBox-root":{opacity:1},cursor:"pointer"},children:[e.jsx(ee,{alt:"Avatar 1",src:N,sx:{width:72,height:72,border:"1px dashed"}}),e.jsx(j,{sx:{position:"absolute",top:0,left:0,background:d.palette.mode===fe.DARK?"rgba(255, 255, 255, .75)":"rgba(0,0,0,.65)",width:"100%",height:"100%",opacity:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(m,{spacing:.5,alignItems:"center",children:[e.jsx(Ie,{style:{color:d.palette.secondary.lighter,fontSize:"2rem"}}),e.jsx(p,{sx:{color:"secondary.lighter"},children:a.formatMessage({id:"common.upload"})})]})})]}),e.jsx(F,{type:"file",id:"change-avtar",placeholder:"Outlined",variant:"outlined",inputProps:{accept:"image/*"},sx:{display:"none"},onChange:n=>{var l;return S((l=n.target.files)==null?void 0:l[0])}})]}),e.jsx(m,{direction:"row",justifyContent:"center",children:x.photo&&o.photo&&e.jsx(w,{error:!0,id:"helper-image",children:o==null?void 0:o.photo})})]}),e.jsx(r,{item:!0,xs:12,md:8,children:e.jsxs(r,{container:!0,spacing:3,children:[e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsxs(m,{spacing:1,children:[e.jsx(v,{htmlFor:"first_name",children:a.formatMessage({id:"administrative.adminName"})}),e.jsx(F,{fullWidth:!0,id:"first_name",placeholder:a.formatMessage({id:"administrative.adminName"}),...g("first_name"),error:!!(x.first_name&&o.first_name)})]}),x.first_name&&o.first_name&&e.jsx(w,{error:!0,id:"helper-first_name",children:o==null?void 0:o.first_name})]}),e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsxs(m,{spacing:1,children:[e.jsx(v,{htmlFor:"email",children:a.formatMessage({id:"profile.email"})}),e.jsx(F,{fullWidth:!0,id:"email",placeholder:a.formatMessage({id:"profile.email"}),...g("email"),error:!!(x.email&&o.email)})]}),x.email&&o.email&&e.jsx(w,{error:!0,id:"helper-email",children:o==null?void 0:o.email})]}),e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsxs(m,{spacing:1,children:[e.jsx(v,{htmlFor:"phone",children:a.formatMessage({id:"profile.phoneNo"})}),e.jsx(Fe,{id:"phone",name:"phone",format:"+### ## ### ####",mask:"_",placeholder:"+966 5",value:b.phone,onValueChange:n=>f.setFieldValue("phone",n.formattedValue),onBlur:f.handleBlur,customInput:F})]}),x.phone&&o.phone&&e.jsx(w,{error:!0,id:"helper-phone",children:o==null?void 0:o.phone})]}),e.jsxs(r,{item:!0,xs:6,sm:6,children:[e.jsxs(m,{spacing:1,children:[e.jsx(v,{htmlFor:"role",children:a.formatMessage({id:"common.role"})}),e.jsx(se,{fullWidth:!0,error:!!(x.role_id&&o.role_id),children:e.jsxs(te,{id:"role_id",displayEmpty:!0,value:b==null?void 0:b.role_id,onChange:n=>{C("role_id",n.target.value)},children:[e.jsx(V,{value:"",disabled:!0,children:e.jsx(p,{color:"secondary",children:a.formatMessage({id:"common.selectOp"})})}),B.map(n=>e.jsx(V,{value:n.id,children:n.name},n.id))]})})]}),x.role_id&&o.role_id&&e.jsx(w,{error:!0,id:"role_id-helper",children:o.role_id})]})]})})]})}),e.jsx(R,{}),e.jsx(ge,{sx:{p:2.5},children:e.jsx(r,{container:!0,justifyContent:"right",alignItems:"center",children:e.jsx(r,{item:!0,children:e.jsxs(m,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(z,{color:"error",onClick:t,children:a.formatMessage({id:"common.cancel"})}),e.jsx(re,{type:"submit",loading:I,loadingIndicator:a.formatMessage({id:"common.processing"}),variant:"contained",children:a.formatMessage({id:"common.updateInformation"})})]})})})})]})})})})})}function Re(){var h;const[s,t]=u.useState(!1),d=M(),a=T(S=>S.app.administrator),i=(h=a==null?void 0:a.roles)==null?void 0:h.find(Boolean);return e.jsxs(A,{children:[e.jsxs(r,{container:!0,spacing:2,children:[e.jsx(r,{item:!0,xs:12,children:e.jsxs(m,{spacing:2.5,alignItems:"center",children:[e.jsx(Z,{htmlFor:"change-avtar",sx:{position:"relative",borderRadius:"50%",overflow:"hidden","&:hover .MuiBox-root":{opacity:1},cursor:"pointer"},children:e.jsx(ee,{alt:"Avatar 1",src:a==null?void 0:a.photo,sx:{width:124,height:124,border:"1px dashed"}})}),e.jsxs(m,{spacing:.5,alignItems:"center",children:[e.jsx(p,{variant:"h5",children:a==null?void 0:a.first_name}),i&&e.jsx(p,{color:"secondary",children:i==null?void 0:i.name})]})]})}),e.jsx(r,{item:!0,sm:3,sx:{display:{sm:"block",md:"none"}}}),e.jsx(r,{item:!0,xs:12,children:e.jsx(ke,{})}),e.jsx(r,{item:!0,xs:12,display:"flex",sx:{mt:1},justifyContent:"center",children:e.jsx(z,{onClick:()=>t(!0),variant:"outlined",startIcon:e.jsx(Ae,{}),children:d.formatMessage({id:"profile.editInformation"})})})]}),s&&e.jsx(Le,{open:s,handleClose:()=>t(!1)})]})}function Oe(){const[s,t]=u.useState(!1),[d,a]=u.useState(!1),i=T(l=>l.app.administrator),[h,S]=u.useState(String(i==null?void 0:i.status)),{lang:B}=ye(),c=M(),{defaultList:N}=Te(we.DOCTOR_STATUS),E=()=>{t(!s)},k=()=>{a(!d)},f=l=>{l.preventDefault()},o=()=>{ie(i==null?void 0:i.id,{status:Number(h)}).then(l=>{O(c.formatMessage({id:"administrative.statusEditSuccess"}))})},x=X({initialValues:{password:"",confirm:""},validationSchema:Be(c),enableReinitialize:!0,onSubmit:async(l,{setSubmitting:y})=>{await Se(i==null?void 0:i.id,{password:l==null?void 0:l.password}).then(oe=>{y(!1),x.resetForm(),O(c.formatMessage({id:"common.changePassword.passwordChangeSuccess"}))})}}),{handleSubmit:D,isSubmitting:b,touched:I,handleBlur:L,errors:g,handleChange:C,values:n}=x;return e.jsx(Q,{value:x,children:e.jsx(Y,{autoComplete:"off",noValidate:!0,onSubmit:D,children:e.jsxs(r,{container:!0,spacing:2,children:[e.jsx(r,{item:!0,xs:12,sm:12,children:e.jsx(A,{title:c.formatMessage({id:"common.changePassword.title"}),children:e.jsxs(r,{container:!0,spacing:2,children:[e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsxs(m,{spacing:1,children:[e.jsx(v,{htmlFor:"password",children:c.formatMessage({id:"common.changePassword.newPassword"})}),e.jsx(U,{id:"password",placeholder:c.formatMessage({id:"common.changePassword.newPassword"}),type:s?"text":"password",value:n.password,name:"password",onBlur:L,onChange:C,endAdornment:e.jsx(W,{position:"end",children:e.jsx(H,{"aria-label":"toggle password visibility",onClick:E,onMouseDown:f,edge:"end",size:"large",color:"secondary",children:s?e.jsx($,{}):e.jsx(J,{})})})})]}),I.password&&g.password&&e.jsx(w,{error:!0,id:"password-helper",children:g.password})]}),e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsxs(m,{spacing:1,children:[e.jsx(v,{htmlFor:"password-confirm",children:c.formatMessage({id:"common.changePassword.confirmPassword"})}),e.jsx(U,{id:"password-confirm",placeholder:c.formatMessage({id:"common.changePassword.confirmPassword"}),type:d?"text":"password",value:n.confirm,name:"confirm",onBlur:L,onChange:C,endAdornment:e.jsx(W,{position:"end",children:e.jsx(H,{"aria-label":"toggle password visibility",onClick:k,onMouseDown:f,edge:"end",size:"large",color:"secondary",children:d?e.jsx($,{}):e.jsx(J,{})})}),autoComplete:"password-confirm"})]}),I.confirm&&g.confirm&&e.jsx(w,{error:!0,id:"password-confirm-helper",children:g.confirm})]}),e.jsx(r,{item:!0,xs:12,children:e.jsx(m,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:e.jsx(re,{type:"submit",loading:b,loadingIndicator:c.formatMessage({id:"common.processing"}),variant:"contained",children:c.formatMessage({id:"common.changePassword.title"})})})})]})})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(A,{title:c.formatMessage({id:"doctor.settingTab.accountStatus"}),children:e.jsx(r,{container:!0,spacing:2,children:e.jsx(r,{item:!0,xs:6,children:e.jsxs(r,{container:!0,spacing:2,children:[e.jsx(r,{item:!0,xs:12,sm:12,children:e.jsxs(m,{spacing:1,children:[e.jsx(v,{htmlFor:"status",children:c.formatMessage({id:"common.status"})}),e.jsx(se,{fullWidth:!0,children:e.jsx(te,{id:"status",value:h,onChange:l=>{S(l.target.value)},children:N.map(l=>e.jsx(V,{value:l.value,children:l.label[B]},l.value))})})]})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(m,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:2,children:e.jsx(z,{onClick:o,variant:"contained",children:c.formatMessage({id:"common.editStatus"})})})})]})})})})})]})})})}function Ve(){ae();const[s,t]=u.useState(1),d=M(),a=(i,h)=>{t(h)};return e.jsx(e.Fragment,{children:e.jsxs(A,{border:!1,boxShadow:!0,children:[e.jsx(j,{sx:{borderBottom:1,borderColor:"divider",width:"100%"},children:e.jsxs(Ne,{value:s,onChange:a,variant:"scrollable",scrollButtons:"auto","aria-label":"account profile tab",children:[e.jsx(K,{label:d.formatMessage({id:"administrative.settingTab.title"}),value:1}),e.jsx(K,{label:d.formatMessage({id:"administrative.activityTab.title"}),value:2})]})}),e.jsxs(j,{sx:{mt:2.5},children:[e.jsx(G,{value:s,index:1,children:e.jsx(Oe,{})}),e.jsx(G,{value:s,index:2})]})]})})}function ze(s){return[{title:s.formatMessage({id:"sidebar.home"}),to:be},{title:s.formatMessage({id:"sidebar.administrative"}),to:"/administrater/list"},{title:s.formatMessage({id:"common.detail"})}]}function is(){const s=M(),{id:t}=ae();return Ce(Number(t)),e.jsxs(e.Fragment,{children:[e.jsx(ve,{custom:!0,links:ze(s)}),e.jsxs(r,{container:!0,spacing:1,children:[e.jsx(r,{item:!0,xs:3,md:3,children:e.jsx(Re,{})}),e.jsx(r,{item:!0,xs:9,md:9,children:e.jsx(Ve,{})})]})]})}export{is as default};
