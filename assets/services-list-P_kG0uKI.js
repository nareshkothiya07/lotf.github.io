import{u as O,t as N,r as l,b as q,c as y,j as e,C as J,F as Q,L as X,A as Y,d as Z,D as $,e as R,f as ee,G as m,S as c,I as w,l as L,m as k,aK as se,b0 as ae,H as _,p as te,q as V,s as ne,x as U,a as re,v as ie,w as b,i as oe,T as M,R as ce,y as le,z as de,M as me,E as ue,J as he,K as ge,aL as xe,B as pe,U as je}from"./index-DSO9TgYq.js";import{d as fe}from"./dayjs.min-pRfd56nx.js";import{D as ve}from"./DebouncedInput-DhmfX_1V.js";import{u as D,a as Se,b as Me}from"./services-DCcxZZqT.js";import{u as _e}from"./useStatusList-Dbp-x5Xm.js";import{s as Ae}from"./services-BGkrpTaC.js";import{D as Ce,A as be}from"./ActivateServiceConfirmation-DBGR9riN.js";import{A as ye}from"./ArrowUpOutlined-C9GTlrEN.js";import"./CloseOutlined-DRBnXhIJ.js";import"./ConfirmationDialog-DR_Ho8RD.js";import"./Dialog-CPoUMqzk.js";const Ie=a=>{var p,d;const x={name_en:"",name_ar:"",status:1};return a?{name_en:(p=a==null?void 0:a.name)==null?void 0:p.en,name_ar:(d=a==null?void 0:a.name)==null?void 0:d.ar,status:a==null?void 0:a.status}:x};function Fe({service:a,url:x,open:p,handleClose:d}){const t=O(),{defaultList:j}=_e(U.PACKAGE_STATUS),{lang:I}=N(),n=l.useMemo(()=>Ie(a),[]),A=q({initialValues:n,validationSchema:Ae(t),enableReinitialize:!0,onSubmit:async(r,{setSubmitting:h})=>{try{let o={...r,name:{en:r==null?void 0:r.name_en,ar:r==null?void 0:r.name_ar}};delete o.name_en,delete o.name_ar,a?await D(a.id,o,x).then(E=>{y(t.formatMessage({id:"services.editServiceSuccess"})),h(!1),d()}):await Se(o,x).then(E=>{y(t.formatMessage({id:"services.addServiceSuccess"})),h(!1),d()})}catch(o){console.error(o),h(!1)}}}),{errors:i,touched:u,handleSubmit:F,isSubmitting:C,getFieldProps:f,values:T,setFieldTouched:P,setFieldValue:v}=A;return e.jsx(e.Fragment,{children:p&&e.jsx(J,{open:p,handleClose:d,maxWidth:700,children:e.jsx(Q,{value:A,children:e.jsx(X,{dateAdapter:Y,children:e.jsxs(Z,{autoComplete:"off",noValidate:!0,onSubmit:F,children:[e.jsx($,{children:a?t.formatMessage({id:"services.editServiceTitle"}):t.formatMessage({id:"services.addServiceTitle"})}),e.jsx(R,{}),e.jsx(ee,{sx:{p:2.5},children:e.jsx(m,{container:!0,spacing:3,children:e.jsx(m,{item:!0,xs:12,md:12,children:e.jsxs(m,{container:!0,spacing:3,children:[e.jsxs(m,{item:!0,xs:12,sm:6,children:[e.jsxs(c,{spacing:1,children:[e.jsx(w,{htmlFor:"name_en",children:t.formatMessage({id:"services.serviceNameEn"})}),e.jsx(L,{fullWidth:!0,id:"name_en",placeholder:t.formatMessage({id:"services.serviceNameEn"}),...f("name_en"),error:!!(u.name_en&&i.name_en)})]}),u.name_en&&i.name_en&&e.jsx(k,{error:!0,id:"helper-name_en",children:i==null?void 0:i.name_en})]}),e.jsxs(m,{item:!0,xs:12,sm:6,children:[e.jsxs(c,{spacing:1,children:[e.jsx(w,{htmlFor:"name_ar",children:t.formatMessage({id:"services.serviceNameAr"})}),e.jsx(L,{fullWidth:!0,id:"name_ar",placeholder:t.formatMessage({id:"services.serviceNameAr"}),...f("name_ar"),error:!!(u.name_ar&&i.name_ar)})]}),u.name_ar&&i.name_ar&&e.jsx(k,{error:!0,id:"helper-name_ar",children:i==null?void 0:i.name_ar})]}),e.jsxs(m,{item:!0,xs:12,sm:6,children:[e.jsxs(c,{spacing:1,children:[e.jsx(w,{htmlFor:"consultant_duration",children:t.formatMessage({id:"services.serviceStatus"})}),e.jsx(se,{fullWidth:!0,children:e.jsxs(ae,{id:"status",displayEmpty:!0,value:T.status,onChange:r=>v("status",r.target.value),children:[e.jsx(_,{value:"",children:e.jsx("em",{children:t.formatMessage({id:"common.none"})})}),j==null?void 0:j.map(r=>e.jsx(_,{value:r.value,children:r.label[I]},r.value))]})})]}),u.status&&i.status&&e.jsx(k,{error:!0,id:"helper-status",children:i==null?void 0:i.status})]})]})})})}),e.jsx(R,{}),e.jsx(te,{sx:{p:2.5},children:e.jsx(m,{container:!0,justifyContent:"right",alignItems:"center",children:e.jsx(m,{item:!0,children:e.jsxs(c,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(V,{color:"error",onClick:d,children:t.formatMessage({id:"common.cancel"})}),e.jsx(ne,{type:"submit",loading:C,loadingIndicator:t.formatMessage({id:"common.processing"}),variant:"contained",children:a?t.formatMessage({id:"services.editServiceTitle"}):t.formatMessage({id:"services.addServiceTitle"})})]})})})})]})})})})})}function Te(a){return[{title:a.formatMessage({id:"sidebar.home"}),to:je},{title:a.formatMessage({id:"sidebar.allServices"})}]}function Ve(){const{lang:a}=N(),{data:x,error:p,isLoading:d,url:t,setSorting:j,setPagination:I}=Me(),n=O(),A=re(),i=ie(A.breakpoints.down("sm")),[u,F]=l.useState(""),[C,f]=l.useState(!1),[T,P]=l.useState(null),[v,r]=l.useState(0),[h,o]=l.useState(0),E=l.useCallback(async()=>{try{await D(v,{status:b.Active},t).then(s=>{y(n.formatMessage({id:"services.activate.success"})),r(0)})}catch{r(0)}},[v,t,n]),W=l.useCallback(async()=>{try{await D(h,{status:b.InActive},t).then(s=>{y(n.formatMessage({id:"services.deactivate.success"})),o(0)})}catch{o(0)}},[h,t,n]),z=l.useMemo(()=>[{header:n.formatMessage({id:"common.service"}),accessorKey:"name",enableSorting:!1,cell:({row:s})=>e.jsxs(c,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(oe,{alt:"Avatar 1",size:"sm",src:s.original.photo}),e.jsx(c,{spacing:0,children:e.jsx(M,{variant:"subtitle1",children:s.original.name[a]})})]})},{header:n.formatMessage({id:"services.medicalCenters"}),accessorKey:"medical_centers_count",cell:({row:s})=>s.original.actual_medical_centers_count},{header:n.formatMessage({id:"common.visits"}),accessorKey:"visits_count",disableSortBy:!0,cell:({row:s})=>s.original.visits_count},{header:n.formatMessage({id:"common.status"}),accessorKey:"status",cell:({row:s})=>e.jsx(ce,{status:s.original.status,referenceKey:U.SERVICES_STATUS})},{header:n.formatMessage({id:"common.createdOn"}),accessorKey:"created_at",cell:({row:s})=>{var S;return fe((S=s.original)==null?void 0:S.created_at).format(le)}},{header:n.formatMessage({id:"common.actions"}),accessorKey:"Actions",meta:{className:"cell-center"},enableSorting:!1,cell:({row:s})=>{const[S,B]=l.useState(null),G=!!S,H=g=>{B(g.currentTarget)},K=()=>{B(null)};return e.jsxs(e.Fragment,{children:[e.jsx(de,{onClick:H,children:e.jsx(me,{})}),e.jsxs(ue,{anchorEl:S,open:G,onClose:K,onClick:K,children:[e.jsx(_,{onClick:g=>{g.stopPropagation(),f(!0),P(s.original)},children:e.jsx(M,{variant:"body1",children:n.formatMessage({id:"services.editServiceInfo"})})}),s.original.status===b.Active&&e.jsx(_,{onClick:g=>{g.stopPropagation(),o(s.original.id)},children:e.jsx(M,{variant:"body1",children:n.formatMessage({id:"services.deactivate.action"})})}),s.original.status===b.InActive&&e.jsx(_,{onClick:g=>{g.stopPropagation(),r(s.original.id)},children:e.jsx(M,{variant:"body1",children:n.formatMessage({id:"services.activate.action"})})})]})]})}}],[]);return e.jsxs(e.Fragment,{children:[e.jsx(he,{custom:!0,links:Te(n)}),e.jsx(c,{direction:"row",marginBottom:"20px",spacing:2,justifyContent:"space-between",alignItems:"center",children:e.jsx(M,{variant:"h2",children:n.formatMessage({id:"sidebar.allServices"})})}),e.jsx(ge,{data:x,columns:z,isLoading:d,setPagination:s=>{I(s)},setSortingParams:s=>{j(s)},children:e.jsx(xe,{content:!1,children:e.jsxs(c,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",justifyContent:"space-between",sx:{padding:2,...i&&{"& .MuiOutlinedInput-root, & .MuiFormControl-root":{width:"100%"}}},children:[e.jsx(pe,{sx:{width:{xs:"70%",md:"70%"}},children:e.jsx(c,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(ve,{value:u,onFilterChange:s=>F(s),placeholder:n.formatMessage({id:"services.searchServices"})})})}),e.jsx(c,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",sx:{width:{xs:"100%",sm:"auto"}},children:e.jsx(c,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(V,{variant:"outlined",startIcon:e.jsx(ye,{}),children:n.formatMessage({id:"common.export"})})})})]})})}),C&&e.jsx(Fe,{open:C,handleClose:()=>{f(!1)},url:t,service:T}),e.jsx(Ce,{open:!!h,handleSubmit:W,handleClose:()=>{o(0)}}),e.jsx(be,{open:!!v,handleSubmit:E,handleClose:()=>{r(0)}})]})}export{Ve as default};
