import{aH as Ne,r as q,aI as V,a as ke,az as Fe,W as Be,u as Me,j as s,aA as Te,Y as Ve,Z as ve,c as ye,G as w,S as se,I as ge,aB as F,aC as we,N as Le,aJ as We,m as oe,aK as $e,B as qe,T as L,q as ze,ax as Ke}from"./index-DSO9TgYq.js";import{A as Ue,a as Ge}from"./AnimateButton-C_cTvbpU.js";import{E as He}from"./EyeOutlined-ChV9zO9W.js";import{E as Ze}from"./EyeInvisibleOutlined-CaFaFVHk.js";import{B as Je}from"./Box-D442Dag1.js";var be={};(function(l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;var c=z(q),B=["placeholder","separator","isLastChild","ariaLabelOverride","shouldRender","inputStyle","focus","isDisabled","hasErrored","errorStyle","isSuccessed","successStyle","focusStyle","disabledStyle","shouldAutoFocus","isInputNum","index","value","className","isInputSecure","onSubmit"];function A(t){if(typeof WeakMap!="function")return null;var a=new WeakMap,i=new WeakMap;return(A=function(n){return n?i:a})(t)}function z(t,a){if(!a&&t&&t.__esModule)return t;if(t===null||S(t)!=="object"&&typeof t!="function")return{default:t};var i=A(a);if(i&&i.has(t))return i.get(t);var e={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in t)if(u!=="default"&&Object.prototype.hasOwnProperty.call(t,u)){var d=n?Object.getOwnPropertyDescriptor(t,u):null;d&&(d.get||d.set)?Object.defineProperty(e,u,d):e[u]=t[u]}return e.default=t,i&&i.set(t,e),e}function O(){return O=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var i=arguments[a];for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e])}return t},O.apply(this,arguments)}function j(t,a){if(t==null)return{};var i=K(t,a),e,n;if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(t);for(n=0;n<u.length;n++)e=u[n],!(a.indexOf(e)>=0)&&Object.prototype.propertyIsEnumerable.call(t,e)&&(i[e]=t[e])}return i}function K(t,a){if(t==null)return{};var i={},e=Object.keys(t),n,u;for(u=0;u<e.length;u++)n=e[u],!(a.indexOf(n)>=0)&&(i[n]=t[n]);return i}function D(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function U(t,a){for(var i=0;i<a.length;i++){var e=a[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function M(t,a,i){return a&&U(t.prototype,a),i&&U(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function G(t,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(a&&a.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),a&&W(t,a)}function W(t,a){return W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},W(t,a)}function H(t){var a=m();return function(){var e=v(t),n;if(a){var u=v(this).constructor;n=Reflect.construct(e,arguments,u)}else n=e.apply(this,arguments);return Y(this,n)}}function Y(t,a){if(a&&(S(a)==="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return f(t)}function f(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(t){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},v(t)}function p(t,a,i){return a in t?Object.defineProperty(t,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[a]=i,t}function S(t){"@babel/helpers - typeof";return S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},S(t)}var E=8,R=37,Z=39,T=46,xe=32,Ie=13,N=function(a){return S(a)==="object"},Se=function(t){G(i,t);var a=H(i);function i(e){var n;return D(this,i),n=a.call(this,e),p(f(n),"getClasses",function(){for(var u=arguments.length,d=new Array(u),r=0;r<u;r++)d[r]=arguments[r];return d.filter(function(o){return!N(o)&&o!==!1}).join(" ")}),p(f(n),"getType",function(){var u=n.props,d=u.isInputSecure,r=u.isInputNum;return d?"password":r?"tel":"text"}),p(f(n),"getAriaLabel",function(u,d){var r=n.props.ariaLabelOverride;return r||"".concat(u===0?"Please enter verification code. ":"").concat(d?"Digit":"Character"," ").concat(u+1)}),n.input=c.default.createRef(),n}return M(i,[{key:"componentDidMount",value:function(){var n=this.props,u=n.focus,d=n.shouldAutoFocus,r=this.input.current;r&&u&&d&&r.focus()}},{key:"componentDidUpdate",value:function(n){var u=this.props.focus,d=this.input.current;n.focus!==u&&d&&u&&(d.focus(),d.select())}},{key:"render",value:function(){var n=this.props,u=n.placeholder,d=n.separator,r=n.isLastChild;n.ariaLabelOverride;var o=n.shouldRender,h=n.inputStyle,b=n.focus,P=n.isDisabled,x=n.hasErrored,y=n.errorStyle,I=n.isSuccessed,_=n.successStyle,k=n.focusStyle,C=n.disabledStyle;n.shouldAutoFocus;var Q=n.isInputNum,X=n.index,J=n.value,ee=n.className;n.isInputSecure,n.onSubmit;var te=j(n,B);return c.default.createElement("div",{className:ee,style:{display:"flex",alignItems:"center"}},c.default.createElement("input",O({"aria-label":this.getAriaLabel(X,Q),style:Object.assign({width:"1em",textAlign:"center",padding:0},N(h)&&h,b&&N(k)&&k,P&&N(C)&&C,x&&!I&&N(y)&&y,I&&!x&&N(_)&&_),placeholder:u,className:this.getClasses(h,b&&k,P&&C,x&&!I&&y,I&&!x&&_),type:this.getType(),ref:this.input,disabled:P,value:J||""},te)),!r&&o&&d)}}]),i}(c.PureComponent),ie=function(t){G(i,t);var a=H(i);function i(){var e;D(this,i);for(var n=arguments.length,u=new Array(n),d=0;d<n;d++)u[d]=arguments[d];return e=a.call.apply(a,[this].concat(u)),p(f(e),"state",{activeInput:0}),p(f(e),"getOtpValue",function(){return e.props.value?e.props.value.toString().split(""):[]}),p(f(e),"getPlaceholderValue",function(){var r=e.props,o=r.placeholder,h=r.numInputs;if(typeof o=="string"){if(o.length===h)return o;o.length>0&&console.error("Length of the placeholder should be equal to the number of inputs.")}}),p(f(e),"handleOtpChange",function(r){var o=e.props.onChange,h=r.join("");o(h)}),p(f(e),"isInputValueValid",function(r){var o=e.props.isInputNum?!isNaN(parseInt(r,10)):typeof r=="string";return o&&r.trim().length===1}),p(f(e),"focusInput",function(r){var o=e.props.numInputs,h=Math.max(Math.min(o-1,r),0);e.setState({activeInput:h})}),p(f(e),"focusNextInput",function(){var r=e.state.activeInput;e.focusInput(r+1)}),p(f(e),"focusPrevInput",function(){var r=e.state.activeInput;e.focusInput(r-1)}),p(f(e),"changeCodeAtFocus",function(r){var o=e.state.activeInput,h=e.getOtpValue();h[o]=r[0],e.handleOtpChange(h)}),p(f(e),"handleOnPaste",function(r){r.preventDefault();var o=e.state.activeInput,h=e.props,b=h.numInputs,P=h.isDisabled;if(!P){for(var x=e.getOtpValue(),y=o,I=r.clipboardData.getData("text/plain"),_=e.props.isInputNum?I.replace(/\D/g,""):I,k=_.slice(0,b-o).split(""),C=0;C<b;++C)C>=o&&k.length>0&&(x[C]=k.shift(),y++);e.setState({activeInput:y},function(){e.focusInput(y),e.handleOtpChange(x)})}}),p(f(e),"handleOnChange",function(r){var o=r.target.value;e.isInputValueValid(o)&&e.changeCodeAtFocus(o)}),p(f(e),"handleOnKeyDown",function(r){r.keyCode===E||r.key==="Backspace"?(r.preventDefault(),e.changeCodeAtFocus(""),e.focusInput(e.state.activeInput-1)):r.keyCode===T||r.key==="Delete"?(r.preventDefault(),e.changeCodeAtFocus("")):r.keyCode===R||r.key==="ArrowLeft"?(r.preventDefault(),e.focusPrevInput()):r.keyCode===Z||r.key==="ArrowRight"?(r.preventDefault(),e.focusNextInput()):r.keyCode===xe||r.key===" "||r.key==="Spacebar"||r.key==="Space"?r.preventDefault():(r.keyCode===Ie||r.key==="Enter")&&e.props.onSubmit()}),p(f(e),"handleOnInput",function(r){var o=r.target.value;if(r.target.value){if(r.target.value&&r.target.value.length>1){r.preventDefault();for(var h=e.props.numInputs,b=e.state.activeInput,P=e.getOtpValue(),x=r.target.value.slice(0,h-b).split(""),y=0;y<h;++y)y>=b&&x.length>0&&(P[y]=x.shift());e.handleOtpChange(P),e.focusInput(e.props.numInputs)}else if(o&&o.trim().length>1)r.clipboardData={getData:function(){return o.trim()}},e.handleOnPaste(r);else if(e.isInputValueValid(r.target.value))e.focusNextInput();else if(!e.props.isInputNum){var I=r.nativeEvent;I.data===null&&I.inputType==="deleteContentBackward"&&(r.preventDefault(),e.changeCodeAtFocus(""),e.focusPrevInput())}}}),p(f(e),"renderInputs",function(){for(var r=e.state.activeInput,o=e.props,h=o.id,b=o.autoComplete,P=o.numInputs,x=o.inputStyle,y=o.focusStyle,I=o.separator,_=o.separateAfter,k=_===void 0?1:_,C=o.isDisabled,Q=o.disabledStyle,X=o.hasErrored,J=o.errorStyle,ee=o.isSuccessed,te=o.successStyle,Oe=o.shouldAutoFocus,je=o.isInputNum,Ce=o.isInputSecure,De=o.className,$=o.inputProps,_e=o.onSubmit,ue=[],le=e.getOtpValue(),ce=e.getPlaceholderValue(),pe=e.props["data-cy"],de=e.props["data-testid"],fe=e.props["custom-test-attr"],he=e.props["custom-test-id"],Ae=function(g){var ne=void 0;(g+1)%parseInt(k)===0?ne=!0:ne=!1;var me={};fe&&(me[fe]=he&&"".concat(he,"-").concat(g));var ae={};$&&(Array.isArray($)?$[g]&&(ae=$[g]):ae=$),ue.push(c.default.createElement(Se,O({id:h&&"".concat(h,"-").concat(g),autoComplete:b??"off",placeholder:ce&&ce[g],key:g,index:g,focus:r===g,value:le&&le[g],onChange:e.handleOnChange,onKeyDown:e.handleOnKeyDown,onInput:e.handleOnInput,onPaste:e.handleOnPaste,onFocus:function(Re){e.setState({activeInput:g}),Re.target.select()},onBlur:function(){return e.setState({activeInput:-1})},separator:I,inputStyle:x,focusStyle:y,isLastChild:g===P-1,isDisabled:C,disabledStyle:Q,hasErrored:X,errorStyle:J,isSuccessed:ee,successStyle:te,shouldAutoFocus:Oe,isInputNum:je,isInputSecure:Ce,className:De,"data-cy":pe&&"".concat(pe,"-").concat(g),"data-testid":de&&"".concat(de,"-").concat(g),shouldRender:ne,onSubmit:_e},ae,me)))},re=0;re<P;re++)Ae(re);return ue}),e}return M(i,[{key:"componentDidUpdate",value:function(){var n=this.props.value,u=this.state.activeInput;n==""&&u>0&&this.setState({activeInput:0})}},{key:"render",value:function(){var n=this.props.containerStyle;return c.default.createElement("div",{style:Object.assign({display:"flex"},N(n)&&n),className:N(n)?"":n},this.renderInputs())}}]),i}(c.Component);p(ie,"defaultProps",{numInputs:4,onChange:function(a){return console.log(a)},isDisabled:!1,shouldAutoFocus:!1,value:"",isInputSecure:!1,onSubmit:function(a){return console.log(a)}});var Pe=ie;l.default=Pe})(be);const Ye=Ne(be),Qe=l=>new RegExp(/[0-9]/).test(l),Xe=l=>new RegExp(/[a-z]/).test(l)&&new RegExp(/[A-Z]/).test(l),et=l=>new RegExp(/[!#@$%^&*)(+=._-]/).test(l),tt=(l,c)=>c<2?{label:V(l,"auth.resetPasword.poor"),color:"error.main"}:c<3?{label:V(l,"auth.resetPasword.weak"),color:"warning.main"}:c<4?{label:V(l,"auth.resetPasword.normal"),color:"warning.dark"}:c<5?{label:V(l,"auth.resetPasword.good"),color:"success.main"}:c<6?{label:V(l,"auth.resetPasword.strong"),color:"success.dark"}:{label:V(l,"auth.resetPasword.poor"),color:"error.main"},rt=l=>{let c=0;return l.length>5&&(c+=1),l.length>7&&(c+=1),Qe(l)&&(c+=1),et(l)&&(c+=1),Xe(l)&&(c+=1),c};function nt(){const l=ke(),{resetPassword:c,forgotPassword:B}=Fe(),[A,z]=q.useState(),O=Be(),j=Me(),K=localStorage.getItem("email"),[D,U]=q.useState(),[M,G]=q.useState(!1),W=()=>{G(!M)},H=async()=>{await B(K).then(()=>{ye(j.formatMessage({id:"auth.resetPasword.resendSuccess"}))})},Y=m=>{m.preventDefault()},f=m=>{const v=rt(m);U(tt(j,v))};return q.useEffect(()=>{f("")},[]),s.jsx(Te,{initialValues:{password:"",confirmPassword:"",submit:null},validationSchema:Ve().shape({password:ve().max(255).required(j.formatMessage({id:"auth.resetPasword.validation.password.required"})),confirmPassword:ve().required(j.formatMessage({id:"auth.resetPasword.validation.confirmPassword.required"})).test("confirmPassword",j.formatMessage({id:"auth.resetPasword.validation.confirmPassword.required"}),(m,v)=>v.parent.password===m)}),onSubmit:async(m,{setErrors:v,setStatus:p,setSubmitting:S})=>{try{if(!A)return;const E={otp_code:A,password:m.password,email:K};await c(E).then(()=>{p({success:!0}),S(!1),ye(j.formatMessage({id:"common.changePassword.resetPasswordSuccess"})),O("/login")},R=>{p({success:!1}),v({submit:R.message}),S(!1)})}catch(E){console.error(E),p({success:!1}),v({submit:E.message}),S(!1)}},children:({errors:m,handleBlur:v,handleChange:p,handleSubmit:S,isSubmitting:E,touched:R,values:Z})=>s.jsx("form",{noValidate:!0,onSubmit:S,children:s.jsxs(w,{container:!0,spacing:3,children:[s.jsx(w,{item:!0,xs:12,children:s.jsx(Ye,{value:A,onChange:T=>z(T),numInputs:4,containerStyle:{justifyContent:"space-between"},inputStyle:{width:"100%",margin:"8px",padding:"10px",border:"1px solid",borderColor:l.palette.divider,borderRadius:4,":hover":{borderColor:l.palette.primary.main}},focusStyle:{outline:"none",boxShadow:l.customShadows.primary,border:"1px solid",borderColor:l.palette.primary.main}})}),s.jsxs(w,{item:!0,xs:12,children:[s.jsxs(se,{spacing:1,children:[s.jsx(ge,{htmlFor:"password-reset",children:s.jsx(F,{id:"common.changePassword.newPassword"})}),s.jsx(we,{fullWidth:!0,error:!!(R.password&&m.password),id:"password-reset",type:M?"text":"password",value:Z.password,name:"password",onBlur:v,onChange:T=>{p(T),f(T.target.value)},endAdornment:s.jsx(Le,{position:"end",children:s.jsx(We,{"aria-label":"toggle password visibility",onClick:W,onMouseDown:Y,edge:"end",color:"secondary",children:M?s.jsx(He,{}):s.jsx(Ze,{})})}),placeholder:j.formatMessage({id:"common.changePassword.newPassword"})})]}),R.password&&m.password&&s.jsx(oe,{error:!0,id:"helper-text-password-reset",children:m.password}),s.jsx($e,{fullWidth:!0,sx:{mt:2},children:s.jsxs(w,{container:!0,spacing:2,alignItems:"center",children:[s.jsx(w,{item:!0,children:s.jsx(qe,{sx:{bgcolor:D==null?void 0:D.color,width:85,height:8,borderRadius:"7px"}})}),s.jsx(w,{item:!0,children:s.jsx(L,{variant:"subtitle1",fontSize:"0.75rem",children:D==null?void 0:D.label})})]})})]}),s.jsxs(w,{item:!0,xs:12,children:[s.jsxs(se,{spacing:1,children:[s.jsx(ge,{htmlFor:"confirm-password-reset",children:s.jsx(F,{id:"common.changePassword.confirmPassword"})}),s.jsx(we,{fullWidth:!0,error:!!(R.confirmPassword&&m.confirmPassword),id:"confirm-password-reset",type:"password",value:Z.confirmPassword,name:"confirmPassword",onBlur:v,onChange:p,placeholder:j.formatMessage({id:"common.changePassword.confirmPassword"})})]}),R.confirmPassword&&m.confirmPassword&&s.jsx(oe,{error:!0,id:"helper-text-confirm-password-reset",children:m.confirmPassword})]}),m.submit&&s.jsx(w,{item:!0,xs:12,children:s.jsx(oe,{error:!0,children:m.submit})}),s.jsx(w,{item:!0,xs:12,children:s.jsx(Ue,{children:s.jsx(ze,{disableElevation:!0,disabled:E,fullWidth:!0,size:"large",type:"submit",variant:"contained",children:s.jsx(F,{id:"auth.resetPasword.title"})})})}),s.jsx(w,{item:!0,xs:12,children:s.jsxs(se,{direction:"column",justifyContent:"space-between",alignItems:"baseline",children:[s.jsx(L,{children:s.jsx(F,{id:"auth.resetPasword.resendTitle"})}),s.jsx(L,{onClick:()=>H(),variant:"body1",sx:{minWidth:85,ml:2,textDecoration:"none",cursor:"pointer"},color:"primary",children:s.jsx(F,{id:"auth.resetPasword.resendCode"})})]})})]})})})}function ct(){let l=window.localStorage.getItem("email"),c=[];if(l){let B=l.split(""),A=B.indexOf("@");B.forEach((z,O)=>{O>=1&&O<=A-2?c.push("*"):c.push(B[O])})}return s.jsx(Ge,{children:s.jsxs(w,{container:!0,spacing:3,children:[s.jsxs(w,{item:!0,xs:12,children:[s.jsx(Je,{display:"flex",justifyContent:"right",marginBottom:"10px",children:s.jsx(L,{component:Ke,to:"/login",variant:"body1",sx:{textDecoration:"none"},color:"primary",children:s.jsx(F,{id:"auth.resetPasword.back"})})}),s.jsx(L,{variant:"h3",children:s.jsx(F,{id:"auth.resetPasword.title"})})]}),s.jsx(w,{item:!0,xs:12,children:s.jsxs(L,{children:[s.jsx(F,{id:"auth.resetPasword.subtitle"})," ",l&&c.length>0?c.join(""):"****@company.com"]})}),s.jsx(w,{item:!0,xs:12,children:s.jsx(nt,{})})]})})}export{ct as default};
