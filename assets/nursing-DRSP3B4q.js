import{a as Q,u as $,t as X,r as c,g as re,b as oe,bK as Y,c as k,j as e,C as ce,F as de,L as le,A as me,d as ue,D as he,e as q,f as ge,G as u,S as d,h as pe,i as Z,B as ee,k as xe,T as v,l as I,m as _,I as A,aK as je,b0 as fe,H as F,p as _e,q as G,s as ve,x as se,v as Se,w as O,R as Me,y as ye,z as Ce,M as be,E as Ie,J as Ae,K as Fe,aL as Te,U as Be}from"./index-DSO9TgYq.js";import{d as Ee}from"./dayjs.min-pRfd56nx.js";import{D as Pe}from"./DebouncedInput-DhmfX_1V.js";import{u as we}from"./useFilterAndSearch-PJD0Zg8P.js";import{C as J}from"./CustomTypography-CRnDvUFn.js";import{D as ke}from"./DeleteConfirmation-BqFOMagf.js";import{u as z,a as De,b as Ne,d as Re}from"./sub-services-Cm3yL5Hw.js";import{C as Ke}from"./CameraOutlined-D4Mj0cXe.js";import{u as Oe}from"./useStatusList-Dbp-x5Xm.js";import{d as Le}from"./services-BGkrpTaC.js";import{D as Ue,A as Ve}from"./ActivateServiceConfirmation-DBGR9riN.js";import{f as We}from"./services-DCcxZZqT.js";import{P as Ge}from"./PlusOutlined-BQvVSxI0.js";import{A as ze}from"./ArrowUpOutlined-C9GTlrEN.js";import"./CloseOutlined-DRBnXhIJ.js";import"./ConfirmationDialog-DR_Ho8RD.js";import"./Dialog-CPoUMqzk.js";const He=t=>{var S,f;const l={name_en:"",name_ar:"",min_visit_price:"",min_service_price:"",discount:"",status:1,image:""};return t?{name_en:(S=t==null?void 0:t.name)==null?void 0:S.en,name_ar:(f=t==null?void 0:t.name)==null?void 0:f.ar,min_visit_price:Number(t==null?void 0:t.min_visit_price),min_service_price:Number(t==null?void 0:t.min_service_price),discount:Number(t==null?void 0:t.discount),status:t==null?void 0:t.status,image:t==null?void 0:t.image}:l};function qe({serviceId:t,subService:l,url:S,open:f,handleClose:M}){const D=Q(),a=$(),{defaultList:h}=Oe(se.PACKAGE_STATUS),{lang:n}=X(),[y,N]=c.useState(void 0),[T,L]=c.useState(`${l&&(l!=null&&l.image)?l.image:""}`);c.useEffect(()=>{y&&(L(URL.createObjectURL(y)),re(y,r=>{R("image",r)}))},[y]);const U=c.useMemo(()=>He(l),[]),B=oe({initialValues:U,validationSchema:Le(a),enableReinitialize:!0,onSubmit:async(r,{setSubmitting:j})=>{try{let m={...r,service_type:Y.NURSING,service_id:t,name:{en:r==null?void 0:r.name_en,ar:r==null?void 0:r.name_ar}};(m.discount===""||m.discount===null||m.discount===void 0)&&(m.discount=0),m.image.includes("http")&&delete m.image,delete m.name_en,delete m.name_ar,l?await z(l.id,m,S).then(W=>{k(a.formatMessage({id:"services.nursing.editSuccess"})),j(!1),M()}):await De(m,S).then(W=>{k(a.formatMessage({id:"services.nursing.addSuccess"})),j(!1),M()})}catch(m){console.error(m),j(!1)}}}),{errors:s,touched:o,handleSubmit:E,isSubmitting:C,getFieldProps:g,values:b,setFieldTouched:V,setFieldValue:R}=B;return e.jsx(e.Fragment,{children:f&&e.jsx(ce,{open:f,handleClose:M,children:e.jsx(de,{value:B,children:e.jsx(le,{dateAdapter:me,children:e.jsxs(ue,{autoComplete:"off",noValidate:!0,onSubmit:E,children:[e.jsx(he,{children:l?a.formatMessage({id:"services.nursing.editServiceTitle"}):a.formatMessage({id:"services.nursing.addServiceTitle"})}),e.jsx(q,{}),e.jsx(ge,{sx:{p:2.5},children:e.jsxs(u,{container:!0,spacing:3,children:[e.jsxs(u,{item:!0,xs:12,md:3,children:[e.jsxs(d,{direction:"row",justifyContent:"center",sx:{mt:3},children:[e.jsxs(pe,{htmlFor:"change-avtar",sx:{position:"relative",borderRadius:"50%",overflow:"hidden","&:hover .MuiBox-root":{opacity:1},cursor:"pointer"},children:[e.jsx(Z,{alt:"Avatar 1",src:T,sx:{width:72,height:72,border:"1px dashed"}}),e.jsx(ee,{sx:{position:"absolute",top:0,left:0,background:D.palette.mode===xe.DARK?"rgba(255, 255, 255, .75)":"rgba(0,0,0,.65)",width:"100%",height:"100%",opacity:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(d,{spacing:.5,alignItems:"center",children:[e.jsx(Ke,{style:{color:D.palette.secondary.lighter,fontSize:"2rem"}}),e.jsx(v,{sx:{color:"secondary.lighter"},children:a.formatMessage({id:"common.upload"})})]})})]}),e.jsx(I,{type:"file",id:"change-avtar",placeholder:"Outlined",variant:"outlined",inputProps:{accept:"image/*"},sx:{display:"none"},onChange:r=>{var j;V("image",!0),N((j=r.target.files)==null?void 0:j[0])}})]}),e.jsx(d,{direction:"row",justifyContent:"center",children:o.image&&s.image&&e.jsx(_,{error:!0,id:"helper-image",children:s==null?void 0:s.image})})]}),e.jsx(u,{item:!0,xs:12,md:8,children:e.jsxs(u,{container:!0,spacing:3,children:[e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(A,{htmlFor:"name_en",children:a.formatMessage({id:"services.nursing.serviceNameEn"})}),e.jsx(I,{fullWidth:!0,id:"name_en",placeholder:a.formatMessage({id:"services.nursing.serviceNameEn"}),...g("name_en"),error:!!(o.name_en&&s.name_en)})]}),o.name_en&&s.name_en&&e.jsx(_,{error:!0,id:"helper-name_en",children:s==null?void 0:s.name_en})]}),e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(A,{htmlFor:"name_ar",children:a.formatMessage({id:"services.nursing.serviceNameAr"})}),e.jsx(I,{fullWidth:!0,id:"name_ar",placeholder:a.formatMessage({id:"services.nursing.serviceNameAr"}),...g("name_ar"),error:!!(o.name_ar&&s.name_ar)})]}),o.name_ar&&s.name_ar&&e.jsx(_,{error:!0,id:"helper-name_ar",children:s==null?void 0:s.name_ar})]}),e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(A,{htmlFor:"min_visit_price",children:a.formatMessage({id:"services.minVisitPrice"})}),e.jsx(I,{type:"number",fullWidth:!0,id:"min_visit_price",placeholder:a.formatMessage({id:"services.minVisitPrice"}),...g("min_visit_price"),error:!!(o.min_visit_price&&s.min_visit_price)})]}),o.min_visit_price&&s.min_visit_price&&e.jsx(_,{error:!0,id:"helper-min_visit_price",children:s==null?void 0:s.min_visit_price})]}),e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(A,{htmlFor:"min_service_price",children:a.formatMessage({id:"services.nursing.minServicePrice"})}),e.jsx(I,{type:"number",fullWidth:!0,id:"min_service_price",placeholder:a.formatMessage({id:"services.nursing.minServicePrice"}),...g("min_service_price"),error:!!(o.min_service_price&&s.min_service_price)})]}),o.min_service_price&&s.min_service_price&&e.jsx(_,{error:!0,id:"helper-min_service_price",children:s==null?void 0:s.min_service_price})]}),e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(A,{htmlFor:"discount",children:a.formatMessage({id:"services.discount"})}),e.jsx(I,{type:"number",fullWidth:!0,id:"discount",placeholder:a.formatMessage({id:"services.discount"}),...g("discount"),error:!!(o.discount&&s.discount)})]}),o.discount&&s.discount&&e.jsx(_,{error:!0,id:"helper-discount",children:s==null?void 0:s.discount})]}),e.jsxs(u,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(A,{htmlFor:"status",children:a.formatMessage({id:"services.nursing.serviceStatus"})}),e.jsx(je,{fullWidth:!0,children:e.jsxs(fe,{id:"status",displayEmpty:!0,value:b.status,onChange:r=>R("status",r.target.value),children:[e.jsx(F,{value:"",children:e.jsx("em",{children:a.formatMessage({id:"common.none"})})}),h==null?void 0:h.map(r=>e.jsx(F,{value:r.value,children:r.label[n]},r.value))]})})]}),o.status&&s.status&&e.jsx(_,{error:!0,id:"helper-status",children:s==null?void 0:s.status})]})]})})]})}),e.jsx(q,{}),e.jsx(_e,{sx:{p:2.5},children:e.jsx(u,{container:!0,justifyContent:"right",alignItems:"center",children:e.jsx(u,{item:!0,children:e.jsxs(d,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(G,{color:"error",onClick:M,children:a.formatMessage({id:"common.cancel"})}),e.jsx(ve,{type:"submit",loading:C,loadingIndicator:a.formatMessage({id:"common.processing"}),variant:"contained",children:l?a.formatMessage({id:"services.nursing.editServiceTitle"}):a.formatMessage({id:"services.nursing.addSubmitButton"})})]})})})})]})})})})})}function Je(t){return[{title:t.formatMessage({id:"sidebar.home"}),to:Be},{title:t.formatMessage({id:"services.nursing.title"})}]}function us(){const{lang:t}=X(),{data:l,error:S,isLoading:f,setSorting:M,setFilterCriteria:D,setPagination:a,url:h}=Ne(Y.NURSING),n=$(),y=Q(),[N,T]=c.useState(!1),L=Se(y.breakpoints.down("sm")),[U,B]=c.useState(null),[s,o]=c.useState(0),[E,C]=c.useState(0),[g,b]=c.useState(0),[V,R]=c.useState(),{filter:r,search:j,setSearch:m}=we(),W=()=>{B(null),T(!0)},ie=c.useCallback(async()=>{try{await Re(s,h).then(i=>{k(n.formatMessage({id:"services.deletServiceSuccess"})),o(0)})}catch{o(0)}},[s,h,n]),te=c.useCallback(async()=>{try{await z(E,{status:O.Active},h).then(i=>{k(n.formatMessage({id:"services.activate.success"})),C(0)})}catch{C(0)}},[E,h,n]),ae=c.useCallback(async()=>{try{await z(g,{status:O.InActive},h).then(i=>{k(n.formatMessage({id:"services.deactivate.success"})),b(0)})}catch{b(0)}},[g,h,n]);c.useEffect(()=>{D(r)},[r]);const ne=c.useMemo(()=>[{header:n.formatMessage({id:"services.serviceName"}),accessorKey:"name",enableSorting:!1,cell:({row:i})=>e.jsxs(d,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(Z,{alt:"Avatar 1",size:"sm",src:i.original.image}),e.jsx(d,{spacing:0,children:e.jsx(v,{variant:"subtitle1",children:i.original.name[t]})})]})},{header:n.formatMessage({id:"services.medicalCenters"}),accessorKey:"medical_centers_count",cell:({row:i})=>e.jsx(J,{className:"typography-inline",value:i.original.hospitals_count})},{header:n.formatMessage({id:"common.visits"}),accessorKey:"visits_count",disableSortBy:!0,cell:({row:i})=>e.jsx(J,{className:"typography-inline",value:i.original.visits_count})},{header:n.formatMessage({id:"common.status"}),accessorKey:"status",cell:({row:i})=>e.jsx(Me,{status:i.original.status,referenceKey:se.SERVICES_STATUS})},{header:n.formatMessage({id:"common.createdOn"}),accessorKey:"created_at",cell:({row:i})=>{var p;return Ee((p=i.original)==null?void 0:p.created_at).format(ye)}},{header:n.formatMessage({id:"common.actions"}),accessorKey:"Actions",meta:{className:"cell-center"},enableSorting:!1,cell:({row:i})=>{const[p,P]=c.useState(null),K=!!p,w=x=>{P(x.currentTarget)},H=()=>{P(null)};return e.jsxs(e.Fragment,{children:[e.jsx(Ce,{onClick:w,children:e.jsx(be,{})}),e.jsxs(Ie,{anchorEl:p,open:K,onClose:H,onClick:H,children:[e.jsx(F,{onClick:x=>{x.stopPropagation(),T(!0),B(i.original)},children:e.jsx(v,{variant:"body1",children:n.formatMessage({id:"services.nursing.editServiceTitle"})})}),i.original.status===O.Active&&e.jsx(F,{onClick:x=>{x.stopPropagation(),b(i.original.id)},children:e.jsx(v,{variant:"body1",children:n.formatMessage({id:"services.deactivate.action"})})}),i.original.status===O.InActive&&e.jsx(F,{onClick:x=>{x.stopPropagation(),C(i.original.id)},children:e.jsx(v,{variant:"body1",children:n.formatMessage({id:"services.activate.action"})})}),e.jsx(F,{onClick:x=>{x.stopPropagation(),o(i.original.id)},children:e.jsx(v,{variant:"body1",children:n.formatMessage({id:"services.nursing.deleteServiceTitle"})})})]})]})}}],[]);return c.useEffect(()=>{We().then(i=>{var P,K;const p=(K=(P=i==null?void 0:i.data)==null?void 0:P.data)==null?void 0:K.find(w=>(w==null?void 0:w.slug)==="nursing-and-caregiver");R(p==null?void 0:p.id)})},[]),e.jsxs(e.Fragment,{children:[e.jsx(Ae,{custom:!0,links:Je(n)}),e.jsxs(d,{direction:"row",marginBottom:"20px",spacing:2,justifyContent:"space-between",alignItems:"center",children:[e.jsx(v,{variant:"h2",children:n.formatMessage({id:"services.nursing.title"})}),e.jsx(G,{variant:"contained",startIcon:e.jsx(Ge,{}),onClick:W,children:n.formatMessage({id:"services.nursing.addServiceTitle"})})]}),e.jsx(Fe,{data:l,columns:ne,isLoading:f,setPagination:i=>{a(i)},setSortingParams:i=>{M(i)},children:e.jsx(Te,{content:!1,children:e.jsxs(d,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",justifyContent:"space-between",sx:{padding:2,...L&&{"& .MuiOutlinedInput-root, & .MuiFormControl-root":{width:"100%"}}},children:[e.jsx(ee,{sx:{width:{xs:"70%",md:"70%"}},children:e.jsx(d,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(Pe,{value:j,onFilterChange:i=>m(i),placeholder:n.formatMessage({id:"services.nursing.searchService"})})})}),e.jsx(d,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",sx:{width:{xs:"100%",sm:"auto"}},children:e.jsx(d,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(G,{variant:"outlined",startIcon:e.jsx(ze,{}),children:n.formatMessage({id:"common.export"})})})})]})})}),N&&e.jsx(qe,{open:N,serviceId:V,handleClose:()=>{T(!1)},url:h,subService:U}),!!s&&e.jsx(ke,{open:!!s,handleSubmit:ie,handleClose:()=>{o(0)}}),e.jsx(Ue,{open:!!g,handleSubmit:ae,handleClose:()=>{b(0)}}),e.jsx(Ve,{open:!!E,handleSubmit:te,handleClose:()=>{C(0)}})]})}export{us as default};
