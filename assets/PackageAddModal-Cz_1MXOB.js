import{a as O,u as L,t as V,r as P,g as Y,b as K,bK as j,c as I,j as e,C as U,F as z,L as G,A as q,d as $,D as J,e as y,f as Q,G as r,S as d,h as X,i as Z,B as v,k as ee,T as ie,l,m as c,I as p,aK as se,b0 as te,H as A,p as ae,q as ne,s as re,x as oe}from"./index-DSO9TgYq.js";import{C as de}from"./CameraOutlined-D4Mj0cXe.js";import{p as ce}from"./services-BGkrpTaC.js";import{u as me}from"./useStatusList-Dbp-x5Xm.js";import{a as le,b as pe}from"./service-packages-ClErv1Kx.js";const he=(s,_)=>{var u,m,k,x;const f={name_en:"",name_ar:"",min_visit_price:"",min_package_price:"",discount:"",status:1,..._===j.PHYSIOTHERAPIST&&{description_en:"",description_ar:""},image:"",sessions_number:null};return s?{name_en:(u=s==null?void 0:s.name)==null?void 0:u.en,name_ar:(m=s==null?void 0:s.name)==null?void 0:m.ar,min_visit_price:Number(s==null?void 0:s.min_visit_price),min_package_price:Number(s==null?void 0:s.min_package_price),discount:Number(s==null?void 0:s.discount),status:s==null?void 0:s.status,..._===j.PHYSIOTHERAPIST&&{description_en:(k=s==null?void 0:s.description)==null?void 0:k.en,description_ar:(x=s==null?void 0:s.description)==null?void 0:x.ar},image:s==null?void 0:s.image,sessions_number:s==null?void 0:s.sessions_number}:f};function fe({subService:s,url:_,open:f,handleClose:u,packageType:m,packageId:k}){const x=O(),t=L(),{lang:E}=V(),{defaultList:b}=me(oe.PACKAGE_STATUS),[M,B]=P.useState(void 0),[C,R]=P.useState(`${s&&(s!=null&&s.image)?s.image:""}`);P.useEffect(()=>{M&&(R(URL.createObjectURL(M)),Y(M,a=>{S("image",a)}))},[M]);const w=P.useMemo(()=>he(s,m),[]),F=K({initialValues:w,validationSchema:ce(t,m),enableReinitialize:!0,onSubmit:async(a,{setSubmitting:g})=>{try{let o={...a,package_type:m,service_id:k,name:{en:a==null?void 0:a.name_en,ar:a==null?void 0:a.name_ar},...m===j.PHYSIOTHERAPIST&&{description:{en:a==null?void 0:a.description_en,ar:a==null?void 0:a.description_ar}}};(o.discount===""||o.discount===null||o.discount===void 0)&&(o.discount=0),o.image.includes("http")&&delete o.image,delete o.name_en,delete o.name_ar,m===j.PHYSIOTHERAPIST&&(delete o.description_en,delete o.description_ar),s?await le(s.id,o,_).then(W=>{I(t.formatMessage({id:"services.editPackageSuccess"})),g(!1),u()}):await pe(o,_).then(W=>{I(t.formatMessage({id:"services.addPackageSuccess"})),g(!1),u()})}catch(o){console.error(o),g(!1)}}}),{errors:i,touched:n,handleSubmit:T,isSubmitting:H,getFieldProps:h,values:N,setFieldTouched:D,setFieldValue:S}=F;return e.jsx(e.Fragment,{children:f&&e.jsx(U,{open:f,handleClose:u,children:e.jsx(z,{value:F,children:e.jsx(G,{dateAdapter:q,children:e.jsxs($,{autoComplete:"off",noValidate:!0,onSubmit:T,children:[e.jsx(J,{children:s?t.formatMessage({id:"services.editPackage"}):t.formatMessage({id:"services.addNewPackage"})}),e.jsx(y,{}),e.jsx(Q,{sx:{p:2.5},children:e.jsxs(r,{container:!0,spacing:3,children:[e.jsxs(r,{item:!0,xs:12,md:3,children:[e.jsxs(d,{direction:"row",justifyContent:"center",sx:{mt:3},children:[e.jsxs(X,{htmlFor:"change-avtar",sx:{position:"relative",borderRadius:"50%",overflow:"hidden","&:hover .MuiBox-root":{opacity:1},cursor:"pointer"},children:[e.jsx(Z,{alt:"Avatar 1",src:C,sx:{width:72,height:72,border:"1px dashed"}}),e.jsx(v,{sx:{position:"absolute",top:0,left:0,background:x.palette.mode===ee.DARK?"rgba(255, 255, 255, .75)":"rgba(0,0,0,.65)",width:"100%",height:"100%",opacity:0,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs(d,{spacing:.5,alignItems:"center",children:[e.jsx(de,{style:{color:x.palette.secondary.lighter,fontSize:"2rem"}}),e.jsx(ie,{sx:{color:"secondary.lighter"},children:t.formatMessage({id:"common.upload"})})]})})]}),e.jsx(l,{type:"file",id:"change-avtar",placeholder:"Outlined",variant:"outlined",inputProps:{accept:"image/*"},sx:{display:"none"},onChange:a=>{var g;D("image",!0),B((g=a.target.files)==null?void 0:g[0])}})]}),e.jsx(d,{direction:"row",justifyContent:"center",children:n.image&&i.image&&e.jsx(c,{error:!0,id:"helper-image",children:i==null?void 0:i.image})})]}),e.jsx(r,{item:!0,xs:12,md:8,children:e.jsxs(r,{container:!0,spacing:3,children:[e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(p,{htmlFor:"name_en",children:t.formatMessage({id:"services.packageNameEn"})}),e.jsx(l,{fullWidth:!0,id:"name_en",placeholder:t.formatMessage({id:"services.packageNameEn"}),...h("name_en"),error:!!(n.name_en&&i.name_en)})]}),n.name_en&&i.name_en&&e.jsx(c,{error:!0,id:"helper-name_en",children:i==null?void 0:i.name_en})]}),e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(p,{htmlFor:"name_ar",children:t.formatMessage({id:"services.packageNameAr"})}),e.jsx(l,{fullWidth:!0,id:"name_ar",placeholder:t.formatMessage({id:"services.packageNameAr"}),...h("name_ar"),error:!!(n.name_ar&&i.name_ar)})]}),n.name_ar&&i.name_ar&&e.jsx(c,{error:!0,id:"helper-name_ar",children:i==null?void 0:i.name_ar})]}),e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(p,{htmlFor:"min_visit_price",children:t.formatMessage({id:"services.minVisitPrice"})}),e.jsx(l,{type:"number",fullWidth:!0,id:"min_visit_price",placeholder:t.formatMessage({id:"services.minVisitPrice"}),...h("min_visit_price"),error:!!(n.min_visit_price&&i.min_visit_price)})]}),n.min_visit_price&&i.min_visit_price&&e.jsx(c,{error:!0,id:"helper-min_visit_price",children:i==null?void 0:i.min_visit_price})]}),e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(p,{htmlFor:"min_package_price",children:t.formatMessage({id:"services.minServicePrice"})}),e.jsx(l,{type:"number",fullWidth:!0,id:"min_package_price",placeholder:t.formatMessage({id:"services.minServicePrice"}),...h("min_package_price"),error:!!(n.min_package_price&&i.min_package_price)})]}),n.min_package_price&&i.min_package_price&&e.jsx(c,{error:!0,id:"helper-min_package_price",children:i==null?void 0:i.min_package_price})]}),e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(p,{htmlFor:"discount",children:t.formatMessage({id:"services.discount"})}),e.jsx(l,{type:"number",fullWidth:!0,id:"discount",placeholder:t.formatMessage({id:"services.discount"}),...h("discount"),error:!!(n.discount&&i.discount)})]}),n.discount&&i.discount&&e.jsx(c,{error:!0,id:"helper-discount",children:i==null?void 0:i.discount})]}),e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(p,{htmlFor:"status",children:t.formatMessage({id:"services.packageStatus"})}),e.jsx(se,{fullWidth:!0,children:e.jsxs(te,{id:"status",displayEmpty:!0,value:N.status,onChange:a=>S("status",a.target.value),children:[e.jsx(A,{value:"",children:e.jsx("em",{children:t.formatMessage({id:"common.none"})})}),b==null?void 0:b.map(a=>e.jsx(A,{value:a.value,children:a.label[E]},a.value))]})})]}),n.status&&i.status&&e.jsx(c,{error:!0,id:"helper-status",children:i==null?void 0:i.status})]}),m===j.PHYSIOTHERAPIST&&e.jsxs(e.Fragment,{children:[e.jsxs(r,{item:!0,xs:12,sm:12,children:[e.jsxs(d,{spacing:1,children:[e.jsx(p,{htmlFor:"description_en",children:t.formatMessage({id:"services.packageDescEn"})}),e.jsx(l,{type:"text",rows:2,multiline:!0,fullWidth:!0,id:"description_en",placeholder:t.formatMessage({id:"services.packageDescEn"}),...h("description_en"),error:!!(n.description_en&&i.description_en)})]}),n.description_en&&i.description_en&&e.jsx(c,{error:!0,id:"helper-description_en",children:i==null?void 0:i.description_en})]}),e.jsxs(r,{item:!0,xs:12,sm:12,children:[e.jsxs(d,{spacing:1,children:[e.jsx(p,{htmlFor:"description_ar",children:t.formatMessage({id:"services.packageDescAr"})}),e.jsx(l,{type:"text",rows:2,multiline:!0,fullWidth:!0,id:"description_ar",placeholder:t.formatMessage({id:"services.packageDescAr"}),...h("description_ar"),error:!!(n.description_ar&&i.description_ar)})]}),n.description_ar&&i.description_ar&&e.jsx(c,{error:!0,id:"helper-description_ar",children:i==null?void 0:i.description_ar})]}),e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsxs(d,{spacing:1,children:[e.jsx(p,{htmlFor:"discount",children:t.formatMessage({id:"services.physiotherapist.sessionNo"})}),e.jsx(l,{type:"number",fullWidth:!0,id:"sessions_number",placeholder:t.formatMessage({id:"services.physiotherapist.sessionNo"}),...h("sessions_number"),error:!!(n.sessions_number&&i.sessions_number)})]}),n.sessions_number&&i.sessions_number&&e.jsx(c,{error:!0,id:"helper-discount",children:i==null?void 0:i.sessions_number})]})]})]})})]})}),e.jsx(y,{}),e.jsx(ae,{sx:{p:2.5},children:e.jsx(r,{container:!0,justifyContent:"right",alignItems:"center",children:e.jsx(r,{item:!0,children:e.jsxs(d,{direction:"row",spacing:2,alignItems:"center",children:[e.jsx(ne,{color:"error",onClick:u,children:t.formatMessage({id:"common.cancel"})}),e.jsx(re,{type:"submit",loading:H,loadingIndicator:t.formatMessage({id:"common.processing"}),variant:"contained",children:s?t.formatMessage({id:"services.editPackage"}):t.formatMessage({id:"services.addNewPackage"})})]})})})})]})})})})})}export{fe as P};
